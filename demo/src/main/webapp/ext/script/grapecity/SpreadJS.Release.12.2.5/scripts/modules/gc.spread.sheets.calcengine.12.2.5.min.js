/*!
 * 
 * SpreadJS Library 12.2.5
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/sheetsCalc/sheetsCalc.entry.js")}({"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("CalcEngine"),i=c("CalcEngine"),j=c("./dist/plugins/sheetsCalc/calc.ns.js"),k=c("./dist/plugins/sheetsCalc/referenceExpression.js"),l=f.Common.j,m=f.Common.u,n=f.Common.l,o=l.Ia,p=l.za,q=null,r=void 0,s=["v","n","s","b","d","sn"],t=h.Errors.Value,u=f.Formatter&&f.Formatter.GeneralFormatter,v=h.Convert.vf,w=h.Errors.Reference,x=h.Errors.NotAvailable,y=h.Errors.Name,z=f.Common.A,A=f.Common.B,B=l.Fa,i.supportRowColumnFormula=!1,C=function(a){return h.Convert.Na(a,!0)},D=d.Range.prototype.contains,E=m.Nb,F=Math.min,G="cellListeners",H="rowSliceListeners",I="nameIDListeners",J="number";function aa(a){var b,c;if(a){if(7===a.type&&("SUBTOTAL"===a.functionName||"AGGREGATE"===a.functionName))return!0;for(b=a.arguments&&a.arguments.length,c=0;c<b;c++)if(aa(a.arguments[c]))return!0;if(aa(a.value)||aa(a.value2))return!0}return!1}K=h.CalcReference.prototype,K.getRow=function(a){return this.yf?this.yf[a||0].row:0},K.getColumn=function(a){return this.yf?this.yf[a||0].col:0},K.getRowCount=function(a){return this.yf?this.yf[a||0].rowCount:this.xf.getRowCount()},K.getColumnCount=function(a){return this.yf?this.yf[a||0].colCount:this.xf.getColumnCount()},K.getValue=function(a,b){var c,d,e;if(typeof a===J?(c=arguments[1],d=arguments[2],b=arguments[0]):(a=a,c=a.row,d=a.col),b=b||0,c>=0||d>=0){if(e=this.yf,!e)return this.xf.getValue(c,d);if(b<e.length)return this.xf.getValue(c+e[b].row,d+e[b].col)}return w},K.getValueByIndex=function(a){var b=this.getColumnCount(),c=Math.floor(a/b),d=a%b;return this.getValue(0,c,d)},K.isHiddenRow=function(a,b,c){return this.xf.isHiddenRow(b+this.getRow(a),c)},K.isSubtotal=function(a,b,c){var d,e=this.xf;return 0===a&&b<e.getRowCount()&&c<e.getColumnCount()&&(d=e.getCalcSourceModel().ATa(b,c),aa(d))},L=h.CalcSource.prototype,L.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,o,p,s,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(p=y.getRowCount(),s=y.getColumnCount(),c=c===r||c,u=0;u<C;u++){if(c||(o=[],B.push(o)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),l>=p||m>=s)return B=[q],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(l+z>p&&(z=p-l),m+A>s&&(A=s-m),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],o.push(v)),x=0;x<A;x++){if(k=m+x,n=y.getValue(j,k),d&&h.Convert.vf(n))return B=[n],B.isError=!0,B;if(n=h.Convert.wf(n,b,!0,f,i),e&&n===h.Convert.CalcConvertedError)return B=[t],B.isError=!0,B;n===q&&f||(c?B.push(n):v.push(n))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},L.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(M=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=M,N=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,B(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=N,e.NameInfo=N,O=h.CalcService.prototype;function ba(a,b){return a.getSourceModel(b)}O.parse=function(a,b,c,d,e,f,g){var h,i,j=this,k=j.rh,l=j.getParserContext(a);return l.useR1C1=!g&&j.useR1C1,l.ignoreError=f,l.row=c,l.column=d,l.culture=e,k?(h=k[b])?h:(i=j.kh.parse(l,b),k[b]=i,i):j.kh.parse(l,b)},O.unparse=function(a,b,c,d,e,f){var g,h=this.getParserContext(a);return h.useR1C1=this.useR1C1,h.row=c,h.column=d,h.culture=e,f&&(h.Eh=!0,h.useR1C1=!1),g=this.kh.unparse(h,b),h.Eh=!1,g},O.recalculate=function(a,b,c,d){var e=this.getSourceModel(a);c===-1?e.Ag(b,0,1,e.cC()):b===-1?e.Ag(0,c,e.rC(),1):e.Ag(b,c,1,1),this.IsSuspended()||this.recalculateAll(!1,d)},O.recalculateByName=function(a,b){var c,d;b&&(c=ba(this,a),d=c.mg(E(b),!0),this.pg(d,3),this.IsSuspended()||this.recalculateAll(!1))},O.recalcRange=function(a,b,c,d,e){var f=this.getSourceModel(a);c===-1?f.Ag(b,0,d,f.cC()):b===-1?f.Ag(0,c,f.rC(),e):f.Ag(b,c,d,e),this.IsSuspended()||this.recalculateAll(!1)},O.evaluate=function(a,b,c,d){var e=this,f=b instanceof h.Expression?b:e.parse(a,b,c,d);return e.lh.evaluateExpression(f,a.getEvaluatorContext(j.pf(c,d),!1),!1)},O.Hg=function(a,b,c,d,e,f){var g,i,k,l,m,n,o,p,s=c.row||0,u=c.col||0,v=f?f.row:s,w=f?f.col:u,y=a.getEvaluatorContext(c,d,f),z=4===arguments.length&&d,A=this.lh.evaluateExpression(b,y,e,z,z);if(d&&arguments.length<=5)return A;if(h.Convert.Fh(A)){if(g=A.getRowCount(0),i=A.getColumnCount(0),1!==A.getRangeCount())return t;try{if(k=d?s-v:s-A.getRow(0),l=d?u-w:u-A.getColumn(0),m=j.pf(0,0),1===g&&1===i);else if(1===g&&i>1&&l>=0&&l<i)m.col=l;else if(g>1&&1===i&&k>=0&&k<g)m.row=k;else{if(!(d&&k<g&&l<i))return d?x:t;m.row=k,m.col=l}A=A.getValue(m,0)}catch(a){return t}}else if(h.Convert.Ca(A))if(d){if(n=A,o=n.getRowCount(),p=n.getColumnCount(),1!==o&&s-v>=o||1!==p&&u-w>=p)return x;A=A.getValue(1===o?0:s-v,1===p?0:u-w)}else A=A.getValueByIndex(0);return A===r||A===q?e===!1?A:0:A},O.onAddAdjust=function(a,b){this.nh.hh(a,b)},O.onRemoveSource=function(a){this.nh.ph(a)},O.createSourceModel=function(a,b){return new T(a,b)},h.CalcSource.prototype.createSourceModel=function(a){return new T(a,this)},P=function(a){_(b,a);function b(b){var c=a.call(this,q)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=P,Q=function(a){_(b,a);function b(b,c,e,f){var h,i,j,k=a.call(this,b&&b.yj(),c,e,f)||this;for(b||(b=new d.Worksheet),k.kj=b,k.row=e&&e.row||0,k.column=e&&e.col||0,h=b.getCalcService(),i=h.getResolvers(),j=0;j<i.length;j++)if(i[j]instanceof g.SheetReferenceResolver)return k;return h.addResolver(new g.SheetReferenceResolver(b)),h.addResolver(new g.StructureReferenceResolver(b)),k}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent;if(a&&(!g||g.name!==a))return q;if(!g)return m.Mb(f.kj.name(),b)?f.kj.yj():q;if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],m.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName()},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=d?d.findByName(a):q;if(!e&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(e=d.findByName(a)));c++);return e},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.find(a,b):q},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj.no()},b}(h.ParserContext),b.SheetParserContext=Q,R=new f.Common.ResourceManager(d.SR),S=R.getResource.bind(R);function ca(a,b,c,d){return a===-1&&d>127||b===-1&&c>127||c*d>127}function da(a,b){var c,d,e;for(c in a)d=a[c],d&&(b?da(d):(e=d.calc,e&&e.ng()))}T=function(){function a(a,b){this.Ef=0,this.Ff=0,this.Gf=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;var c=this;c.xf=b,c.Af=a}return a.prototype.getNode=function(a,b,c){var d,e=this,f=q;return a>=0&&b>=0?(d=e.dataTable[a],c&&!d&&(d=e.dataTable[a]={},a>e.Ef&&(e.Ef=a)),d&&(f=d[b],c&&!f&&(f=d[b]={},b>e.Ff&&(e.Ff=b)))):a===-1&&b>=0?(f=e.If[b],c&&!f&&(f=e.If[b]={},b>e.Ff&&(e.Ff=b))):a>=0&&b===-1?(f=e.Hf[a],c&&!f&&(f=e.Hf[a]={},b>e.Ff&&(e.Ff=b))):a===-1&&b===-1&&(f=e.Jf,c&&!f&&(f=e.Jf={})),f},a.prototype.getNodeByName=function(a,b){var c=this,d=c.dataTableByName[a];return b&&!d&&(d=c.dataTableByName[a]={}),d},a.prototype.Kf=function(a,b){var c=this.getNode(a,b);return c&&c.Lf},a.prototype.Mf=function(a,b){var c=this.getNode(a,b);return c&&c.Nf},a.prototype.Qf=function(a,b){return this.getWorkingNodeInfo(a,b,2)},a.prototype.BTa=function(a,b){return this.getWorkingNodeInfo(a,b,1)},a.prototype.ATa=function(a,b){return this.getWorkingNodeInfo(a,b,0)},a.prototype.CTa=function(a){var b=this.getNodeByName(a);return b&&b.Nf},a.prototype.DTa=function(a){var b=this.getNodeByName(a);return b&&b.Lf},a.prototype.clearAll=function(){var a=this;a.clear(-1,-1,-1,-1),a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=q},a.prototype.clear=function(a,b,c,d,e){this.$b(a,b,c,d,e)},a.prototype.rzb=function(){var a=this;da(a.Hf),da(a.If),da(a.dataTable,!0),da(a.dataTableByName),a.aCb()},a.prototype.aCb=function(){var a=this;a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=q,a.Gf=[],a.vg=q,a.xg=q},a.prototype.addRows=function(a,b){var c,d=this,e=d.rC();if(!(a<0||a>e||b<0))for(z(d.dataTable,e,a,b),z(d.Hf,e,a,b),c=0;c<b;c++)d.dataTable[a+c]&&(d.dataTable[a+c]={rs:"n"})},a.prototype.deleteRows=function(a,b){var c=this,d=c.rC();a<0||a>=d||b<=0||(a+b>d&&(b=d-a),A(c.dataTable,d,a,b),A(c.Hf,d,a,b))},a.prototype.addColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>g||b<0)){for(c=0;c<f;c++)d=e.dataTable[c],d&&a<g&&z(d,g,a,b);z(this.If,g,a,b)}},a.prototype.deleteColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>=g||b<0)){for(c=0;c<f;c++)d=this.dataTable[c],d&&A(d,g,a,b);A(this.If,g,a,b)}},a.prototype.ETa=function(a,b){var c=[a,b],d=this.getNode(a,b);return d&&c.push(d.Lf,d.Nf,d.Pf),c},a.prototype.FTa=function(a,b,c){a&&a.push(this.ETa(b,c))},a.prototype.dUa=function(){var a=this.getSource(),b=a&&a.getSheet(),c=b&&b.ITa;return c&&c.dUa()},a.prototype.$Va=function(a,b,c,d,e){var f=this;a===-1?f.kg(b,c,d):b===-1?f.jg(a,c,d):f.ig(a,b,c,d,e)},a.prototype.Rf=function(a,b,c,d){var e=this.getNode(a,b,!!c);e&&(d&&d.push([a,b,e.Lf]),e.Lf=c)},a.prototype.GTa=function(a,b,c,d,e,f,g){var h=this.getNode(a,b,!!c);h&&(this.FTa(g,a,b),h.Lf=c,(h.Nf||d)&&(h.Nf=d),(h.Pf||e)&&(h.Pf=e),h.isVolatile&&!c?this.Tf(h):(f||h.isVolatile)&&(h.isVolatile=f))},a.prototype.Sf=function(a,b,c){this.GTa(a,b,r,r,r,!1,c)},a.prototype.Uf=function(a,b,c,d,e,f){var g=this.getNode(b,c);g&&g.Lf&&a.GTa(d,e,g.Lf,g.Nf,g.Pf,g.isVolatile,f)},a.prototype.ega=function(a,b){var c=this.dataTable[a];return c&&c[b]},a.prototype.Wf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Nf=c)},a.prototype.Xf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Pf=c)},a.prototype.Yf=function(a,b){var c=this.getNode(a,b);return c&&c.calc},a.prototype.Zf=function(a,b,c){var d=this.getNode(a,b,!0);d&&(d.calc&&d.calc.isVolatile&&this.Tf(d),d.calc=c,c&&(c.node=d))},a.prototype.Q3=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.calc&&(d.calc.isVolatile&&this.Tf(d),this.Af.Bh(d.calc,c),d.calc=r)},a.prototype.$f=function(a,b,c,d,e){var f,g=this;c>=0&&d>=0?(f=g.dataTable[c],f||(f=g.dataTable[c]={}),f[d]=e,e&&e.calc&&delete e.calc):c>=0&&d===-1&&a>=0&&b===-1?g.Hf[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(g.If[d]=e)},a.prototype._f=function(a,b,c,d){var e=this,f=e.getNode(a,b),g=e.getNode(c,d);f&&f.Lf?e.$f(a,b,c,d,f):g&&g.Lf&&e.$f(a,b,c,d,q),g&&g.Lf?e.$f(c,d,a,b,g):f&&f.Lf&&e.$f(c,d,a,b,q)},a.prototype.lmb=function(){return this.Gf},a.prototype.bg=function(a){a.isVolatile||(a.isVolatile=!0,this.Gf.push(a))},a.prototype.Tf=function(a){var b,c,d,e,f;if(a.isVolatile=r,b=this,b.B5++,b.B5>100){for(b.B5=0,c=[],d=b.Gf,e=b.Gf.length,f=0;f<e;f++)d[f].isVolatile&&c.push(d[f]);b.Gf=c}},a.prototype.getCalcService=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.Cf=function(){return this.Af},a.prototype.getSource=function(){return this.xf},a.prototype.hasFormula=function(a,b){return a=a!==r?a:-1,b=b!==r?b:-1,!!this.ATa(a,b)},a.prototype.setFormula=function(a,b,c,d,e,f,g){var h,i,j,k,l,m=this;if(c&&0===c.length&&(c=q),!e&&m.dg(a,b,1,1)&&m.eg(),h=m.getFormula(a,b),f||h!==c&&(""!==h||c)&&(h||""!==c)){if(i=m.Cf(),j=q,i)try{k=a>=0?a:0,l=b>=0?b:0,j=d||(c?i.parse(m.xf,c,k,l,!1,e):q),m.fg(a,b,j,r,!1,g)}catch(a){if(!e)throw a}a>=0&&b>=0&&m.xf.setFormula(a,b,c)}},a.prototype.getFormula=function(a,b,c){var d,e,f=this.Cf();return f&&(d=this.ATa(a,b))?(e=this.Qf(a,b),a=e?e.row:a,b=e?e.col:b,f.unparse(this.xf,d,a,b,c)):q},a.prototype.setFormulaByName=function(a,b,c,d){var e,f,g,h;if(a&&(a=E(a),e=this,b&&0===b.length&&(b=q),f=e.getFormulaByName(a),f!==b&&(""!==f||b)&&(f||""!==b))){if(g=e.Cf(),h=q,g)try{h=b?g.parse(e.xf,b,0,0,!1,c):q,e.gg(a,h,r,!1,d)}catch(a){if(!c)throw a}e.xf.setFormula({name:a},b)}},a.prototype.getFormulaByName=function(a){var b,c=this.Cf();return c&&a&&(b=this.DTa(E(a)))?c.unparse(this.xf,b,0,0):q},a.prototype.eg=function(){throw S().Exp_ArrayFromulaPart},a.prototype.rC=function(){return F(this.xf.getRowCount())},a.prototype.cC=function(){return F(this.xf.getColumnCount())},a.prototype.setArrayFormula=function(a,b,c,e,f,g,h){var i,j,k,l,m=this;if(f&&0===f.length&&(f=q),m.dg(a,b,c,e)&&m.eg(),a=a<0?0:a,b=b<0?0:b,j=m.Cf(),j&&(m.$b(a,b,c,e,h),f)){try{i=f?j.parse(m.xf,f,a,b,!1,g):q}catch(a){if(!g)throw a;return}for(k=a;k<a+c;k++)for(l=b;l<b+e;l++)m.fg(k,l,i,d.kf(a,b,c,e),!1,h);a>=0&&b>=0&&m.xf.setArrayFormula(a,b,c,e,j.unparse(m.xf,i,a,b))}},a.prototype.getWorkingNodeInfo=function(a,b,c){var d,e=this,f=e.xf;return a>=f.getRowCount()||b>=f.getColumnCount()?d:(a>=0&&b>=0?(d=e.getNode(a,b),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(a,-1)),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(-1,b))):d=a>=0&&b===-1?e.getNode(a,-1):a===-1&&b>=0?e.getNode(-1,b):e.getNode(-1,-1),d&&(0===c&&d.Lf||1===c&&d.Nf||2===c&&d.Pf))},a.prototype.fg=function(a,b,c,d,e,f){var g,i,k,l,m,n,o,p,q,s,t,u=this,v=u.Cf();v.nia&&v.lh.asyncManager.endCalcCell(),g=d!==r&&null!==d,i=g?d.row:a,k=g?d.col:b,l=u.xf,m=new h.EvaluateContext(l,j.pf(i,k),g),n=ha(m,c,g,g?a-d.row:0,g?b-d.col:0),m.szb&&(delete m.szb,o=v.unparse(l,c,i,k),c=v.parse(l,o,i,k)),n=n===c?r:n,d!==r&&(p=d),a>=0&&b>=0?((e===r||e)&&(q=a>=0?a:0,s=b>=0?b:0,t=c?v.unparse(l,c,q,s):r,u.xf.setFormula(a,b,t)),u.ig(a,b,c,n,p,f)):a>=0&&b===-1?u.jg(a,c,n,f):a===-1&&b>=0&&u.kg(b,c,n,f),v.autoCalculation&&!v.IsSuspended()&&v.recalculateAll(!1)},a.prototype.gg=function(a,b,c,d,e){var f,g=this,i=g.Cf(),k=new h.EvaluateContext(g.xf,j.pf(0,0),(!1)),l=ha(k,b,!1,0,0);l=l===b?r:l,d!==r&&!d||e||(f=b?i.unparse(g.xf,b,0,0):r,g.xf.setFormulaByName(a,f)),g.lg(a,b,l),i.autoCalculation&&!i.IsSuspended()&&(e||i.recalculateAll(!1))},a.prototype.getRowExpression=function(a){return this.Kf(a,-1)},a.prototype.getColumnExpression=function(a){return this.Kf(-1,a)},a.prototype.lg=function(a,b,c,d){var e,f=this,g=f.mg(a,!0);g&&(g.ng(),e=this.getNodeByName(a,!0),e.Lf=b,d&&(d[0].push("dataTable",a),d[1]=e.Lf),c=b&&c?c:r,e.Nf=c,g.og(),f.Af.pg(g,3))},a.prototype.ig=function(a,b,c,d,e,f){var g,h=this,i=h.qg(a,b,!0);i&&(h.FTa(f,a,b),g=h.Af,g.onClearExpr(h.xf,j.pf(a,b)),i.ng(),h.Rf(a,b,c),c?((d||h.Mf(a,b))&&h.Wf(a,b,d),(e||h.Qf(a,b))&&h.Xf(a,b,e)):(h.Wf(a,b,r),h.Xf(a,b,r)),i.og(),g.pg(i,0),g.calcOnDemand&&(i.dirty=!0))},a.prototype.jg=function(a,b,c,d){var e=this,f=e.rg(a,!0);f&&(e.FTa(d,a,-1),f.ng(),e.Rf(a,-1,b),(c||e.Mf(a,-1))&&e.Wf(a,-1,c),f.og(),e.Af.pg(f,1))},a.prototype.kg=function(a,b,c,d){var e=this,f=e.sg(a,!0);f&&(e.FTa(d,-1,a),f.ng(),e.Rf(-1,a,b),(c||e.Mf(-1,a))&&e.Wf(-1,a,c),f.og(),e.Af.pg(f,2))},a.prototype.$b=function(a,b,c,e,f){var g,h,i,j,k,l=this,m=a<0?0:a,n=b<0?0:b,o=a<0?l.rC():c,p=b<0?l.cC():e,s=m+o-1,t=n+p-1,u=function(a,b){if(g=l.Mf(a,b),h=l.Kf(a,b),g||h){i=l.Qf(a,b);var c=i?d.kf(i.row,i.col,i.rowCount,i.colCount):r;l.fg(a,b,q,c,!0,f)}};for(j=m;j<=s&&j>=0;j++)for(b<0&&u(j,-1),k=n;k<=t&&k>=0;k++)j===m&&a<0&&u(-1,k),u(j,k);a<0&&b<0&&u(a,b)},a.prototype.dg=function(a,b,c,d){return this.tg(a,b,c,d,!0,!0)},a.prototype.tg=function(a,b,c,e,f,g){var h,i,j,k,l,m,n=this,o=a<0?0:a,p=b<0?0:b,q=a<0?n.rC():c,r=b<0?n.cC():e,s=o+(0===q?1:q)-1,t=p+(0===r?1:r)-1,u=!1,v=[],w=[],x=n.dataTable;for(j=o;j<=s&&j>=0&&!(j>n.Ef);j++)if(i=x[j])for(k=p;k<=t&&k>=0&&!(k>n.Ff);k++)if(h=i[k])if(l=h.Pf,m=void 0,l){if(l.row<o||l.row+l.rowCount-1>s||l.col<p||l.col+l.colCount-1>t){if(f)return!0;u=!0}if(j!==l.row&&j!==o)continue;v.push(d.kf(l.row,l.col,l.rowCount,l.colCount)),m=h.Lf,w.push(m),k=l.col+l.colCount-1}else g||(m=h.Lf,m&&(v.push({row:j,col:k}),w.push(m)));return!f&&{hasPart:u,ranges:v,formulas:w}},a.prototype.getCalcObj=function(){var a,b,c,d,e,f,g,h,i,j,k,l=[];for(a=0;a<arguments.length;a++)l[a]=arguments[a];if(b=l[0],c=l[1],d=this,e=b.row,f=b.column,g=null,isNaN(e)||isNaN(f))b.name&&(g=d.mg(b.name,c));else if(e>=0&&f>=0)if(b.sf())g=d.qg(e,f,c);else for(h=b.endRow,i=b.endColumn,g=[],j=e;j<=h;j++)for(k=f;k<=i;k++)g.push(d.qg(j,k,c));else e>=0?g=d.rg(e,c):f>=0&&(g=d.sg(f,c));return g},a.prototype.mg=function(a,b){var c=this,d=q,e=c.getNodeByName(a,b);return e&&(d=e.calc,!d&&b&&(d=new h.NameIDCalc(c,a),e.calc=d,d.node=e)),d},a.prototype.qg=function(a,b,c){var d,e,f,g=this,h=q;if(a>=0&&b>=0){if(d=g.dataTable,e=d[a],!e){if(!c)return h;e=d[a]={},a>g.Ef&&(g.Ef=a)}if(f=e[b],!f)return c&&(f=e[b]={},h=new U(g,a,b),f.calc=h,h.node=f,b>g.Ff&&(g.Ff=b)),h;h=f.calc,!h&&c&&(h=new U(g,a,b),f.calc=h,h.node=f,a>g.Ef&&(g.Ef=a),b>g.Ff&&(g.Ff=b))}return h},a.prototype.rg=function(a,b){var c=this,d=q;return a>=0&&(d=c.Yf(a,-1),!d&&b&&(d=new V(c,a),c.Zf(a,-1,d),a>c.Ef&&(c.Ef=a))),d},a.prototype.sg=function(a,b){var c=this,d=q;return a>=0&&(d=c.Yf(-1,a),!d&&b&&(d=new W(c,a),c.Zf(-1,a,d),a>c.Ff&&(c.Ff=a))),d},a.prototype.ug=function(a){var b=this;return!b.vg&&a&&(b.vg=new Y(b)),b.vg},a.prototype.wg=function(a,b){var c,d=this;return a=E(a),d.xg||(d.xg={}),c=d.xg[a],!c&&b&&(c=d.xg[a]=new X(d,a)),c},a.prototype.updateNameCalc=function(a,b){var c=this.wg(E(a));c&&(c.updateListening(!0,b),c.fh())},a.prototype.yg=function(a,b){var c,d,e=this,f=F(e.Ff,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(-1,c)&&(d=e.sg(c,!0),e.Af.pg(d,2))},a.prototype.zg=function(a,b){var c,d,e=this,f=F(e.Ef,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(c,-1)&&(d=e.rg(c,!0),e.Af.pg(d,1))},a.prototype.Ag=function(a,b,c,d){var e,f,g,h=this,i=null,j=F(h.Ef,a+c-1),k=F(h.Ff,b+d-1);for(e=a;e<=j;e++)for(f=b;f<=k;f++)h.ega(e,f)&&(h.Af.calcOnDemand?(i=h.qg(e,f,!1),i&&(i.Bg(),i.dirty=!0)):(i=h.qg(e,f,!0),h.Af.pg(i,0)));h.zg(a,c),h.yg(b,d),g=h.ug(!1),g&&g.Bg(a,b,c,d)},a.prototype.Cg=function(){var a,b,c,d,e,f=this,g=f.lmb();for(c=0;c<g.length;c++)d=g[c],f.Af.calcOnDemand&&d&&d.isVolatile&&(d.dirty=!0,d.Bg()),d&&d.isVolatile&&d instanceof U&&!f.Dg(d)&&(e=f.qg(d.row,d.column,!0),f.Af.pg(e,0),a=f.rg(d.row,!1),a&&!f.Eg(a)&&f.zg(d.row,1),b=f.sg(d.column,!1),b&&!f.Eg(b)&&f.yg(d.column,1))},a.prototype.Fg=function(){for(var a,b,c,d,e,f,g,h,i=this,j=i.lmb(),k=!0,l=5,m=i.Af;k&&l;){for(k=!1,l--,c=0,d=j.length;c<d;c++)e=j[c],e&&e.isVolatile&&e instanceof U&&!i.Dg(e)&&(f=e.row,g=e.column,i.recalculateCell(f,g)&&(k=!0,h=i.qg(f,g,!0),m.pg(h,0),a=i.rg(f,!1),a&&!i.Eg(a)&&i.zg(f,1),b=i.sg(g,!1),b&&!i.Eg(b)&&i.yg(g,1)));k&&m.Gg(!0)}},a.prototype.Dg=function(a){var b=this.getCalcService().imb;return!!a.dh||a===(b&&b[0])},a.prototype.Eg=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[1])},a.prototype.isDirtyColumn=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[2])},a.prototype.isDirty=function(a,b){return!(!this.Yf(a,b)&&!this.Kf(a,b))},a.prototype.recalculateForContext=function(a,b,c){var d=this.Af,e=d.getSourceModel(a),f=b.row,g=b.col;g===-1?e.Ag(f,0,1,e.cC()):f===-1?e.Ag(0,g,e.rC(),1):e.Ag(f,g,1,1),d.IsSuspended()||d.recalculateAll(!1,c)},a.prototype.recalculateCell=function(a,b){var c,d,e,f,g,h,i,k,l,m,o,p,q=this,r=q.xf,s=q.BTa(a,b)||q.ATa(a,b);if(s){if(c=j.pf(a,b),d=r.getValue(a,b),e=!1,f=void 0,g=void 0,h=void 0,i=void 0,k=q.Qf(a,b),k&&(e=!0,f=k.row,g=k.col,h=k.rowCount,i=k.colCount),l=q.Af,l.nia&&l.lh.asyncManager.startCalcCell(q.xf,c),m=l.Hg(q.xf,s,c,e,!0,k&&j.qf(f,g,h,i)),d===m)return!1;if(d instanceof Date){if(m instanceof Date&&d.valueOf()===m.valueOf())return!1;if(typeof m===J){if(o=n.Ra(d),o===m)return!1;m=n.Xb(m)}}return r.setValue(a,b,m,d),l.nia&&l.lh.asyncManager.endCalcCell(q.xf,c),p=r,p.Ppb&&p.Ppb(a,b),!0}return!1},a.prototype.recalculateNameID=function(a){var b,c,d=this,e=d.xf,f=d.CTa(a)||d.DTa(a);if(f){if(b=e.getValueByName?e.getValueByName(a):e.getValue({name:a}),c=d.Af.Hg(d.xf,f,{name:a},!1,!0),b===c)return;if(b instanceof Date&&c instanceof Date&&b.valueOf()===c.valueOf())return;e.setValueByName?e.setValueByName(a,c):e.setValue({name:a},c)}},a.prototype.addDirtyNodesForCalc=function(a,b){var c,d,e=this;a!==!1?(c=e.cC(),d=e.rC(),e.yg(0,c),e.zg(0,d),e.Ag(0,0,d,c)):b||e.Cg()},a.prototype.addListenersToDirtyForRow=function(a){for(var b,c,d,e;a.imb[1];){for(b=a.imb[1],c=b.ah,d=c.cC(),e=0;e<d;e++)a.pg(c.qg(b.row,e,!0),0);a.Bh(b,1)}},a.prototype.addListenersToDirtyForCol=function(a){for(var b,c,d,e;a.imb[2];){if(b=a.imb[2],c=b.ah,d=c.rC(),d>0)for(e=0;e<d;e++)a.pg(c.qg(e,b.column,!0),0);else b.Bg();a.Bh(b,2)}},a.prototype.Ah=function(a,b){for(var c=a.length,d=b;d;)a[c]=d,c++,d=d.eh},a.prototype.addListenersToDirty=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(1===b)this.addListenersToDirtyForRow(a);else if(2===b)this.addListenersToDirtyForCol(a);else if(0===b)for(c=[],a.imb[2]&&this.Ah(c,a.imb[2]),d=a.imb[0];d;d=d.eh)for(e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.Bg(),h&&h.Bg(),i&&i.Bg(),j&&j.Bg(f,g,1,1),this.addListenersToDirtyForRow(a);a.imb[2];){for(k=a.imb[2],l=!1,m=0;m<c.length;m++)if(c[m]===k){l=!0;break}if(l)a.Bh(k,2);else{for(c[c.length]=k,e=k.ah,n=e.rC(),o=0;o<n;o++)a.pg(e.qg(o,k.column,!0),0);a.Bh(k,2)}}else if(3===b)for(p=a.imb[3];p;p=p.eh)p.Bg()},a.prototype.initDelay=function(a,b){var c,d,e,f,g,h,j;if(0===b)for(c=null,d=a.imb[0];d;d=c)c=d.eh,e=d.ah,f=e.rC(),g=e.cC(),d.row<f&&d.column<g?(i.supportRowColumnFormula&&(h=e.sg(d.column,!1),h&&(h.delay=0)),d.delay=0):a.Bh(d,0);else if(3===b)for(j=a.imb[3];j;j=j.eh)j.delay=0},a.prototype.adjustDelayOfListeners=function(a,b,c){var d,e,f,g,h,i,j,k;if(0===b)for(d=a.imb[b];d;d=d.eh)e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.gh(c),h&&h.gh(c),i&&i.gh(c),j&&j.gh(f,g,c);else if(3===b)for(k=a.imb[3];k;k=k.eh)k.gh(c)},a.prototype.calculateDirtyNodes=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(a.calcOnDemand)return!1;if(c=!1,d=null,0===b){for(f=a.imb[b];f;f=e)if(e=f.eh,0===f.delay){if(d=f.ah,g=f.row,h=f.column,i=d.rg(g,!1),j=d.sg(h,!1),j&&j.delay)continue;k=d.ug(!1),d.recalculateCell(g,h),a.Bh(f,0),f.gh(!1),i&&i.gh(!1),j&&j.gh(!1),k&&k.gh(g,h,!1),c=!0}}else if(3===b)for(l=a.imb[b];l;l=e)e=l.eh,0===l.delay&&(d=l.ah,d.recalculateNameID(l.name),a.Bh(l,3),l.gh(!1),c=!0);return c},a.prototype.calculateIterations=function(a,b){var c,d,e,f,g,i,j,k,l,m,n,o;if(!a.calcOnDemand&&0===b&&(c=a.imb[b])){d=null,e=!0;for(f in a.jh)a.jh.hasOwnProperty(f)&&(g=a.jh[f].getSource(),g.clearValueCache&&g.clearValueCache());for(i=0;e&&i<a.maximumIterations;i++)for(e=!1,d=c;d;d=d.eh)j=d.ah,k=d.row,l=d.column,m=j.getSource().getValue(k,l),j.recalculateCell(k,l),e||(n=j.getSource().getValue(k,l),a.Ch(m,n)>=a.maximumChange?e=!0:m instanceof h.CalcError&&!(n instanceof h.CalcError)?e=!0:n instanceof h.CalcError&&!(m instanceof h.CalcError)&&(e=!0));for(o=null,d=c;d;d=o)o=d.eh,d.eh=r,o&&(o.dh=r)}},a.prototype.Ig=function(a,b,c,d,e,f,i){for(var j,l,m,n,o,p,s,t,u,v,w,x,y,z,A,B,C,D,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=this;12===d.type;)d=d.value;for(;10===d.type;)d=d.value;for(;12===d.type;)d=d.value;if(e){for(;12===e.type;)e=e.value;for(;10===e.type;)e=e.value;for(;12===e.type;)e=e.value}if(13===d.type){if(p=d.getRange(b,c,!0),p===q)return;d=1===p.rowCount&&1===p.colCount?k.rf(q,q,p.row,p.col,!1,!1):k.uf(q,q,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1,!1,!1,!1,!1)}if(e&&e!==d&&8===e.type){if(e.source instanceof g.ErrorSource)return;l=e.value,G=d.source||e.source||i||V.xf,m=G.getCustomName(l),m?H=G.getCalcSourceModel():(H=V.Af.getGlobalSourceModel()||G.getCalcSourceModel(),m=H.getSource().getCustomName(l),m||(I=G.getCalcSourceModel().wg(l,!0),I.gmb(0,a,f))),o=H.wg(l,!0),o.gmb(0,a,f),e=null,m&&V.Ig(a,b,c,m,q,f,H.getSource())}if(1===d.type&&d.endSource)for(J=d,K=J.source.getSources(J.endSource),j=0;j<K.length;j++)L=k.uf(K[j],q,J.row,J.column,J.endRow,J.endColumn,J.rowRelative,J.columnRelative,J.endRowRelative,J.endColumnRelative,b,c),L.isFullRow=J.isFullRow,L.isFullColumn=J.isFullColumn,V.Ig(a,b,c,L,q,f);else if(1===d.type){if(G=d.source!==h.BangSource&&d.source||V.xf,H=G.getCalcSourceModel(),!H)return;if(M=d,N=a.row===r||a.column===r,O=M.tf(),P=k.getRangeForReference(M,b,c),Q=void 0,u=P.row,w=P.col,y=P.rowCount,z=P.colCount,v=u+y-1,x=w+z-1,0===O){if(0<=b&&0<=c)if(ca(s,t,y,z))Q=H.ug(!0),N?Q.Xoa(u,w,y,z,a,f):Q.Jg(u,w,y,z,a,f);else for(D=u;D<=v;D++)for(F=w;F<=x;F++)A=H.qg(D,F,!0),N?A&&A.gmb(3,a,f):A&&A.gmb(0,a,f);else if(0<=b&&c===-1)for(D=u;D<=v;D++)for(F=w;F<=x;F++)M.columnRelative||M.endColumnRelative?(B=H.rg(D,!0),B&&B.Kg(a.row,-F,f)):(A=H.qg(D,F,!0),A&&A.gmb(1,a,f));else if(0<=c&&b===-1)for(D=u;D<=v;D++)for(F=w;F<=x;F++)M.rowRelative||M.endRowRelative?(C=H.sg(F,!0),C&&C.Mg(a.column,-D,f)):(A=H.qg(D,F,!0),A&&A.gmb(2,a,f))}else if(1===O){if(0<=b&&0<=c)Q=H.ug(!0),N?Q.Xoa(u,w,y,z,a,f):Q.Jg(u,w,y,z,a,f);else if(0<=b&&c===-1);else if(b===-1&&0<=c)if(M.rowRelative||M.endRowRelative);else for(u=M.row,v=M.endRow,D=u;D<=v;D++)B=H.rg(D,!0),B&&B.gmb(2,a,f)}else if(2===O)if(0<=b&&0<=c)Q=H.ug(!0),N?Q.Xoa(u,w,y,z,a,f):Q.Jg(u,w,y,z,a,f);else if(0<=b&&c===-1);else if(b===-1&&0<=c)for(F=w;F<=x;F++)C=H.sg(F,!0),C&&C.gmb(2,a,f)}else if(9===d.type)V.Ig(a,b,c,d.value,e&&9===e.type&&e.value,f),d.value2&&V.Ig(a,b,c,d.value2,e&&9===e.type&&e.value2,f);else if(8===d.type){if(G=d.source||i||V.xf,l=E(d.value),m=G.getCustomName(l),m?H=G.getCalcSourceModel():(H=V.Af.getGlobalSourceModel()||G.getCalcSourceModel(),m=H.getSource().getCustomName(l),m||(n=G.getCalcSourceModel().wg(l,!0),n.gmb(0,a,f))),o=H.wg(l,!0),!o)return;o.gmb(0,a,f),m&&V.Ig(a,b,c,m,q,f,H.getSource())}else if(7===d.type){if(R=d.function){if(R.isVolatile()&&(f?V.bg(a):V.Tf(a)),!R.precedentReference())return;R instanceof h.Functions.AsyncFunction&&(V.Af.nia=!0)}for(S=d.arguments.length,j=0;j<S;j++)V.Ig(a,b,c,d.arguments[j],e&&7===e.type&&e.arguments[j],f)}else if(25===d.type||26===d.type){if(T=d,G=d.source||V.xf,H=G.getCalcSourceModel(),U=H.mg(T.value,!0),!U)return;U.gmb(0,a,f)}},a.prototype.Og=function(a,b){var c=this.getNodeByName(a);c&&(c.Nf||c.Lf)&&this.Ig(this.mg(a),0,0,c.Nf||c.Lf,c.Lf,b)},a.prototype.Pg=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=a+c,m=b+d;for(i=a;i<l;i++)for(j=b;j<m;j++)f=k.Mf(i,j),g=k.Kf(i,j),(f||g)&&(h=k.Qf(i,j),h?k.Ig(k.qg(i,j),h.row,h.col,f||g,g,e):k.Ig(k.qg(i,j),i,j,f||g,g,e))},a.prototype.Qg=function(a,b,c){var d,e,f=a+b;for(d=a;d!==-1&&d<f;d++)e=this.getColumnExpression(d),e&&this.Ig(this.sg(d,!1),-1,d,e,e,c)},a.prototype.Rg=function(a,b,c,d){this.Pg(a,b,c,d,!0)},a.prototype.Sg=function(a,b,c,d){this.Pg(a,b,c,d,!1)},a.prototype.Tg=function(a,b){},a.prototype.Ug=function(a,b){},a.prototype.Vg=function(a,b){this.Qg(a,b,!0)},a.prototype.Wg=function(a,b){this.Qg(a,b,!1)},a.prototype.Xg=function(a,b,c,d,e,f,g){var h,i,j,k=a+c,l=b+d,m=this;for(h=a;h<k;h++)for(i=b;i<l;i++)j=this.qg(h,i,!1),j&&(m.FTa(g,h,i),e&&j.Yg(),f&&j.Bg())},a.prototype.Zg=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.Hf;if(a!==-1&&k)for(f=F(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,g,-1),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype.$g=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.If;if(a!==-1&&k)for(f=F(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,-1,g),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype._g=function(a,b,c,d,e,f,g){var h,i,j,k;(e||f)&&(h=this,i=void 0,g&&(i=h.dUa()),0<=a&&0<=b?(h.Xg(a,b,c,d,e,f,i),h.Zg(a,c,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):0<=a&&b===-1?(h.Xg(a,0,c,h.cC(),e,f,i),h.Zg(a,c,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&0<=b?(h.Xg(0,b,h.rC(),d,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&b===-1&&(j=h.rC(),k=h.cC(),h.Xg(0,0,j,k,e,f,i),h.Zg(0,j,e,f,i),h.$g(0,k,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))))},a.prototype.getAllNodes=function(){var a,b,c,d,e=[],f=this.dataTable,g=this.Hf,h=this.If,i=this.Jf;i&&e.push(i);for(b in g)g.hasOwnProperty(b)&&(a=g[b],a&&e.push(a));for(b in h)h.hasOwnProperty(b)&&(a=h[b],a&&e.push(a));for(c in f)if(f.hasOwnProperty(c)&&(d=f[c]))for(b in d)d.hasOwnProperty(b)&&(a=d[b],a&&e.push(a));return e},a.prototype.toJSON=function(a){this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff)},a}(),b.CalcSourceModel=T,U=function(a){_(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.row=c,e.column=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+","+a.column},b.prototype.og=function(){var a=this;a.ah.Rg(a.row,a.column,1,1)},b.prototype.ng=function(){var a=this;a.ah.Sg(a.row,a.column,1,1)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},b.prototype.fh=function(){var a=this.ah.Cf();a.calcOnDemand&&(this.dirty=!0),a.pg(this,0)},b.prototype.Bg=function(){var a,b,c,d,e=this.ah.Cf(),f=this.Ze;for(b=0;b<f.length;b++)if(c=this[f[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],!a||a.dh||a.eh||a.fh(),e.calcOnDemand&&a&&!a.dirty&&(a.dirty=!0,a.Bg()))},b.prototype.y$a=function(){var a,b,c,d,e,f,g,h,i=this,j=i.ah,k=j.getCalcService();k&&k.nia&&(a=i.nia,b=a&&i.z$a,!b&&B(a)&&(c=j.getSource(),c&&(d=c.getName(),e=k.lh.asyncManager,f=e.y5[d],f&&(g=f[i.row],g&&(h=g[i.column],h&&(b=h[0],b?(i.nia=!0,i.z$a=b,b.h_a=i):i.nia=!1))))),b&&0===b.evaluateMode&&(b.v5=!1))},b}(h.BaseCalc),b.CellCalc=U;function ea(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function fa(a,b,c){var d,e=a[b];if(e)for(d=0;d<e.length;d++)if(e[d]===c)return void e.splice(d,1)}V=function(a){_(b,a);function b(b,c){var d=a.call(this,b)||this;return d.row=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+",-1"},b.prototype.og=function(){this.ah.Tg(this.row,1)},b.prototype.ng=function(){this.ah.Ug(this.row,1)},b.prototype.Kg=function(a,b,c){c?ea(this,H,{row:a,columnOffset:b,columnCount:1}):fa(this,H,{row:a,columnOffset:b,columnCount:1})},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},b.prototype.fh=function(){this.ah.Cf().pg(this,1)},b}(h.BaseCalc),b.RowCalc=V,W=function(a){_(b,a);function b(b,c){var d=a.call(this,b)||this;
return d.column=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+"-1,"+a.column},b.prototype.og=function(){this.ah.Vg(this.column,1)},b.prototype.ng=function(){this.ah.Wg(this.column,1)},b.prototype.Mg=function(a,b,c){this.gmb(2,a,c)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},b.prototype.fh=function(){this.ah.Cf().pg(this,2)},b}(h.BaseCalc),b.ColumnCalc=W,X=function(a){_(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.updateListening=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.Ze;for(e=0;e<l.length;e++)if(f=k[l[e]]){g=[];for(h in f)f.hasOwnProperty(h)&&(c=f[h],c&&g.push(c));for(i=g.length,j=0;j<i;j++)c=g[j],d=c.node,c.ng(),d&&(!d.Pf||d.Pf.row===c.row&&d.Pf.col===c.column)&&c.ah.fg(c.row,c.column,d.Lf,d.Pf,!0)}},b.prototype.updateListeningOnRemoved=function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.Ze,m=k.ah,n=m.Cf();for(f=0;f<l.length;f++)if(g=k[l[f]])for(h in g)g.hasOwnProperty(h)&&(a=g[h],a&&(b=a.ah,c=a.row,d=a.col,c=c===r?-1:c,d=d===r?-1:d,e=b.Kf(c,d),i=b.Qf(c,d),e&&(j=n.ih().adjustFormulaOnRemoveName(m,e,k.name),j!==e&&b.fg(c,d,j,i,!0))))},b.prototype.fh=function(){var a,b,c,d,e=this.Ze;for(b=0;b<e.length;b++)if(c=this[e[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],a&&a.fh())},b}(h.BaseCalc),b.NameCalc=X,Y=function(a){_(b,a);function b(b){return a.call(this,b)||this}return b.prototype.processListener=function(a,b,c,d,e,f,g){var i=this,j=i[a],k=b+","+c+","+d+","+e,l,m;if(3!==a||f instanceof h.NameIDCalc){if(j||(i.Ze.push(a),i[a]=j={}),l=j[k],!l){if(!g)return;l=j[k]=[],l.row=b,l.col=c,l.rowCount=d,l.colCount=e}if(g){for(m=0;m<l.length;m++)if(l[m]===f)return;l.push(f)}else for(m=0;m<l.length;m++)l[m]===f&&l.splice(m,1)}},b.prototype.Jg=function(a,b,c,d,e,f){this.processListener(0,a,b,c,d,e,f)},b.prototype.Xoa=function(a,b,c,d,e,f){this.processListener(3,a,b,c,d,e,f)},b.prototype.Yg=function(a,b,c,d){this.visit(0,a,b,c,d)},b.prototype.clearListenersCache=function(){var a,b=this.Ze;for(a=0;a<b.length;a++)delete this[b[a]+"cached"]},b.prototype.getListeners=function(a,b){var c,d,e,f,g=a[b],h=this[g];if(h&&(d=g+"cached",c=this[d],!c)){c=this[d]=[];for(e in h)h.hasOwnProperty(e)&&(f=h[e],f&&c.push(f))}return c},b.prototype.visit=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this.Ze;for(g=0;g<r.length;g++)if(h=this[r[g]])for(i=this.getListeners(r,g),j=0;j<i.length;j++)if(k=i[j],l=k.row,m=k.col,n=k.rowCount,o=k.colCount,(l===-1||b===-1||l<b+d&&b<l+n)&&(m===-1||c===-1||m<c+e&&c<m+o))for(p=k.length,q=0;q<p;q++)f=k[q],0===a?f.bh():f.fh()},b.prototype.Bg=function(a,b,c,d){this.visit(1,a,b,c,d)},b.prototype.gh=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.Ze,m=c?1:-1;for(e=0;e<l.length;e++)if(f=this[l[e]])for(g=this.getListeners(l,e),h=0;h<g.length;h++)if(i=g[h],d=i,d&&(d.row===-1||d.row<=a&&a<d.row+d.rowCount)&&(d.col===-1||d.col<=b&&b<d.col+d.colCount))for(j=i.length,k=0;k<j;k++)i[k].delay+=m},b.prototype.og=function(){},b.prototype.ng=function(){},b}(h.BaseCalc),b.RangeCalc=Y;function ga(a,b,c,d,e){return{expr:a,acceptsArray:b,acceptsRef:c,index:d,context:e}}function ha(a,b,c,d,e,f,g){var i,l,m,n,o,p,r,s,u,v,z,A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=a.row,ea=a.column,fa=[],ha=0,ia=a.arrayIdentity?a.arrayIdentity.row:da,ja=a.arrayIdentity?a.arrayIdentity.col:ea;for(fa[ha]={expr:b,acceptsArray:f||!1,acceptsRef:g||!1,index:-1},i=0,l=0,m=!1,o=d,p=e,r=!1;ha>=0;){if(s=fa[ha],ha--,u=s.acceptsArray,v=s.acceptsRef,b=s.expr,z=q,b){if(7===b.type){if(I=b,K=I.arguments.length,!I.function){if(!a){z=h.Hh(y);continue}I.function=a.getFunction(I.functionName)}if(L=I.function,M=s.index,H=s.neeedExpendindexs,M<0?(s.arrayArgumentEvaluateMode=r,s.arrayFormulaCatchValue=c,L&&L.arrayArgumentEvaluateMode&&(r=L.arrayArgumentEvaluateMode),s.args=[]):(L&&L.acceptsArray(M)?i--:m&&(H||(H=[],s.neeedExpendindexs=H),I.arguments[M]!==A,H.push(M)),s.args.push(A)),M===K-1){if(r=s.arrayArgumentEvaluateMode,c=s.arrayFormulaCatchValue,N=s.args,O=!1,N&&N.length>0)for(P=0;P<N.length;P++)if(N[P]!==I.arguments[P]){O=!0;break}z=O?h.Jh(I,N):b,H&&H.length>0&&(z=h.createExpandExpression(z,H),m=!0)}else 0===M&&L&&3===L.arrayArgumentEvaluateMode&&3===r&&(r=0),m=!1,M++,s.index=M,L&&L.acceptsArray(M)&&i++,++ha,fa[ha]=s,++ha,fa[ha]={expr:I.arguments[M],acceptsArray:!!L&&L.acceptsArray(M),acceptsRef:!!L&&L.acceptsReference(M),index:-1}}else if(1===b.type&&b.sf())l&&(C=b.source!==h.BangSource&&b.source||a.source,D=C.getRowCount(),E=C.getColumnCount(),F=b.rowRelative?(b.row+ia)%j.MAX_ROW_COUNT%D:b.row,G=b.columnRelative?(b.column+ja)%j.MAX_COLUMN_COUNT%E:b.column,F=F<0?F+D:F,G=G<0?G+E:G,b=k.rf(b.source&&C,q,F,G,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(Q=b,B=Q.getRange(da,ea),Q.tzb(da,ea,a.source.id),!B){Q._error?(delete Q._error,z=A=w,a.szb=!0):(z=b,A=b);continue}b=k.uf(Q.source===a.source?q:Q.source,q,B.row,B.col,B.row+B.rowCount-1,B.col+B.colCount-1)}R=b.source!==h.BangSource&&b.source,S=b,l&&(C=R||a.source,D=j.MAX_ROW_COUNT,E=j.MAX_COLUMN_COUNT,T=S.rowRelative?(S.row+ia)%D:S.row,U=S.columnRelative?(S.column+ja)%E:S.column,V=S.endRowRelative?(S.endRow+ia)%D:S.endRow,W=S.endColumnRelative?(S.endColumn+ja)%E:S.endColumn,T=T<0?T+D:T,U=U<0?U+E:U,V=V<0?V+D:V,W=W<0?W+E:W,X=void 0,T>V&&(X=T,T=V,V=X),U>W&&(X=U,U=W,W=X),D=C.getRowCount(),E=C.getColumnCount(),T>=D?(T%=D,V%=D):V>=D&&(V=D-1),U>=E?(U%=E,W%=E):W>=E&&(W=E-1),b.row===j.BAND_INDEX_CONST&&(T=V=j.BAND_INDEX_CONST),b.column===j.BAND_INDEX_CONST&&(U=W=j.BAND_INDEX_CONST),b=k.uf(R,b.endSource,T,U,V,W,!1,!1,!1,!1)),v&&(u||!c&&1!==r&&3!==r)||da<0||ea<0||(i>0&&!c&&1!==r&&3!==r||0===i||2===r?(B=S.getRange(da,ea),c||(v||u)&&1===r?!S.isFullColumn&&1!==B.rowCount&&o>=B.rowCount||!S.isFullRow&&1!==B.colCount&&p>=B.colCount?z=h.Hh(x):(F=(S.isFullColumn?0:B.row)+(1===B.rowCount?0:o),G=(S.isFullRow?0:B.col)+(1===B.colCount?0:p),z=k.rf(R,b.endSource,F,G,!1,!1)):B.rowCount>1&&B.colCount>1||B.rowCount>1&&!S.isFullColumn&&(da<B.row||da>=B.row+B.rowCount)||B.colCount>1&&!S.isFullRow&&(ea<B.col||ea>=B.col+B.colCount)?z=h.Hh(t):(F=S.isFullColumn||B.rowCount>1?da:B.row,G=S.isFullRow||B.colCount>1?ea:B.col,z=k.rf(R,b.endSource,F,G,!1,!1))):m=!0)}else if(9===b.type)Y=b.operatorType>=15,s.index===-1?(s.index=b.value2?0:1,++ha,fa[ha]=s,++ha,fa[ha]=ga(b.value,Y,Y,-1)):0===s.index?(A!==b.value&&(z=h.Kh(b.operatorType,A,b.value2),s.expr=z),m&&(H=[],H.push(0),s.neeedExpendindexs=H,m=!1),s.index=1,++ha,fa[ha]=s,++ha,fa[ha]=ga(b.value2,Y,Y,-1)):(z=b.value2&&A!==b.value2?h.Kh(b.operatorType,b.value,A):b,H=s.neeedExpendindexs,m&&(H?H.push(1):H=[b.value2&&b.value2===n?1:0]),H&&(z=h.createExpandExpression(z,H),m=!0));else if(10===b.type)s.index===-1?(s.index=0,++ha,fa[ha]=s,++ha,fa[ha]=ga(b.value,u,v,-1)):b.value!==A&&(z=h.Lh(A));else if(8===b.type)1===s.index?(l--,z=A,s.context&&(a=s.context)):(l++,++ha,fa[ha]=ga(b,u,v,1,a),Z=void 0,$=a,_=void 0,b.source?(_=b.source===h.BangSource?a.source:b.source,$=new h.EvaluateContext(_),$.cloneFrom(a),Z=_.getCustomName(b.value)):(Z=a.getName(b.value),a.source.getCustomName(b.value)||($=new h.GloableEvaluateContext(a.source),$.cloneFrom(a))),Z||(Z=h.Hh(y)),a=$||a,++ha,fa[ha]=ga(Z,u,v,-1,a));else if(6===b.type)if(aa=b,!u&&(i>0||c||1===r||3===r))m=!0,n=b;else if(!u&&0===i)if(o>=aa.value.RowCount&&aa.value.RowCount>1||p>=aa.value.colCount&&aa.value.colCount>1)z=h.Hh(x);else try{1===aa.value.RowCount&&(o=0),1===aa.value.colCount&&(p=0),ba=aa.value.getValue(o,p),"string"==typeof ba?z=h.createStringExpression(ba):typeof ba===J&&(z=h.createNumberExpression(ba)),ca=new h.Parser,z=ca.parse(a.source.getParserContext(a.useR1C1,j.pf(0,0)),""+aa.value.getValue(o,p))}catch(a){z=h.Hh(x)}}else;z===q&&(z=b),A=z}return z}b.Mh=ha;function ia(a,b,c,d){var e=b.getSpan(c,d),f=q;return e.row===c&&e.col===d&&(f=a.getValue(c,d)),f}Z=function(a){_(b,a);function b(c){var d=a.call(this,q)||this;return d.getCalcSourceModel=function(){return this.Bf},d.createSourceModel=function(a){return new T(a,this)},d.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj&&this.kj.parent;if(a.endSource&&h&&h.sheets&&a.endSource instanceof b){for(c=h.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new P(f)}},d.kj=c,d}return b.prototype.startCalculation=function(){if(!this.Hu){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b,arrayInfo:[]},this.Iu=[]}},b.prototype.endCalculation=function(){var a,b,c;this.Hu=q,a=this.Iu,a&&a.length>0&&(b=this.kj,b.Wq(d.Events.RangeChanged,{sheet:b,sheetName:b.name(),row:0,col:0,rowCount:b.getRowCount(),colCount:b.getColumnCount(),changedCells:a,action:6},b.vxb)),this.Iu=q,c=this.Bf.ug(!1),c&&c.clearListenersCache()},b.prototype.clearValueCache=function(){this.Hu=q},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,n,o,p,u=[];for(c=2;c<arguments.length;c++)u[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===J)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==r)g=a.row,i=a.col;else if(a.name)return null;return b=b||0,g<0||i<0?t:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(j=e.Hu,k=s[b],j?(l=j.rowCount,m=j.colCount,n=void 0,o=void 0,p=void 0,g>=l?q:i>=m?q:(n=j[g],n||(n=j[g]={}),o=n[i],o||(o=n[i]={v:f.getValue(g,i)}),p=o[k],p===r&&(p=h.Convert.wf(o.v,b,!0),o[k]=p),p=d.Ul.w0a(p))):g>=e.getRowCount()?q:i>=e.getColumnCount()?q:e.kj.getValue(g,i))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b=this;return a.row===-1&&(a.row=0,a.rowCount=b.getRowCount()),a.col===-1&&(a.col=0,a.colCount=b.getColumnCount()),new h.CalcReference(b,[a])},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c=this,d=c.Hu,e=d&&d.arrayInfo;e&&e.forEach(function(c,f){if(c){var g=c.reference,h=c.key;D.call(g.yf[0],a,b)&&(delete d[h],delete e[f])}})},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,m,n,o,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=1,K=1,L=[],M=I.kj,N=I.Hu,O=s[b],P=M.ITa,Q=a.getRangeCount();if(0===Q)return L.isError=!0,L;if(N&&(x=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,o=N[x]))return o;for(y=this.getRowCount(),z=this.getColumnCount(),c=c===r||c,A=0;A<Q;A++){if(c||(v=[],L.push(v)),J=a.getRowCount(A),0===J)return L.isError=!0,L;if(K=a.getColumnCount(A),0===K)return L.isError=!0,L;if(m=a.getRow(A),n=a.getColumn(A),m>=y||n>=z)return L=[q],L.rowCount=1,L.colCount=1,L.rangeCount=1,L;for(m+J>y&&(J=y-m),n+K>z&&(K=z-n),B=void 0,C=void 0,D=M.Ju,E=0;E<J;E++)for(j=m+E,c||(B=[],v.push(B)),N&&(N[j]||(N[j]={}),w=N[j]),F=0;F<K;F++){if(k=n+F,D&&M.Ku===j&&M.Lu===k)o=M.Mu,D=!1;else{if(N?(C=w[k],C?o=C.v:(o=ia(M,P,j,k),C=w[k]={v:o})):o=ia(M,P,j,k),g&&(G=M.getFormatter(),H=void 0,H=G instanceof u?G.formatString():G,"@"===H?o=M.getText(j,k):o instanceof Date&&(o=l.Pa(o)),p(C)||(C=w[k]={v:o})),d&&h.Convert.vf(o))return L=[o],L.isError=!0,L;if(C&&C[O]!==r)o=C[O];else if(o=h.Convert.wf(o,b,!0,f,i),C&&(C[O]=o),e&&C===o)return L=[t],L.isError=!0,L}h.Convert.j$a(o,f)||(c?L.push(o):B.push(o))}}return c||1!==Q||(L=L[0]),L.rowCount=J,L.colCount=K,L.rangeCount=Q,N&&(N[x]=L,N[x].rowCount=J,N[x].colCount=K,N[x].rangeCount=Q,N.arrayInfo.push({reference:a,key:x})),L},b.prototype.getColumnCount=function(){return this.kj.getColumnCount()},b.prototype.getRowCount=function(){return this.kj.getRowCount()},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){return this.kj.name()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,p,q,s,t,u,v,w,x,y,z,A=[];for(b=1;b<arguments.length;b++)A[b-1]=arguments[b];if(c=this,e=c.kj,a=a,a.row!==r)f=a.row,g=a.col,h=1;else{if(a.name)return;f=arguments[0],g=arguments[1],h=2}i=arguments[h],j=arguments[h+1],k=c.Hu,k&&(l=k[f],l&&(m=l[g],m&&(m.v=i,m.b!==r&&(m.b=r),m.d!==r&&(m.d=r),m.n!==r&&(m.n=r),m.s!==r&&(m.s=r)))),n=d.Ul.x0a(i),p=e.ITa,q=!1,s=e.tables,t=s&&s.find(f,g),t&&(u=t.showHeader()&&f===t.headerIndex(),v=t.showFooter()&&f===t.footerIndex(),u||v||(q=t.yq(f,g,n))),w=e.wq,!q&&w&&w.Ou&&(x=w.getValue(f,g),x.hasBinding&&(y=void 0,k?(z=k.bindingRows=k.bindingRows||{},y=z[f],y||(y=z[f]=o({},e.getDataItem(f)))):y=o({},e.getDataItem(f)),p.Cp(f,g,{Dp:y,Ep:x.value}),w.setValue(f,g,n,p.zTa)),q=x.hasBinding),q||p.do("setValue",f,g,n,r,!0,!0),this.Iu?this.Iu.push({row:f,col:g}):this.kj.Wq(d.Events.CellChanged,{sheet:this.kj,sheetName:this.kj.name(),row:f,col:g,sheetArea:3,propertyName:"value",oldValue:j,newValue:i})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):q},b.prototype.getCustomName=function(a){a=E(a);var b=this.kj?this.kj.getCustomName(a):q;return b?b.getExpression():q},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c){},b.prototype.setArrayFormula=function(a,b,c,d,e){},b.prototype.setFormulaByName=function(a,b){},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=b,n=a.data||{},o=!0;for(j=0;j<=c;j++)if(e=n.dataTable||{},f=m[j]){for(h=e[j],o=!h,h=h||{},k=0;k<=d;k++)if(g=f[k],g&&g.Lf){i=h[k]||{};try{l=this.Cf().unparse(this,g.Lf,j,k,!1,!0),g.Pf?g.Pf.row===j&&g.Pf.col===k&&(i.arrayInfo=g.Pf,i.formula=l):i.formula=l,o=!1,h[k]=i}catch(a){}}o||(e[j]=h),p(e)||(n.dataTable=e)}p(n)||(a.data=n)},b}(h.CalcSource),b.SheetSource=Z,Z.prototype.getParserContext=function(a,b,c){return b=b||j.pf(0,0),new Q(this.kj,a,b,c)},$=function(a){_(b,a);function b(b){var c=a.call(this,q)||this;return c.createSourceModel=function(a){return new T(a,this)},c.Qu=b,c}return b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):q},b.prototype.getCustomName=function(a){var b=this.Qu?this.Qu.getCustomName(a):q;return b?b.getExpression():q},b}(h.CalcSource),b.SpreadSource=$;function ja(a,b,c,e,f,g){var i,k=a&&a instanceof d.Worksheet&&a,l=new h.Parser;return c=c===r?0:c,e=e===r?0:e,i=new Q(k,(!!f),j.pf(c,e)),g&&(i.culture=!0),l.parse(i,b)}b.formulaToExpression=ja;function ka(a,b,c,e,f,g){var i,k=a&&a instanceof d.Worksheet&&a,l=new h.Parser;return c=c===r?0:c,e=e===r?0:e,i=new Q(k,(!!f),j.pf(c,e)),i.YSa=g,l.unparse(i,b)}b.expressionToFormula=ka;function la(a,b,c,d,e){c===r&&(c=0),d===r&&(d=0);var f=ja(a,b,c,d,e,!0);return ma(a,f,c,d)}b.evaluateFormula=la;function ma(a,b,c,d,e){var f,g,h=a.Cf();return c===r&&(c=a.getActiveRowIndex()),d===r&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==r&&(f=e.convertNullToZero),g=a.yj(),h.Hg(g,b,j.pf(c,d),!1,f)}b.evaluateExpression=ma;function na(a,b,c,d,e){var f,h,i,l=a.row,m=a.col,n=a.row+a.rowCount-1,o=a.col+a.colCount-1,p=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(p=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=p?b:0,n-=r?b:0,m-=s?c:0,o-=t?c:0),e&&(h=oa(a,e,b),i=pa(a,e,b),h&&i)?f=g.StructureReferenceResolver.create(e,h,i,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=k.rf(q,q,l,m,p,s):(a.row<0&&(l=n=j.BAND_INDEX_CONST),a.col<0&&(m=o=j.BAND_INDEX_CONST),f=k.uf(q,q,l,m,n,o,p,s,r,t,b,c)),f)}b.rangeToExpression=na;function oa(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return r}function pa(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:r}function qa(a,b,c,d,e){var f=na(a,b,c,d),g=new Q(q,(!!e),j.pf(b,c)),i=new h.Parser,k=i.unparse(g,f);return g.no(),k}b.rangeToFormula=qa;function ra(a,b,c,d,e,f,g){var i=na(b,c,d,e,g),k=new Q(a,(!!f),j.pf(c,d)),l=new h.Parser;return l.unparse(k,i)}b.rangeToFormulaWithStructReference=ra;function sa(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0))if(h=g.source,h&&13===g.type);else if(1===g.type&&g.endSource){for(i=g.source,j=g.endSource,k=i.getSources(j),l=!1,m=0;m<k.length;m++)if(k[m]===a.yj()){l=!0;break}g=l&&g}return!g||!g.getRange||h&&h!==a.yj()?null:(n=g.getRange(c,e),n?new d.Range(n.row,n.col,n.rowCount,n.colCount):null)}b.formulaToRange=sa;function ta(a,b,c,e,f){var i,j,k,l,m,n,o,q,s,t,u=[],v=[];if(!b)return u;for(i={},c=c||0,e=e||0,j=new h.Parser,k=g.qzb(j,b,a,c,e,r,f),l=0;l<k.length;l++)if(m=k[l].sheetRanges,m&&!p(m))for(n=0;n<m.sheets.length;n++)for(o=m.sheets[n],v=i[o],v||(i[o]=v=[],u.push({sheetName:o,ranges:v})),q=m[o],s=0;s<q.length;s++)t=q[s],v.push(new d.Range(t.row,t.col,t.rowCount,t.colCount));return u}b.formulaToRanges=ta;function ua(a,b,c,d,e){var f,g,i,k="",l=new h.Parser,m=new Q(q,(!!e),j.pf(b,c));for(f=0;f<a.length;f++)g=na(a[f],b,c,d),i=l.unparse(m,g),k+=f>0?", "+i:i;return m.no(),k}b.rangesToFormula=ua,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function va(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(C(m)?+m:0)-h,s=d.getValue(e,g),t=(C(s)?+s:0)-h;if(C(s)&&Math.abs(t)<p)n=!0;else if(v(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(C(s)?+s:0)-h,C(s)&&Math.abs(j)<p?n=!0:v(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):t-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(t-j),r=i,t=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=va},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384;function d(a,b){return{row:a,col:b}}b.pf=d;function e(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}b.qf=e},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/referenceExpression.js"),h=c("./dist/plugins/sheetsCalc/parser-sheets.js"),i=c("Core"),j=Math.min,k=Math.max,l=void 0,m=null,n=d.Convert.vf,o=d.Errors.Reference,p=i.util.l_a;function t(a,b){var c,d,e,f;return b||(b=this),c=k(a.row,b.row),d=k(a.column,b.column),e=j(a.row+a.rowCount,b.row+b.rowCount),f=j(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?m:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:t}}q=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(){return this.Tj-this.Vj},a.prototype.Oj=function(){return this.Uj-this.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this;return f.Qj===a&&(f.Tj===-1||f.Tj<=b&&b+d<=f.Tj+f.Xj)&&(f.Uj===-1||f.Uj<=c&&c+e<=f.Uj+f.Yj)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?m:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:t}},a}();function u(a,b,c,d){return(!d||a<b)&&c}function v(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function w(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function x(a,b,c){var d=a[b];return!!d&&d[c]}r=function(){function a(){}return a.zj=function(b,c,e,g,h,i,k,l,m,n,p){var q,r,s,t,u,v=e,w=a,x=this.zj;if(!e)return v;if(10===e.type)v=d.Lh(x.call(w,b,c,e.value,g,h,i,k,l,m,n,p));else if(1===e.type&&e.sf()){if(q=j((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=j((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=q)||e.columnRelative&&(e.column+h<0||e.column+h>=r))return d.Hh(o,e.source);v=e.offset(0,0,!1)}else if(1===e.type){if(q=j((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=j((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),s=e,s.rowRelative&&!e.isFullColumn&&(s.row+g<0||s.row+g>q)||s.columnRelative&&!e.isFullRow&&(s.column+h<0||s.column+h>r)||s.endRowRelative&&!e.isFullColumn&&(s.endRow+g<0||s.endRow+g>q)||s.endColumnRelative&&!e.isFullRow&&(s.endColumn+h<0||s.endColumn+h>r))return d.Hh(o,e.source,e.endSource);v=e.offset(0,0,!1,g,h)}else if(9===e.type)v=d.Kh(e.operatorType,x.call(w,b,c,e.value,g,h,i,k,l,m,n,p),e.value2&&x.call(w,b,c,e.value2,g,h,i,k,l,m,n,p));else if(7===e.type){if(t=[],e.arguments&&e.arguments.length>0)for(u=0;u<e.arguments.length;u++)t[u]=x.call(w,b,c,e.arguments[u],g,h,i,k,l,m,n,p);v=d.Jh(e,t)}else 13===e.type&&(v=e.offsetWhenCopy(b,c,g,h,i,k,l,m,n,p));return v},a.copyFormula=function(b,c,g,h,i,k,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=b,R=h,S=b.getSource(),T=h.getSource(),U=a;if(Q&&R){for(p=T&&T.getSheet().ITa.dUa(),q=c,r=g,s=i,t=k,u=m,v=n,c<0&&(q=0,u=j(b.rC(),h.rC())),g<0&&(r=0,v=j(b.cC(),h.cC())),i<0&&(s=0),k<0&&(t=0),Q&&Q.Sg(s,t,u,v),w=new e.CalcSourceModel(b.Cf(),S),x=0;x<u;x++)for(y=0;y<v;y++)Q.Uf(w,x+q,y+r,x,y);for(z={},A=h.Cf(),x=0;x<u;x++)if(!o||!T.isHiddenRow(x+s,!0))for(B=x+s,y=0;y<v;y++)if(C=y+t,D=w.Kf(x,y)){if(D===z)continue;if(D=U.zj(S,T,w.Kf(x,y),B,C,i-c,k-g,i,k,u,v),E=w.Qf(x,y),T)if(E){for(F=E.rowCount,G=E.colCount,H=q-E.row,H>0&&(F-=H),I=u-x,I<F&&(F=I),J=r-E.col,J>0&&(G-=J),K=v-y,K<G&&(G=K),L=0;L<F;L++)for(M=0;M<G;M++)w.Rf(x+L,y+M,z);h.setArrayFormula(B,C,F,G,A.unparse(T,D,B,C),l,p)}else N=D?A.unparse(T,D,B,C):l,T.setFormula(B,C,N),O=w.Mf(x,y),O&&(P=new d.EvaluateContext(T,f.pf(B,C),(!1)),O=e.Mh(P,D,!1,0,0),O=O===D?l:O),R.ig(B,C,D,O,E,p);else R.Rf(x+s,y+t,D),R.Xf(x+s,y+t,E)}else R&&R.Kf(B,C)&&R.Sf(B,C,p)}},a.moveFormula=function(a,b,c,d,e,f,g,h){var k,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Bj(),F=d.Bj(),G=E.Cf();if(E&&F){for(k=E.dUa(),n=F.dUa(),o=G.ih(),b<0&&(b=0,g=j(a.getRowCount(),d.getRowCount())),e<0&&(e=0),c<0&&(c=0,h=j(a.getColumnCount(),d.getColumnCount())),f<0&&(f=0),p=!(a===d&&a.name()===d.name()),E.Sg(b,c,g,h),$(E,b,c,g,h),F.Sg(e,f,g,h),$(F,e,f,g,h),q=[],r=0;r<g;r++)for(s=0;s<h;s++)t=E.Kf(r+b,s+c),u=E.Qf(r+b,s+c),v=E.Mf(r+b,s+c),t?(q.push({Lf:t,Pf:u,Nf:v}),E.Sf(r+b,s+c,k)):q.push(m);for(x=p?{}:null,r=0;r<g;r++)for(y=r+e,s=0;s<h;s++)z=q.shift(),A=s+f,z?(t=z.Lf,u=z.Pf,G&&u&&u.row===b+r&&u.col===c+s&&(w=i.kf(y,A,u.rowCount,u.colCount)),B=u?w:l,v=z.Nf,F.FTa(n,y,A),F.Rf(y,A,t),F.Xf(y,A,B),F.Wf(y,A,v),p&&(x[y+", "+A]=t)):(F.FTa(n,y,A),F.Rf(y,A,l),F.Xf(y,A,l));o.Dj(E,b,c,g,h),o.Dj(F,e,f,g,h),C=E.getSource().getSheet(),D=C.uja&&(C.parent||C).tja(),o.Ej(D,E.getSource(),b,c,F.getSource(),e,f,g,h,!0,x),p===!0&&o.Ej(D,E.getSource(),b,c,F.getSource(),e,f,g,h,!0,x)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=m,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=m,a.nextAdj=m))},a.prototype.Gj=function(a,b,c,d,e){this.Hj(a,C,b,c,d,e);var f=0,g=0,h=0,i=0;0===b&&(d&&e?h=c:d?f=c:e?i=c:g=c),D(a,C,b,c,f,g,h,i,d,e),G(a,C,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,v,y,z,A,B,C,D=this,E=D.imb;if(E){for(o={};E[0];)if(k=E[0],g=k.ah,n=g.dUa(),m=g.getSource(),h=k.row,i=k.column,x(o,h,i))D.Fj(k,0);else{if(j=g.Kf(h,i))if(j=b.call(D,m,h,i,j,a,c,d,e,f),p=g.Qf(h,i)){if(m===a&&(q=f?d:-d,e?c<=p.row&&(p.row+=q):c<=p.col&&(p.col+=q)),h===p.row&&i===p.col)for(r=h;r<h+p.rowCount;r++)for(o[r]||(o[r]={}),s=i;s<i+p.colCount;s++)g.fg(r,s,j,p,r===h&&s===i,u(e?r:s,c,n,a.id===m.id)),w(o,r,s,!0)}else g.fg(h,i,j,p,!0,u(e?h:i,c,n,a.id===m.id));else(g.getRowExpression&&g.getRowExpression(h)||g.getColumnExpression&&g.getColumnExpression(i))&&g.Ag(h,i,1,1);D.Fj(k,0)}for(;E[1];)k=E[1],g=k.ah,n=g.dUa(),h=k.row,g.getRowExpression&&(j=g.getRowExpression(h),j&&g.fg&&(m=g.getSource(),g.fg(h,-1,b.call(D,m,h,-1,j,a,c,d,e,f),l,!0,u(h,c,n,a.id===m.id)))),D.Fj(k,1);for(;E[2];)k=E[2],g=k.ah,n=g.dUa(),i=k.column,g.getColumnExpression&&(j=g.getColumnExpression(i),j&&g.fg&&(m=g.getSource(),g.fg(-1,i,b.call(D,m,-1,i,j,a,c,d,e,f),l,!0,u(i,c,n,a.id===m.id)))),D.Fj(k,2);for(;E[3];)t=E[3],v=t.name,g=t.ah,j=g.DTa(v),y=b.call(D,g.getSource(),0,0,j,a,c,d,e,f,{isNameID:!0}),g.gg(v,y),D.Fj(t,3);for(z in E)if(A=+z,A>3&&E.hasOwnProperty(z))for(;E[z];)B=E[z],C=B.ah,j=b.call(D,C,0,0,B.expression,a,c,d,e,f),C.setExpression(B.id,B.name,j),D.Fj(B,A)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();$(c,0,0,d,e),b.Hj(a,M),D(a,M,0,0,0,0,0,0,!0,!1),G(a,M,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var m,n,o,p,r,s,t,u,y,z,A,B,C,D,E,F,G,H,J,K,L,M,N=this,O=W,P=new q(b,c,d,e,f,g,h,i),Q={};if(a&&X(a,P,j),I(b,P,j),t=N.imb,y={},t){for(;t[0];)if(n=t[0],m=n.ah,o=n.row,p=n.column,s=m.dUa(),x(Q,o,p))N.Fj(n,0);else{if(r=m.Kf(o,p),u=m.getSource(),r)if(z=l,k&&k[o+", "+p]&&(u=b,z={crossSheetMoved:!0}),r=O.call(N,u,o,p,r,P,j,z),A=m.Qf(o,p),B=void 0,A)if(B=v(A),o===A.row&&p===A.col)for(y[B]=!0,C=o;C<o+A.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+A.colCount;D++)m.fg(C,D,r,A,C===o&&D===p,s),w(Q,C,D,!0);else y[B]||(m.fg(o,p,r,A,!1,s),w(Q,o,p,!0));else m.fg(o,p,r,A,!0,s);else(m.getRowExpression&&m.getRowExpression(o)||m.getColumnExpression&&m.getColumnExpression(p))&&m.Ag(o,p,1,1);N.Fj(n,0)}for(;t[1];)n=t[1],m=n.ah,o=n.row,s=m.dUa(),m.getRowExpression&&(r=m.getRowExpression(o),r&&m.jg&&m.jg(o,O.call(N,u,o,-1,r,P,j),l,s)),N.Fj(n,1);for(;t[2];)n=t[2],m=n.ah,p=n.column,s=m.dUa(),m.getColumnExpression&&(r=m.getColumnExpression(p),r&&m.kg&&m.kg(p,O.call(N,u,-1,p,r,P,j),l,s)),N.Fj(n,2);for(;t[3];)E=t[3],F=E.name,m=E.ah,r=m.DTa(F),G=O.call(N,u,0,0,r,P,j),m.gg(F,G),N.Fj(E,3);for(H in t)if(J=+H,J>3&&t.hasOwnProperty(H))for(;t[H];)K=t[H],L=K.ah,M=L.getSource(),r=O.call(N,M,0,0,K.expression,P,j),L.setExpression(K.id,K.name,r),N.Fj(K,J)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,d,f,g,h=this,i=a.Cf().getAllSourceModels();for(d=0;d<i.length;d++)if(f=i[d],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof e.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),$(a,b,-1,c-b,-1,!0)},a.prototype.onAfterAddRemoveRows=function(a,b,c,d){var e=this,f=a.rC(),g=a.cC();d?a.Ag(b,0,c,g):f+=c,e.Dj(a,b,0,f-b,g),e.Jj(a,b,f-b),e.Kj(a),e.Gj(a.getSource(),b,c,!0,d),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d){var e=this,f=a.rC(),g=a.cC();d?a.Ag(0,b,f,c):g+=c,e.Dj(a,0,b,f,g-b),e.Ij(a,b,g-b),e.Kj(a),e.Gj(a.getSource(),b,c,!1,d),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),$(a,-1,b,-1,d-b,!0)},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return _(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,h,j,k,l,m,n,o,p=this,q=p.imb;if(q){for(h=0;h<b.length;h++)j=b[h],$(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);for(k={};q[0];)if(l=q[0],d=l.ah,e=l.row,f=l.column,x(k,e,f))p.Fj(l,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),m=d.Qf(e,f))for(m=i.kf(e,f,m.rowCount,m.colCount),n=e;n<e+m.rowCount;n++)for(k[n]||(k[n]={}),o=f;o<f+m.colCount;o++)d.fg(n,o,g,m,n===e&&o===f),w(k,n,o,!0);else d.fg(e,f,g,m,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);p.Fj(l,0)}}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,h){var i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,z,A=a.adjustExpressionOnRemoveTable;if(9===b.type){if(i=b.value,j=b.value2,k=A(i,c,e,f,h),l=j&&A(j,c,e,f,h),i!==k||j!==l)return d.Kh(b.operatorType,k,l)}else if(7===b.type){for(n=!1,o=[],p=0;p<b.arguments.length;p++)q=b.arguments[p],r=A(q,c,e,f,h),n=n||q!==r,o.push(r);if(n)return d.Jh(b,o)}else if(10===b.type){if(s=b,t=s.value,u=A(t,c,e,f,h),t!==u)return d.Lh(u)}else if(13===b.type)for(v=b,p=0;p<c.length;p++)if(v.baseTable===c[p])return h?d.Ih:(w=v.getRange(e===-1?0:e,f===-1?0:f,!0),x=e===-1||1===v.referencePortions(),y=1===w.rowCount&&1===w.columnCount,z=v.source,y?g.rf(z,m,w.row,w.col,x,!1):g.uf(z,m,w.row,w.col,w.row+w.rowCount-1,w.col+w.colCount-1,x,!1,x,!1));return b},a}(),b.CalcOperatorAdjustor=r,s=d.CalcService.prototype,s.uzb=function(){return new r};function y(a,b,c,d,e,f,g,h,i,j){var k,l;return c>=0||!e?(k=d+(e?c:0),l=f+(g?c:0),h===a&&i+j<=c&&(k-=e?j:0,l-=g?j:0),h===b&&(i<=k?(k+=j,l+=j):i<=l&&(l+=j)),k-=e?c:0,l-=g?c:0,{index:k,endIndex:l}):{index:d,endIndex:f}}function z(a,b,c,e,f,g,h,i,j,k){if(b){var l=j?f.row:f.column,m=j?f.rowRelative:f.columnRelative,o=void 0;if(j&&c>=0||!j&&e>=0||!m){if(k)o=y(a,b,j?c:e,l,m,-1,!1,g,h,i).index;else if(o=J(a,b,j?c:e,l,m,g,h,i),n(o))return d.Hh(o);o!==l&&(f=f.offset(j?o-l:0,j?0:o-l,!0))}}return f}function A(a,b,c,e,f,g,h,i,j,k){var l,m,o,p,q,r,s,t;if(b){if(l=f.tf(),3===l||j&&2===l||!j&&1===l)return f;if(m=j?f.rowRelative:f.columnRelative,o=j?f.endRowRelative:f.endColumnRelative,p=j?f.row:f.column,q=j?f.endRow:f.endColumn,r=void 0,j&&c>=0||!j&&e>=0||!m||!o){if(k)r=y(a,b,j?c:e,p,m,q,o,g,h,i);else if(r=K(a,b,j?c:e,p,m,q,o,g,h,i),n(r))return d.Hh(r);s=r.index,t=r.endIndex,s===p&&t===q||(f=f.offset2(j?s-p:0,j?0:s-p,j?t-q:0,j?0:t-q,c,e))}}return f}function B(a,b,c,d,e,f,g,h,i){if(b){var j=e;if(j&&b===j.source)return j.offsetWhenInsertRemoveColumn(g,h,i)}return e}function C(a,b,c,e,f,g,h,i,j){var k,n,o,p,q,r,s,t,u=C,v=e;if(e){if(1===e.type&&e.sf())v=z(a,e.source||a,b,c,e,f,g,h,i,j);else if(1===e.type)v=A(a,e.source||a,b,c,e,f,g,h,i,j);else if(10===e.type)k=u(a,b,c,e.value,f,g,h,i,j),k!==e.value&&(v=d.Lh(k));else if(9===e.type)n=u(a,b,c,e.value,f,g,h,i,j),o=e.value2&&u(a,b,c,e.value2,f,g,h,i,j),n===e.value&&o===e.value2||(v=d.Kh(e.operatorType,n,o));else if(7===e.type){for(p=m,q=void 0,r=void 0,s=e,t=s.arguments.length,r=0;r<t;r++)if(q=s.arguments[r],k=u(a,b,c,q,f,g,h,i,j),k!==q){p=[],p[r]=k;break}if(p){for(r=0;r<t;r++)q=s.arguments[r],p[r]!==l&&p[r]!==m||(p[r]=u(a,b,c,q,f,g,h,i,j));v=d.Jh(s,p)}}else i||13!==e.type||(v=B(a,a,b,c,e,f,g,h,j));return v}}function D(a,b,c,d,e,f,g,h,i,j){var k=function(e,f,g,h){return b.call(this,e,g,h,f,a,c,d,i,j)},l=a.getSheet(),m=l.uja&&(l.parent||l).tja(),n=l.ITa&&l.ITa.dUa();
E(m,k,i,n)}function E(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(a)for(k=0;k<a.length;k++){for(l=!0,m=!0,n=h.maxRowCount-1,o=h.maxColumnCount-1,e=a[k].validator,p=e.n5,q=0,r=p.length;q<r&&(s=p[q],t=s.rowCount,u=s.colCount,i=s.row,j=s.col,t!==-1&&(m=!1,n=n>i?i:n),u!==-1&&(l=!1,o=o>j?j:o),l||m);q++);if(!(c&&m||!c&&l)&&(g=a[k].sheet,v=g.yj(),f=e.condition(),w=f.getExpressions(),w&&w.length>0)){for(x=0;x<w.length;x++)y=w[x],w[x]=b(v,y,n,o);f.setExpressions(w,d)}}}function F(a){var b=[],c=a.parent,d=c&&c.sheets||[a];return d.forEach(function(a){var c=a.conditionalFormats,d=c&&c.getRules();d&&d.length&&d.forEach(function(c){c.xyb&&b.push({rule:c,sheet:a})})}),b}function G(a,b,c,d,e,f){var g=function(g,h,i,j){return b.call(this,g,i,j,h,a,c,d,e,f)},h=a.getSheet(),i=F(h),j=h.ITa&&h.ITa.dUa();H(i,g,j)}function H(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,q;if(a)for(d=0,e=a.length;d<e;d++)if(f=a[d].rule,g=f.ranges(),h=p(g),i=h.r,j=h.c,k=a[d].sheet,l=k.yj(),m=f.condition(),m||(f.initCondition(),m=f.condition()),n=m&&m.getExpressions(),n&&n.length>0){for(o=0;o<n.length;o++)q=n[o],n[o]=b(l,q,i,j);m.setExpressions(n,c)}}function I(a,b,c){var d=function(a,d,e,f){return W.call(this,a,e,f,d,b,c)},e=a.getSheet(),f=F(e);H(f,d,e.ITa.dUa())}function J(a,b,c,d,e,f,g,h){if(c>=0||!e){var i=d+(e?c:0);if(f===a&&g<=c&&(i+=e?h:0),f===b)if(g+h<=i)i-=h;else if(g<=i)return o;return i-=e?c:0}return d}function K(a,b,c,d,e,f,g,h,i,j){var k,l,m;if(c>=0||!e){if(k=d+(e?c:0),l=f+(g?c:0),m=i+j-1,h===a&&i<=c&&(k+=e?j:0,l+=g?j:0),h===b)if(m<k)k-=j,l-=j;else{if(i<=k&&m>=l)return o;i>l||(m<=l?(k=i>=k?k:i,l-=j):l=i-1)}return k-=e?c:0,l-=g?c:0,{index:k,endIndex:l}}return{index:d,endIndex:f}}function L(a,b,c){var e,f,g,h,i,j,k,n,o=L,p=b;if(b)if(b.source)h=b.source,(a!==c&&h===c||a===c&&h!==c)&&(p=d.Ih);else if(10===b.type)e=o(a,b.value,c),e!==b.value&&(p=d.Lh(e));else if(9===b.type)i=o(a,b.value,c),j=b.value2&&o(a,b.value2,c),i===b.value&&j===b.value2||(p=d.Kh(b.operatorType,i,j));else if(7===b.type){for(k=m,n=b.arguments.length,g=0;g<n;g++)if(f=b.arguments[g],e=o(a,f,c),e!==f){k=[],k[g]=e;break}if(k){for(g=0;g<n;g++)f=b.arguments[g],k[g]!==l&&k[g]!==m||(k[g]=o(a,f,c));p=d.Jh(b,k)}}return p}function M(a,b,c,d,e){return L(a,d,e)}function N(a,b){return a.Qj===a.Rj&&b!==a.Qj}function O(a,b,c,e,f,h){var i,j,k,l,n,o,p=!!e.source,q=e.source||a,r=e.rowRelative,s=e.columnRelative,t=f.Nj(),u=f.Oj();if((b>=0||!r)&&(c>=0||!s)){if(i=e.row+(r?b:0),j=e.column+(s?c:0),h&&h.isNameID||a===f.Rj&&(a===f.Qj?l=f.Pj(f.Qj,b,c,1,1):(n=b,o=c,h&&h.crossSheetMoved&&(n-=t,o-=u),l=f.Sj(f.Rj,n,o,1,1))),q===f.Qj&&f.Pj(q,i,j,1,1)&&!f.Sj(q,i,j,1,1)&&(!r&&!s||!l))return d.Ih;if(k=(p&&q===f.Rj||!p&&a===f.Rj)&&(!l&&f.Sj(f.Rj,i,j,1,1)||l&&f.Pj(f.Qj,r?i:i+t,s?j:j+u,1,1)),l&&(i-=r?t:0,j-=s?u:0),k&&(i+=t,j+=u),i-=r?b:0,j-=s?c:0,q=e.source,f.Rj!==f.Qj&&(k&&l?p&&(q=f.Qj):k?q=f.Qj:l&&!p&&(q=f.Rj)),i!==e.row||j!==e.column||q!==e.source)return g.rf(q,m,i,j,r,s)}else if((b>=0||!r)&&c===-1){if(i=e.row+(r?b:0),f.Pj(a,b,c,1,1)&&(i-=r?t:0),f.Sj(q,i,-1,1,-1))i+=t;else if(f.Pj(q,i,-1,1,-1))return d.Ih;if(i-=r?b:0,i!==e.row)return g.rf(e.source,m,i,e.column,r,e.columnRelative)}else if(b===-1&&c>=0&&!s){if(j=e.column+(s?c:0),f.Pj(a,b,c,1,1)&&(j-=s?u:0),f.Sj(q,i,j,1,1))j+=u;else if(f.Pj(q,i,j,1,1))return d.Ih;if(j-=s?c:0,i!==e.row||j!==e.column)return g.rf(e.source,e.endSource,e.row,j,e.rowRelative,s)}return e}function P(a,b){if(b=a.getIntersect(b,0,0),!b)return m;var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return a.rowCount===b.rowCount&&a.colCount===b.colCount||(a.rowCount===b.rowCount?(a.col===b.col&&(d=a.col+b.colCount),f=a.colCount-b.colCount):a.colCount===b.colCount&&(a.row===b.row&&(c=a.row+b.rowCount),e=a.rowCount-b.rowCount)),i.kf(c,d,e,f)}function Q(a,b,c,d,e){var f,g;return!(!b||!a)&&(f=b.getIntersect(a,0,0),!(f||!(g=b.getIntersect(c,0,0)))||(!(!f||f.rowCount!==b.rowCount||0===e)||!(!f||f.colCount!==b.colCount||0===d)))}function R(a,b,c){var d=a.getRange(b,c);return i.kf(d.row,d.col,d.rowCount,d.colCount)}function S(a,b,c){var d,e=P(a,b);return d=e?e.union(c):c,{startRow:d.row,endRow:d.row+d.rowCount-1,startColumn:d.col,endColumn:d.col+d.colCount-1}}function T(a,b,c,d,e){var f,g=P(a,b),h=a.getIntersect(b,0,0);return h.row+=d,h.col+=e,f=g?g.union(h):c,{startRow:f.row,endRow:f.row+f.rowCount-1,startColumn:f.col,endColumn:f.col+f.colCount-1}}function U(a,b,c,d,e,f){var g,h,j,k,l=R(d,e,f),m=l.row,n=l.row+l.rowCount-1,o=l.col,p=l.col+l.colCount-1,q=a.Vj,r=q+a.Xj-1,s=a.Wj,t=s+a.Yj-1,u=a.Tj,v=a.Uj,w=i.kf(q,s,a.Xj,a.Yj),x=i.kf(u,v,a.Xj,a.Yj),y=l.getIntersect(x,0,0);if(Q(w,l,x,b,c))if(h=0!==b,j=void 0,k=void 0,h)if(j=m>=q&&m<=r,k=n>=q&&n<=r,j&&k)m+=b,n+=b;else if(j&&!k)if(b<=0)m+=b;else if(q+b>n);else{if(!(r+b<n))return T(l,w,x,b,c);if(q===m)return S(l,w,x);m+=b}else if(!j&&k)if(b>=0)n+=b;else if(r+b<m);else{if(!(u>m))return T(l,w,x,b,c);if(r===n)return S(l,w,x);n+=b}else y&&!y.equals(x)&&(g=P(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);else if(j=o>=s&&o<=t,k=p>=s&&p<=t,j&&k)o+=c,p+=c;else if(j&&!k)if(c<0)o+=c;else if(s+c>p);else{if(!(t+c<p))return T(l,w,x,b,c);if(s===o)return S(l,w,x);o+=c}else if(!j&&k)if(c>0)p+=c;else if(t+c<o);else{if(!(v>o))return T(l,w,x,b,c);if(t===p)return S(l,w,x);p+=c}else y&&!y.equals(x)&&(g=P(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);return{startRow:m,endRow:n,startColumn:o,endColumn:p}}function V(a,b,c,e,h,i){var j,k,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,O,P=!!e.source,Q=P?e.source:a,R=e.tf(),S=h.Nj(),T=h.Oj(),V=i&&i.isDataValidator,W=N(h,a);if(0===R)if(j=e.rowRelative,k=e.columnRelative,n=e.endRowRelative,o=e.endColumnRelative,b>=0||!j||!n||c>=0||!k||!o){if(p=e.row+(j?b:0),q=e.endRow+(n?b:0),r=e.column+(k?c:0),s=e.endColumn+(o?c:0),t=q-p+1,u=s-r+1,!V&&W)return D=h.Sj(h.Rj,p,r,t,u),D?e.offset(S,T,!0):h.Pj(Q,p,r,t,u)?d.Ih:e;if(i&&i.isNameID||a===h.Rj&&(a===h.Qj?C=h.Pj(h.Qj,b,c,1,1):(E=b,F=c,i&&i.crossSheetMoved&&(E-=S,F-=T),C=h.Sj(h.Rj,E,F,1,1))),a===Q&&a===h.Rj&&a===h.Qj&&j&&k&&n&&o&&(G=b,H=c,C&&(G-=S,H-=T),I=U(h,S,T,e,G,H),0===T&&S&&I.endColumn>=s&&I.startColumn<=r||0===S&&T&&I.endRow>=q&&I.startRow<=p))return J={startRow:I.startRow-b,endRow:I.endRow-b,startColumn:I.startColumn-c,endColumn:I.endColumn-c},J?g.uf(e.source,m,J.startRow,J.startColumn,J.endRow,J.endColumn,j,k,n,o,b,c):d.Ih;if(C&&(K=h.Tj-h.Vj,L=h.Uj-h.Wj,t+=(j?-K:0)+(n?K:0),u+=(k?-L:0)+(o?L:0)),Q===h.Qj&&h.Pj(Q,p,r,t,u)&&!u&&(!j&&!k&&!n&&!o||!C))return d.Ih;if(B=(P&&Q===h.Rj||!P&&a===h.Rj)&&(!C&&h.Sj(h.Rj,p,r,t,u)||C&&h.Pj(h.Qj,j?p:p+S,k?r:r+T,t,u)),C&&(x=j?S:0,y=n?S:0,z=k?T:0,A=o?T:0,p-=x,q-=y,r-=z,s-=A),M=!1,B)v=S,w=T,p+=v,q+=v,r+=w,s+=w;else if(h.Pj(Q,p,r,t,u)){if(O=h.intersectWith(Q,p,r,t,u),!O||O.rowCount!==t&&O.colCount!==u)return d.Ih;p=O.row+S,r=O.col+T,q=p+O.rowCount,s=r+O.colCount,M=!0}if(p-=j?b:0,q-=n?b:0,r-=k?c:0,s-=o?c:0,h.Rj===h.Qj?Q=P?e.source:l:(Q=e.source,B&&C&&P?Q=h.Qj:B&&C||(B?Q=h.Qj:C&&!P&&(Q=h.Rj))),p!==e.row||r!==e.column||q!==e.endRow||s!==e.endColumn||M||Q!==e.source)return g.uf(Q,m,p,r,q,s,j,k,n,o,b,c)}else if(!(b>=0)&&j&&n||c!==-1){if(b===-1&&(c>=0||!k||!o)){if(r=e.column+(k?c:0),s=e.endColumn+(o?c:0),r>s)return d.Ih;if(h.Pj(a,b,c,1,1)&&(z=k?T:0,A=o?T:0,r-=z,s-=A),u=s-r,h.Sj(Q,-1,r,-1,u))w=T,r+=w,s+=w;else if(h.Pj(Q,-1,r,-1,u))return d.Ih;if(r-=k?c:0,s-=o?c:0,r!==e.column||s!==e.endColumn)return g.uf(e.source,m,e.row,r,e.endRow,s,e.rowRelative,k,e.endRowRelative,o,b,c)}}else{if(p=e.row+(j?b:0),q=e.endRow+(n?b:0),p>q)return d.Ih;if(h.Pj(a,b,c,1,1)&&(x=j?S:0,y=n?S:0,p-=x,q-=y),t=q-p,h.Sj(Q,p,-1,t,-1))v=S,p+=v,q+=v;else if(h.Pj(Q,p,-1,t,-1))return d.Ih;if(p-=j?b:0,q-=n?b:0,p!==e.row||q!==e.endRow)return g.uf(e.source,m,p,e.column,q,e.endColumn,j,e.columnRelative,n,e.endColumnRelative,b,c)}else if(1===R){if(j=e.rowRelative,n=e.endRowRelative,b>=0||!j||!n){if(p=e.row+(j?b:0),q=e.endRow+(n?b:0),p>q)return d.Ih;if(h.Pj(a,b,c,1,1)&&(x=j?S:0,y=n?S:0,p-=x,q-=y),t=q-p,h.Sj(Q,p,-1,t,-1))v=S,p+=v,q+=v;else if(h.Pj(Q,p,-1,t,-1))return d.Ih;if(p-=j?b:0,q-=n?b:0,p!==e.row||q!==e.endRow)return g.uf(e.source,e.endSource,p,f.BAND_INDEX_CONST,q,f.BAND_INDEX_CONST,j,!1,n,!1,b,c)}}else if(2===R){if(k=e.columnRelative,o=e.endColumnRelative,r=e.column+(k?c:0),s=e.endColumn+(o?c:0),r<s)return d.Ih;if(h.Pj(a,b,c,1,1)&&(z=k?T:0,A=o?T:0,r-=z,s-=A),u=s-r,h.Sj(Q,-1,r,-1,u))w=T,r+=w,s+=w;else if(h.Pj(Q,-1,r,-1,u))return d.Ih;if(r-=k?c:0,s-=o?c:0,r!==e.column||s!==e.endColumn)return g.uf(e.source,e.endSource,f.BAND_INDEX_CONST,r,f.BAND_INDEX_CONST,s,!1,k,!1,o,b,c)}return e}function W(a,b,c,e,f,g,h){var i,j,k,n,o,p,q,r=W,s=e;if(1===e.type&&e.sf())s=g?O(a,b,c,e,f,h):Y(a,b,c,e,f);else if(1===e.type)s=g?V(a,b,c,e,f,h):Z(a,b,c,e,f);else if(10===e.type)i=r(a,b,c,e.value,f,g,h),i!==e.value&&(s=d.Lh(i));else if(9===e.type)j=r(a,b,c,e.value,f,g,h),k=e.value2&&r(a,b,c,e.value2,f,g,h),j===e.value&&k===e.value2||(s=d.Kh(e.operatorType,j,k));else if(7===e.type){for(n=m,o=void 0,p=void 0,q=e.arguments.length,p=0;p<q;p++)if(o=e.arguments[p],i=r(a,b,c,o,f,g,h),i!==o){n=[],n[p]=i;break}if(n){for(p=0;p<q;p++)o=e.arguments[p],n[p]!==l&&n[p]!==m||(n[p]=r(a,b,c,o,f,g,h));s=d.Jh(e,n)}}return s}function X(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,q=b.Rj.getSheet().ITa.dUa();for(d=0;d<a.length;d++)if(e=a[d].validator,f=e.n5,g=p(f),h=g.r,i=g.c,j=a[d].sheet,k=j.yj(),l=e.condition(),m=l.getExpressions(),m&&m.length>0){for(n=0;n<m.length;n++)o=m[n],m[n]=W(k,h,i,o,b,c,{isDataValidator:!0});l.setExpressions(m,q)}}function Y(a,b,c,d,e){var f,h,i=d.source||a,j=d.rowRelative,k=d.columnRelative,l=e.Nj(),n=e.Oj();if((b>=0||!j)&&(c>=0||!k)){if(f=d.row+(j?b:0),h=d.column+(k?c:0),e.Pj(a,b,c,1,1)?(f-=j?l:0,h-=k?n:0):e.Sj(a,f,h,1,1)&&(f+=j?l:0,h+=k?n:0),e.Sj(i,f,h,1,1)?(f+=l,h+=n):e.Pj(i,f,h,1,1)&&(f-=l,h-=n),f-=j?b:0,h-=k?c:0,f!==d.row||h!==d.column)return g.rf(d.source,m,f,h,j,k)}else if((b>=0||!j)&&c===-1){if(f=d.row+(j?b:0),e.Pj(a,b,-1,1,-1)?f-=j?l:0:e.Sj(a,f,-1,1,-1)&&(f+=j?l:0),e.Sj(i,f,-1,1,-1)?f+=l:e.Pj(i,f,-1,1,-1)&&(f-=l),f-=j?b:0,f!==d.row||h!==d.column)return g.rf(d.source,m,f,d.column,j,d.columnRelative)}else if(b===-1&&c>=0&&!k&&(h=d.column+0,e.Pj(a,-1,c,-1,1)?h-=0:e.Sj(a,-1,h,-1,1)&&(h+=0),e.Sj(i,-1,h,-1,1)?h+=n:e.Pj(i,-1,h,-1,1)&&(h-=n),h-=0,f!==d.row||h!==d.column))return g.rf(d.source,m,d.row,h,d.rowRelative,k);return d}function Z(a,b,c,e,h){var i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,z=e.source||a,A=e.tf(),B=h.Nj(),C=h.Oj();if(0===A){if(p=e.rowRelative,q=e.columnRelative,r=e.endRowRelative,s=e.endColumnRelative,!(b>=0)&&p&&r||!(c>=0)&&q&&s)if(!(b>=0)&&p&&r||c!==-1){if(b===-1&&(c>=0||!q||!s)){if(k=e.column+(q?c:0),l=e.endColumn+(s?c:0),k<l)return d.Ih;if(h.Pj(a,-1,c,-1,1)?(w=q?C:0,y=s?C:0,k-=w,l-=y):h.Sj(a,-1,c,-1,1)&&(w=q?C:0,y=s?C:0,k+=w,l+=y),o=l-k,h.Sj(z,-1,k,-1,o)?(u=C,k+=u,l+=u):h.Pj(z,-1,k,-1,o)&&(u=C,k-=u,l-=u),k-=q?c:0,l-=s?c:0,k!==e.column||l!==e.endColumn)return g.uf(e.source,m,k,e.endRow,l,e.rowRelative,q,e.endRowRelative,s,b,c)}}else{if(i=e.row+(p?b:0),j=e.endRow+(r?b:0),i<j)return d.Ih;if(h.Pj(a,b,-1,1,-1)?(v=p?B:0,x=p?B:0,i-=v,j-=x):h.Sj(a,b,-1,1,-1)&&(v=p?B:0,x=p?B:0,i+=v,j+=x),n=j-i,h.Sj(z,i,-1,n,-1)?(t=B,i+=t,j+=t):h.Pj(z,i,-1,n,-1)&&(t=B,i-=t,j-=t),i-=p?b:0,j-=r?b:0,i!==e.row||j!==e.endRow)return g.uf(e.source,m,i,e.column,j,e.endColumn,p,e.columnRelative,r,e.endColumnRelative,b,c)}else if(i=e.row+(p?b:0),j=e.endRow+(r?b:0),k=e.column+(q?c:0),l=e.endColumn+(s?c:0),n=j-i,o=l-k,h.Pj(a,b,c,1,1)?(v=p?B:0,w=q?C:0,x=r?B:0,y=s?C:0,i-=v,j-=x,k-=w,l-=y):h.Sj(a,i,k,n,o)&&(v=p?B:0,w=q?C:0,x=r?B:0,y=s?C:0,i+=v,j+=x,k+=w,l+=y),h.Sj(z,i,k,n,o)?(t=B,u=C,i+=t,j+=t,k+=u,l+=u):h.Pj(z,i,k,n,o)&&(t=B,u=C,i-=t,j-=t,k-=u,l-=u),i-=p?b:0,j-=r?b:0,k-=q?c:0,l-=s?c:0,i!==e.row||k!==e.column||j!==e.endRow||l!==e.endColumn)return g.uf(e.source,m,i,k,j,l,p,q,r,s,b,c)}else if(1===A){if(p=e.rowRelative,r=e.endRowRelative,b>=0||!p||!r){if(i=e.row+(p?b:0),j=e.endRow+(r?b:0),i<j)return d.Ih;if(h.Pj(a,b,-1,1,-1)?(v=p?B:0,x=r?B:0,i-=v,j-=x):h.Sj(a,b,-1,1,-1)&&(v=p?B:0,x=r?B:0,i+=v,j+=x),n=j-i,h.Sj(z,i,-1,n,-1)?(t=B,i+=t,j+=t):h.Pj(z,i,-1,n,-1)&&(t=B,i-=t,j-=t),i-=p?b:0,j-=r?b:0,i!==e.row||j!==e.endRow)return g.uf(e.source,m,i,f.BAND_INDEX_CONST,j,f.BAND_INDEX_CONST,p,!1,r,!1,b,c)}}else if(2===A){if(q=e.columnRelative,s=e.endColumnRelative,k=e.column+(q?c:0),l=e.endColumn+(s?c:0),k>l)return d.Ih;if(h.Pj(a,-1,c,-1,1)?(w=q?C:0,y=s?C:0,k-=w,l-=y):h.Sj(a,-1,c,-1,1)&&(w=q?C:0,y=s?C:0,k+=w,l+=y),o=l-k,h.Sj(z,-1,k,-1,o)?(u=C,k+=u,l+=u):h.Pj(z,-1,k,-1,o)&&(u=C,k-=u,l-=u),k-=q?c:0,l-=s?c:0,k!==e.column||l!==e.endColumn)return g.uf(e.source,m,f.BAND_INDEX_CONST,k,f.BAND_INDEX_CONST,l,!1,q,!1,s,b,c)}return e}function $(a,b,c,d,e,f){a._g(b,c,d,e,!0,!1,f)}function _(a,b,c){var e,f,g,h,i,j,k,n=_,p=b;if(8===b.type){if(b.value===c&&(!b.source||b.source===a.getSource()))return d.Hh(o,b.source)}else if(10===b.type)e=n(a,b.value,c),e!==b.value&&(p=d.Lh(e));else if(9===b.type)h=n(a,b.value,c),i=b.value2&&n(a,b.value2,c),h===b.value&&i===b.value2||(p=d.Kh(b.operatorType,h,i));else if(7===b.type){for(j=m,k=b.arguments.length,g=0;g<k;g++)if(f=b.arguments[g],e=n(a,f,c),e!==f){j=[],j[g]=e;break}if(j){for(g=0;g<k;g++)f=b.arguments[g],j[g]!==l&&j[g]!==m||(j[g]=n(a,f,c));p=d.Jh(b,j)}}return p}},"./dist/plugins/sheetsCalc/parser-sheets.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc.ns.js"),i=c("./dist/plugins/sheetsCalc/referenceExpression.js"),j=c("./node_modules/util/util.js"),k=d.util.xq,l=new e.Common.ResourceManager(d.SR),m=l.getResource.bind(l),n=f.Errors.Reference,b.maxRowCount=1048576,b.maxColumnCount=16384,o=[1,26,676],p=void 0,q=null,r=["#all","#data","#headers","#totals","#this row"];function B(a){return k(a+1).split("")}function C(a,b){var c=b+1;return a<0?a%c+c:a>b?a%c:a}s=function(a){A(b,a);function b(b){var c=a.call(this,q)||this;return c.u4=b,c}return b.prototype.startCalculation=function(){},b.prototype.endCalculation=function(){},b.prototype.getValue=function(){return n},b.prototype.getReference=function(){var a=new f.CalcReference(this,[h.pf(0,0)]);return a.getValue=function(){return n},a},b.prototype.referenceToArray=function(){var a=[n];return a.isError=!0,a},b.prototype.getName=function(){return this.u4},b.prototype.setValue=function(){},b}(f.CalcSource),b.ErrorSource=s;function D(a){return new s(a)}function E(a,b,c,d,e,f,g){return 3===g||c>=0&&d>=0||1===g&&c>=0||2===g&&d>=0}function F(a,b,c,d){var e,g,i=h.BAND_INDEX_CONST,j={cj:i,dj:i,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},k=b?J(a,c,d,0):I(a,0);return k.hj?(j.cj=k.ij,j.ej=k.jj):(j.dj=k.ij,j.fj=k.jj),j.li=k.li,j.gj=k.gj,!k.gj||k.li>=a.length?j:!b&&k.hj||b&&!k.hj?{gj:!1}:(e=a[j.li],!b&&(f.isNumber(e)||"$"===e)||b&&("C"===e||"c"===e)?(g=b?J(a,c,d,j.li):I(a,j.li),j.li=g.li,!g.gj||!b&&!g.hj||b&&g.hj?(j.gj=!1,j):(j.li<a.length&&(j.Vka=!1),b?(j.dj=g.ij,j.fj=g.jj):(j.cj=g.ij,j.ej=g.jj),j.gj=!0,j)):{gj:!1})}t=[1,10,100,1e3,1e4,1e5,1e6,1e6];function G(a){return f.ei(a)||95===a.charCodeAt(0)}function H(a,b,c){for(var d=a,e=b[a],f=!1;d<c&&!G(e);)d++,d<c&&(e=b[d]);if(d<c){for(;d<c&&G(e);)d++,d<c&&(e=b[d]);d<c&&(f=!0)}return f}function I(a,c){var d,e,g,h,i,j,k,l,m,n={jj:!0,gj:!1},p=a.length;if(c>=p)return n;if("$"===a[c]&&(n.jj=!1,c++),c>=p)return n;if(d=c,e=0,g=a[d],f.isNumber(g)&&"0"!==g){for(n.hj=!0;d<p&&f.isNumber(g);)d++,d<p&&(g=a[d]);if(d-c>7)return n;for(h=d-1,i=0;h>=c;h--,i++)e+=(a[h].charCodeAt(0)-48)*t[i];if(e<=b.maxRowCount)return n.ij=e-1,n.li=d,n.gj=!0,n}else if(f.ei(g)){for(n.hj=!1;d<p&&f.ei(g);)d++,d<p&&(g=a[d]);if(j=d-c,j>3)return n;if(H(d,a,p))return n;for(e=0,k=d-1,l=k;l>=c;l--){if(m=a[l].charCodeAt(0),!(m>=65&&m<=90||m>=97&&m<=122))return n;e+=((32|m)-96)*o[k-l]}if(e<=b.maxColumnCount)return n.ij=e-1,n.li=d,n.gj=!0,n}return n}function J(a,c,d,e){var g,i,j,k,l,m=h.BAND_INDEX_CONST,n={li:e,ij:m,hj:!0,jj:!1,gj:!1},o=a.length;if(e>=o)return n;if(g=e,i=a[g],"R"===i||"r"===i)n.hj=!0,j=c;else{if("C"!==i&&"c"!==i)return n;n.hj=!1,j=d}if(e++,g++,e>=o)return n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n;if(i=a[g],"["===i&&(e++,g++,n.jj=!0),e>=o)return n;if(k=!1,i=a[g],n.jj&&"-"===i&&(e++,g++,k=!0),e>=o)return n;if(i=a[g],!f.isNumber(i))return n.jj?n:(n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n);for(;g<o&&f.isNumber(i);)g++,g<o&&(i=a[g]);if(l=parseInt(a.slice(e,g).join(""),10),n.jj){if(g>=o||"]"!==a[g])return n;g++}return l<(n.hj?b.maxRowCount:b.maxColumnCount)?(n.jj?(l=k?-l:l,n.ij=l+j):n.ij=l-1,n.li=g,n.gj=!0,n):void 0}function K(a,b,c,d){var e,g=a.row||0,h=a.column||0;if(c.source===f.BangSource)d.push("!");else if(c.source&&(e=N(a,d,c.source,c.endSource),!e))return void d.push("#","R","E","F","!");8===c.type||5===c.type?d.push(""+c.value):c.value&&c._error?d.push(""+c.value):c.sf()?L(a.useR1C1,g,h,c.row,c.column,c.rowRelative,c.columnRelative,d):M(a.source,a.useR1C1,g,h,c.row,c.column,c.endRow,c.endColumn,c.rowRelative,c.columnRelative,c.endRowRelative,c.endColumnRelative,d,c.tf())}function L(a,c,d,e,g,h,i,j,k){var l,m;if(k=k||0,l=b.maxRowCount-1,(0===k||1===k)&&e>-l&&e<=2*l&&(e+=h?c:0,e=C(e,l)),m=b.maxColumnCount-1,(0===k||2===k)&&g>-m&&g<=2*m&&(g+=i?d:0,g=C(g,m)),!E(c,d,e,g,h,i,k))return void j.push(""+f.Errors.Reference);if(a){if(j.push("R"),e>=0&&(c!==e||!h)&&(h?j.push("["+(e-c)+"]"):(e++,j.push(e+""))),g<0)return;j.push("C"),d===g&&i||(i?j.push("["+(g-d)+"]"):(g++,j.push(g+"")))}else{if(g>=0&&(i||j.push("$"),j.push.apply(j,B(g))),e<0)return;e++,h||j.push("$"),j.push(e+"")}}function M(a,c,d,e,f,g,i,j,k,l,m,n,o,p){p=p||0,3===p&&(f=0,i=a?a.getRowCount():b.maxRowCount-1,p=1),L(c,d,e,f,g,k,l,o,p);var q=h.BAND_INDEX_CONST;(!c||f!==i||g!==j||i!==q&&j!==q)&&(i===q&&j===q||(o.push(":"),L(c,d,e,i,j,m,n,o,p)))}function N(a,b,c,d){if(a.getExternalSourceToken){if(c!==f.BangSource){var e=O(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(e.length>0))return!1;b.push.apply(b,e)}return b.push("!"),!0}return!1}function O(a,b,c){if(!b||0===b.length||P(a,b)||P(a,c))return[];var d=b,e;if(S(b,!1)||c&&S(c,!1)){for(d=["'"],e=0;e<b.length;e++)"'"===b[e]&&d.push("'"),d.push(b[e]);if(c)for(d.push(":"),e=0;e<c.length;e++)"'"===c[e]&&d.push("'"),d.push(c[e]);d.push("'")}else if(c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function P(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}function Q(a,b){var c,d,e;if(!a||0===a.length)return!0;if(!b){if(f.isNumber(a[0]))return!1;if(c=T(a),c.gj&&c.li<=a.length)return!1}for(e=0;e<a.length;e++)if(d=a[e],b){if("*"===d||":"===d||"["===d||"]"===d||"?"===d||"\\"===d||"/"===d)return!1}else if(" "===d||"'"===d||"["===d||"]"===d||"?"===d||"\\"===d||"%"===d||'"'===d||"("===d||")"===d||"|"===d||"{"===d||"}"===d||"#"===d||"@"===d||"!"===d||"$"===d||"^"===d||"\uff08"===d||"\uff09"===d||f.operaterTypesMap[d])return!1;return!0}b.jma=Q;function R(a,b){var c,d;if(!a||0===a.length)return!0;for(d=0;d<a.length;d++)if(c=a[d],b){if("*"===c||":"===c||"["===c||"]"===c||"?"===c)return!1;if("'"===c&&(0===d||d>=a.length-1||"'"!==a[d+1]))return!1}else if("'"===c||"["===c||"]"===c||"?"===c||"%"===c||f.operaterTypesMap[c])return!1;return!0}function S(a,b){var c,d,e;return!!f.isDigit(+a[0])||(c=[],d=a,"["===a[0]&&(e=a.lastIndexOf("]"),e>0&&(c=a.slice(1,e),d=a.slice(e+1))),!R(c)||!Q(d,b))}function T(a){var b=F(a,!1,0,0);return b.gj||(b=F(a,!0,0,0)),b}function U(a){var b=new f.Expression(8);return b.value=a,b}function V(a){var b=a;return a&&a.length>=3&&"["===a[0]&&"0"===a[1]&&"]"===a[2]&&(b=3===a.length?"":a.substring(3)),b}u=function(a){A(b,a);function b(b){var c=a.call(this,8e3)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,b,c,d){var e,g,j,k,l,m,n,o,p,r,s,t,u,v,w=a.useR1C1,x=a.row||0,y=a.column||0,z=c.length,A=c[d],B=A.ni,C=A.Nc,E=A.hi;if(0!==C&&6!==E)return!1;if(0===C&&0===E&&d<z-2&&":"===c[d+1].ni&&12===c[d+2].hi&&c[d+2].ni.indexOf(":")<0||0===C&&12===E){if(l=void 0,m=void 0,B&&(B.indexOf(":")>0?(n=B.indexOf(":"),l=B.substring(1,n-1),m=B.substring(n+1,B.length-2)):(l=B,"'"===l.charAt(0)&&(l=l.substring(1,l.length-1)),0===E&&(m=c[d+2].ni,"'"===m.charAt(0)&&(m=m.substring(1,m.length-1))))),d++,k=!!l,l=V(l),l&&(g=B?a.getExternalSource("",l):f.BangSource,g=g||D(l),m=V(m),m&&(j=a.getExternalSource("",m),j=j||D(m),d+=2)),A=c[d],!A)return U(B);B=A.ni}if(o=d===z-1?q:c[d+1],W(c,A,d,w,!0)){if(p=F(A.Qb,w,x,y),!p.gj&&!k)return!1;if(A.hi=7,p.gj&&p.Vka){if(r=p.cj,s=p.dj,t=p.ej,u=p.fj,d<z-2&&5===o.Nc&&":"===o.ni&&(o=c[d+2],W(c,o,d+2,w,!1)&&(v=F(o.Qb,w,x,y),v.gj&&r===h.BAND_INDEX_CONST==(v.cj===h.BAND_INDEX_CONST)&&s===h.BAND_INDEX_CONST==(v.dj===h.BAND_INDEX_CONST))))return x=r===h.BAND_INDEX_CONST?0:x,y=s===h.BAND_INDEX_CONST?0:y,{index:d+3,expr:i.uf(g,j,r-(t?x:0),s-(u?y:0),v.cj-(v.ej?x:0),v.dj-(v.fj?y:0),t,u,v.ej,v.fj,x,y)};if(r===h.BAND_INDEX_CONST||s===h.BAND_INDEX_CONST){if(w)return r-=r!==h.BAND_INDEX_CONST&&t?x:0,s-=s!==h.BAND_INDEX_CONST&&u?y:0,{index:d+3,expr:i.uf(g,j,r,s,r,s,t,u,t,u,x,y)};if(!g)return!1;e=U(B)}if(!e)return{index:d+1,expr:i.rf(g,j,r-(t?x:0),s-(u?y:0),t,u)}}else e=U(B)}else if(6===A.hi)e=new f.Expression(5),e.value=f.CalcError.parse(A.ni);else{if(!g)return!1;e=U(B)}return g&&(e.source=g),j&&(e.endSource=j),{index:d+1,expr:e}},b.prototype.unparse=function(a,b,c,d){return!(!c||1!==c.type&&8!==c.type&&5!==c.type)&&(K(a,b,c,d),!0)},b}(f.TokenResolver),b.SheetReferenceResolver=u;function W(a,b,c,d,e){return 0===b.Nc&&0===b.hi||!d&&0===b.Nc&&4===b.hi&&(!e||c<a.length-2&&":"===a[c+1].ni&&0===a[c+2].Nc&&4===a[c+2].hi)}!function(a){a[a.ThisRow=1]="ThisRow",a[a.Headers=2]="Headers",a[a.Data=3]="Data",a[a.Totals=8]="Totals",a[a.HeadersAndData=6]="HeadersAndData",a[a.DataAndTotals=12]="DataAndTotals",a[a.All=14]="All",a[a.NotSpecific=16]="NotSpecific"}(v=b.StructReferencePortions||(b.StructReferencePortions={})),function(a){a[a.All=1]="All",a[a.NotSpecific=1]="NotSpecific",a[a.SingleColumn=2]="SingleColumn",a[a.ColumnRange=4]="ColumnRange"}(w=b.StructReferenceColumnSpecifier||(b.StructReferenceColumnSpecifier={}));function X(a,b,c,d,e){return b<=a.startRow()&&c<=a.startColumn()&&b+d>a.endRow()&&c+e>a.endColumn()}x=function(a){A(b,a);function b(){return a.call(this,13)||this}return b.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(b.prototype,"baseTable",{get:function(){return this.lj},set:function(a){this.lj=a,this.source=a.source()},enumerable:!0,configurable:!0}),b.prototype.JUa=function(){this.vzb=this.lj.startColumn()},b.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},b.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},b.prototype.referencePortions=function(){return this.qj},b.prototype.referenceColumnSpecifier=function(){return this.rj},b.prototype.getRange=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p=this,r=p.lj;switch(p.JUa(),k=r.startRow(),l=r.endRow(),m=r.hasTotalsRow(),n=r.hasHeadersRow(),p.qj){case 3:case 16:d=n?k+1:k,f=m?l-1:l;break;case 2:if(n)d=k,f=k;else{if(!c)return q;d=k-1,f=k-1}break;case 8:if(m)d=l,f=l;else{if(!c)return q;d=l+1,f=l+1}break;case 1:d=a,f=a;break;case 6:d=k+(c&&!n?-1:0),f=m?l-1:l;break;case 12:d=n?k+1:k,f=l+(c&&!m?1:0);break;case 14:default:d=k+(c&&!n?-1:0),f=l+(c&&!m?1:0)}return e=p.columnReferenceStart(),g=p.columnReferenceEnd(),o=r.endColumn(),1===p.rj&&(g=o),e>o||g>o?(p._error=!0,q):f<d||!c&&d<k||!c&&f>l?q:(i=f-d+1,j=g-e+1,h.qf(d,e,i,j))},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d){var e,g,h=this,i=h.vzb;return a<i||a===i&&d||a>h.pj+i?h:(c=d?c:-c,e=a-i,g=new b,g.baseTable=h.lj,g.pj=h.pj+c,g.oj=h.oj,a<=i+h.oj&&(g.oj+=c,g.oj<e&&(g.oj=e)),g.rj=h.rj,g.qj=h.qj,g.pj<g.oj?f.Ih:g)},b.prototype.offsetWhenCopy=function(a,b,c,d,e,f,i,j,k,l){var m,n,o,p,q,r,s=this,t=new g.SheetParserContext(b.kj,b.Af.useR1C1,h.pf(c,d)),u=t.getTableByIndex(c,d),v=s.offset();return u&&(m=c-e,n=d-f,o=i-e,p=j-f,q=void 0,a===b?q=t.getTableByIndex(m,n):(r=new g.SheetParserContext(a.kj,a.Af.useR1C1,h.pf(m,n)),q=r.getTableByIndex(m,n)),q!==u&&q===s.lj&&X(q,o,p,k,l)&&X(u,i,j,k,l)&&(v.baseTable=u)),v},b.prototype.Jma=function(a){var c,d=this,e=new b;return e.baseTable=d.lj,e.pj=d.pj,e.oj=d.oj,2===d.rj&&a&&(c=d.lj.endColumn()-d.lj.startColumn()+1,a%=c,e.oj+=a,e.oj<0&&(e.oj+=c),e.pj=e.oj),e.rj=d.rj,e.qj=d.qj,e},b.prototype.offset=function(a,c,d){var e=this,f=new b;return f.baseTable=e.baseTable,f.qj=e.qj,f.oj=e.oj,f.pj=e.pj,f.rj=e.rj,f},b.prototype.Kma=function(a,b){var c=this.lj;return a>=c.startRow()&&b>=c.startColumn()&&a<=c.endRow()&&b<=c.endColumn()},b.prototype.tzb=function(a,b,c){this.lj.wzb(a,b,c)},b}(f.Expression),b.xzb=x,y=function(a){A(b,a);function b(b){var c=a.call(this,7900)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,c,d,e){var f,g,h,i=d[e];if(0===i.Nc&&0===i.hi)if(f=i.ni,"]"===f.charAt(f.length-1))try{return g=new x,Y(a,f.split(""),g),g}catch(a){}else if(h=a.getTableByName&&a.getTableByName(f))return b.create(h);return q},b.prototype.unparse=function(a,b,c,d){var e,f,g,h,j,k,l,m,n;return 13===c.type&&(e=c,a.YSa?(f=e.getRange(a.row,a.column,!0),g=i.uf(e.source,q,f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1,!1,!1,!1,!1),K(a,b,g,d),!0):16===e.qj&&1===e.rj?(d.push(e.lj.tableName()),void(a.Eh&&d.push("[]"))):(j=d.length,k=a.source===e.lj.source()&&e.Kma(a.row,a.column),k&&!a.Eh||d.push(e.lj.tableName()),d.push("["),16!==e.qj&&(l=ka(e.qj,1!==e.rj,a.Eh),d.push(l)),1!==e.rj&&(1===e.qj&&!a.Eh||16===e.qj||d.push(", "),m=e.lj.getColumnName(e.oj),m?m=da(m.split("")).join(""):h=!0,h||(4===e.rj?(n=e.lj.getColumnName(e.pj),n?(n=da(n.split("")).join(""),d.push("[",m,"]:[",n,"]")):h=!0):1===e.qj&&!a.Eh&&!ea(m)||16===e.qj?d.push(m):d.push("[",m,"]"))),h?(d.length=j,d.push("#REF!")):d.push("]"),!0))},b.create=function(a,b,c,d,e){void 0===b&&(b=v.NotSpecific),void 0===c&&(c=w.NotSpecific),void 0===d&&(d=0),void 0===e&&(e=a.endColumn()-a.startColumn());var f=new x;return f.baseTable=a,f.qj=b,f.oj=d,f.pj=e,f.rj=c,f},b}(f.TokenResolver),b.StructureReferenceResolver=y;function Y(a,b,c){var d,e,f,g,h,i,j,k,l,m=c,n=0,o=b[n],p=ia(a,b,n,o),q=p.sj;for(q||ja(),m.baseTable=q,n=p.tj,n++,o=b[n],d=n;" "===o;)n++,o=b[n];for("@"!==o&&"["!==o&&(n=d,o=b[n]),e=1,f=!1,g=!1,h=b.length;0!==e&&n<h;)if("["===o&&(e++,n++,o=b[n]),"#"===o)f&&e<=1&&ja(),i=ha(b,n,o,e),j=i.vj,n=i.tj,o=i.uj,e=i.wj,f?2===m.qj&&3===j||2===j&&3===m.qj?m.qj=6:3===m.qj&&8===j||3===j&&8===m.qj?m.qj=12:ja():m.qj=j,f=!0;else if("@"===o){for((e>1||f)&&ja(),f=!0,m.qj=1,n++,o=b[n];" "===o;)n++,o=b[n];","===o&&ja()}else{for(k=n;"]"!==o&&"["!==o;)if("'"===o&&n++,","===o){for(n++,o=b[n],l=n;" "===o;)n++,o=b[n];if("["===o){n=l,o=",";break}}else n++,o=b[n];if(n>k&&((g||"["===o&&e>1)&&ja(),i=$(m,b,n,o,e,k),n=i.tj,o=i.uj,e=i.wj,g=!0),"]"===o){if(e--,0===e)break;n>=b.length&&ja(),n++,o=b[n]}","===o&&(n++,o=b[n])}f||(m.qj=16),g||(m.oj=0,m.pj=m.lj.endColumn()-m.lj.startColumn(),m.rj=1)}function Z(a,b,c){return a.slice(b,c).join("")}function $(a,b,c,d,e,f){var g,h,i,j,k,l,m=a,n=[],o="",q=!1,r=!1;if(e>1)q=!0,e--,n=b.slice(f,c),c++,d=b[c],":"===d&&(c++,d=b[c],r="["===d,h=fa(b,c,d,e),o=h.xj,c=h.tj,d=h.uj,e=h.wj);else if("["===d){for(r=!0,g=c-1,d=b[g];" "===d;)g--,d=b[g];":"!==d&&ja(),n=b.slice(f,g),n=_(n),d=b[c],h=fa(b,c,d,e),o=h.xj,c=h.tj,d=h.uj,e=h.wj}else m.qj!==p&&16!==m.qj||(q=!0),i=b.slice(f,c),g=i.indexOf(":"),g>0?(n=i.slice(0,g),o=i.slice(g+1),"["!==o[0]&&ja()):n=i;if(j=ba(m,n,q),o?(k=ba(m,o,r),m.rj=4):(k=j,m.rj=2),j>k&&(l=j,j=k,k=l),m.oj=j,m.pj=k,c++,c<b.length)for(d=b[c];" "===d;)c++,d=b[c];return{tj:c,uj:d,wj:e}}function _(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.slice(b+1,a.length-b-1):a}function aa(a){for(var b=0,c=a.length,d=0;b<c&&" "===a[b];)b++;for(d=b,b=c-1;b>d&&" "===a[b];)b++;return b>=d?a.slice(d,b+1):a}function ba(a,b,c){var d,e,f,g;if(b&&ca(b,c)){for(d=[],e=0,f=b.length;e<f;e++)"'"===b[e]&&e<f-1&&"'"!==b[e+1]||d.push(b[e]);return b=d,g=a.lj.getColumnIndexInTable(b.join("")),g<0&&ja(),g}return-1}function ca(a,b){var c,d,e;if(b)return!0;if(c="",c=a[0],d=c,"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!1;for(e=1;e<a.length;e++){if(c=a[e]," "===c||","===c||":"===c||"["===c&&"'"!==d||"]"===c&&"'"!==d||"@"===c&&"'"!==d||"#"===c&&"'"!==d)return!1;d=c}return!0}function da(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],"["!==b&&"]"!==b&&"@"!==b&&"#"!==b&&"'"!==b||d.push("'"),d.push(b);return d}function ea(a){var b,c="";if(c=a[0],"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!0;for(b=1;b<a.length;b++)if(c=a[b]," "===c||","===c||":"===c||"["===c||"]"===c||"@"===c||"#"===c)return!0;return!1}function fa(a,b,c,d){var e,f,g=!1;if("["===c)for(g=!0,d++,b++,c=a[b];" "===c;)b++,c=a[b];for(e=b;"]"!==c&&(","!==c||d>1);)"'"===c&&b++,b++,c=a[b];return b<=e&&ja(),f=a.slice(e,b),d>1&&d--,g||(f=aa(f)),{xj:f,tj:b,uj:c,wj:d}}z={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function ga(a){var b,c=f.getMapping()&&f.getMapping().tableFunctionsMapping;if(!j.isNullOrUndefined(c))for(b in c)if(c[b].toLowerCase()===a)return b.toLowerCase();return a}function ha(a,b,c,d){for(var e,f,g,h,i=14,j=b;"]"!==c;)"'"===c&&b++,b++,c=a[b];for(e=Z(a,j,b).toLowerCase().trim(),e=ga(e),f=!1,g=0;g<r.length;g++)if(h=r[g],e===h){i=z[e],f=!0;break}if(f||ja(),b++,b>=a.length)d--;else{for(c=a[b];" "===c;)b++,c=a[b];if(","===c){for(d<=1&&ja(),b++,c=a[b];" "===c;)b++,c=a[b];for("["===c&&(d++,b++,c=a[b]);" "===c;)b++,c=a[b]}d>1&&d--}return{vj:i,tj:b,uj:c,wj:d}}function ia(a,b,c,d){for(var e,f,g=0,h=b.length;"["!==d&&c<h;)c++,d=b[c];return g=c,g>0?(f=Z(b,0,g),e=a.getTableByName(f)):e=a.getTableByIndex(a.row,a.column),{sj:e,tj:c,uj:d}}function ja(){throw m().Exp_FormulaInvalid}function ka(a,b,c){var d=f.getMapping()&&f.getMapping().tableFunctionsMapping,e=f.sR().B2,g=d?d["#All"]:e.All.name,h=d?d["#This row"]:e.thisRow.name,i=d?d["#Headers"]:e.Headers.name,j=d?d["#Data"]:e.Data.name,k=d?d["#Totals"]:e.Totals.name;switch(a){case 1:return c?"["+h+"]":"@";case 2:return b?"["+i+"]":i;case 3:return b?"["+j+"]":j;case 8:return b?"["+k+"]":k;case 6:return"["+i+"], ["+j+"]";case 12:return"["+j+"], ["+k+"]";case 14:case 16:}return b?"["+g+"]":g}function la(a,b){var c,d,e,g,h,i,j,k,l,m,n=0;for(a.unshift(new f.FormulaToken("=",1,0,0,0)),g=[],h=0,e=a.length-1;e>0;e--)a[e].mi===a[e-1].mi&&a[e].ni===a[e-1].ni||(g[h]=a[e],h++);for(g[h]=a[e],g.reverse(),i=[],j=0,k=0;k<g.length-1;k++,j++)d=ma(g[k]),i[j]=g[k],n=g[k+1].mi-g[k].mi-d,n>0&&(c=new f.FormulaToken(b.slice(g[k].mi+d,g[k+1].mi),7,g[k].mi+d),++j,i[j]=c);for(i[j]=g[k],d=ma(i[j]),i.length>0&&b.length>i[j].mi+d&&(c=new f.FormulaToken(b.slice(i[j].mi+d,b.length),7,i[j].mi+d),i[j+1]=c),l=0;l<i.length;l++)m=i[l].ni.trim(),3===i[l].hi?i[l].ni='"'+i[l].ni+'"':"("===m||"{"===m?(i[l].Nc=1,i[l].hi=1):")"!==m&&"}"!==m||(i[l].Nc=1,i[l].hi=2);return i}function ma(a){return 1===a.Nc&&"ARRAY"===a.ni?1:0===a.Nc&&3===a.hi?(a.HTa||a.ni).length+2:0===a.Nc&&12===a.hi?a.ni.length+3:a.ni.length}function na(a,b,c){var d,e;a&&b&&(d=b.getName&&b.getName()||"!",e=a[d],e||(e=a[d]=[],a.sheets||(a.sheets=[]),a.sheets.push(d)),e.push(c))}function oa(a,b,c,d,e,g){var i,j,k,l;if(a){for(;10===a.type;)a=a.value;if(12===a.type&&(j=a,a=j.value),a.type>=2&&a.type<=6);else if(1===a.type)i=a.getRange(e,g),!d.source||a.source&&a.source!==d.source||b.push(i),na(c,a.source||d.source,i);else if(13===a.type)i=a.getRange(e,g),a.source===d.source&&i&&b.push(i),na(c,a.source||d.source,i);else if(8===a.type)k=q,a.source?a.source.Cf()&&(k=new f.EvaluateContext(a.source,h.pf(e,g))):k=d,oa(k.getName(a.value),b,c,k,e,g);else if(9===a.type)oa(a.value,b,c,d,e,g),a.value2&&oa(a.value2,b,c,d,e,g);else if(7===a.type)for(l=0;l<a.arguments.length;l++)oa(a.arguments[l],b,c,d,e,g)}}function pa(a,b,c,d,e,f,g){var i,j,k,l,m;
a.setParserOption(f),i=[],j=b.split(""),k={newCharArray:null};try{l=c.yj().getParserContext(!g&&c.Cf().useR1C1,h.pf(d,e),q),i=a.parseToTokens(l,j,!1,k)}catch(a){}return m=k.newCharArray||j,i=la(i,m),qa(a,i,m,c,d,e,g)}b.qzb=pa;function qa(a,b,c,d,e,i,j){var k,l,m,n,o,r,s,t,u,v,w,x,y,z,A,B,C,D=p,E=d.yj(),F=d.Cf();for(F?(k=new g.SheetParserContext(d,!j&&F.useR1C1,h.pf(e,i)),D=new f.EvaluateContext(E,h.pf(e,i),(!1))):k=new f.ParserContext(q,(!1),h.pf(0,0)),k.ignoreError=!0,l=[],n=0;n<b.length;n++)try{if(m=b[n],"["===m.ni||"#"===m.Qb[0]||3===m.hi){l.push({text:m.HTa||m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni});continue}if(o=[],n=ra(a,k,b,n,o),r=void 0,o.length>0){for(s=0;s<o.length;s++)if(t=o[s],t instanceof f.FormulaToken)l.push({text:c.slice(t.mi,t.li+1).join(""),type:t.Nc,subType:t.hi,canDrag:r,ranges:[],value:t.ni});else if(t.Lf){if(u=t.Lf,v=c.slice(t.mi,t.li+1).join(""),w=[],x={},r=!0,y=u.getRange&&u.getRange(e,i),8===u.type)r=!1,D&&(z=D.getName(u.value),oa(z,w,x,D,e,i));else if(13===u.type)r=!1,u.source===E&&y?w.push(y):w=null,na(x,u.source,y);else if(1===u.type)if(u.endSource)for(A=u.source,B=u.endSource,C=A.getSources(B),s=0;s<C.length;s++){if(C[s]===E){w.push(y);break}na(x,C[s],y)}else na(x,u.source||E,y),u.source&&u.source!==E||w.push(y);else w=null;w&&w.length>0?l.push({text:v,type:0,subType:7,canDrag:r,ranges:w,value:v,sheetRanges:x}):l.push({text:v,type:m.Nc,subType:m.hi,canDrag:r,ranges:w,value:v,sheetRanges:x})}}else l.push({text:m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni})}catch(a){l.push({text:m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni})}return l}function ra(a,b,c,d,e){var f,g,h,i,j,k=c[d];return k&&"function"!=typeof k&&0===k.Nc?(f=[],g=a.resolveToken(b,c,f,d)-1,h=f[0],1===h.type||13===h.type||8===h.type||5===h.type&&h.source?(i=c[g],j={mi:k.mi,li:i.li,Lf:h},e.push(j),g):d):d}},"./dist/plugins/sheetsCalc/referenceExpression.js":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./dist/plugins/sheetsCalc/calc.ns.js"),f=void 0,g=Math.abs,h=function(a){i(b,a);function b(b){return a.call(this,b)||this}return b.prototype.sf=function(){var a=this;return a.endRow===f||a.endColumn===f},b.prototype.tf=function(){var a=this;return a.isFullRow&&a.isFullColumn?3:a.isFullRow?1:a.isFullColumn?2:0},b.prototype.getRange=function(a,b){return j(this,a,b)},b.prototype.offset=function(a,b,c,d,e){var f,g=this,h=g.source,i=g.endSource;return g.sf()?k(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.rowRelative,g.columnRelative):(f=l(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.endRow+(g.isFullColumn||!g.endRowRelative&&!c?0:a),g.endColumn+(g.isFullRow||!g.endColumnRelative&&!c?0:b),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,d,e),f.isFullRow=g.isFullRow,f.isFullColumn=g.isFullColumn,f)},b.prototype.offset2=function(a,b,c,d,e,f){var g=this,h=l(g.source,g.endSource,g.row+(g.isFullColumn?0:a),g.column+(g.isFullRow?0:b),g.endRow+(g.isFullColumn?0:c),g.endColumn+(g.isFullRow?0:d),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,e,f);return h.isFullRow=g.isFullRow,h.isFullColumn=g.isFullColumn,h},b}(d.Expression),b.ReferenceExpression=h;function j(a,b,c){var d={row:-1,col:-1,rowCount:-1,colCount:-1},f,h,i,j;return a.isFullRow?(d.col=-1,d.colCount=-1):(a.columnRelative?(i=a.column+c,i=i>=e.MAX_COLUMN_COUNT?i%e.MAX_COLUMN_COUNT:i):i=a.column,a.sf()?(d.col=i,d.colCount=1):(a.endColumnRelative?(j=a.endColumn+c,j=j>=e.MAX_COLUMN_COUNT?j%e.MAX_COLUMN_COUNT:j):j=a.endColumn,d.col=i<=j?i:j,d.colCount=g(j-i)+1)),a.isFullColumn?(d.row=-1,d.rowCount=-1):(a.rowRelative?(f=a.row+b,f=f>=e.MAX_ROW_COUNT?f%e.MAX_ROW_COUNT:f):f=a.row,a.sf()?(d.row=f,d.rowCount=1):(a.endRowRelative?(h=a.endRow+b,h=h>=e.MAX_ROW_COUNT?h%e.MAX_ROW_COUNT:h):h=a.endRow,d.row=f<=h?f:h,d.rowCount=g(h-f)+1)),d}b.getRangeForReference=j;function k(a,b,c,d,e,f){var g=new h(1);return g.row=c,g.column=d,g.rowRelative=e,g.columnRelative=f,a&&(g.source=a),b&&(g.endSource=b),g}b.rf=k;function l(a,b,c,d,f,g,i,j,k,l,m,n){var o,p,q,r,s,t=new h(1);return t.isFullRow=d===e.BAND_INDEX_CONST,m=m||0,n=n||0,p=c-(i?0:m),q=d-(j?0:n),r=f-(k?0:m),s=g-(l?0:n),t.isFullRow&&0===c&&f===e.MAX_ROW_COUNT-1&&(c=f=e.BAND_INDEX_CONST),t.isFullColumn=c===e.BAND_INDEX_CONST,p>r&&(o=c,c=f,f=o,o=i,i=k,k=o),q>s&&(o=d,d=g,g=o,o=j,j=l,l=o),t.row=c,t.column=d,t.endRow=f,t.endColumn=g,t.rowRelative=i,t.columnRelative=j,t.endRowRelative=k,t.endColumnRelative=l,a&&(t.source=a),b&&(t.endSource=b),t}b.uf=l},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/sheetsCalc/calc.ns.js")),d(c("./dist/plugins/sheetsCalc/referenceExpression.js")),d(c("./dist/plugins/sheetsCalc/parser-sheets.js")),d(c("./dist/plugins/sheetsCalc/calc-spreadjs.js")),d(c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),d(c("./dist/plugins/sheetsCalc/worksheet-formula.js")),c("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=h.SpreadSource,k=f.Common.u.Nb,l=new f.Common.ResourceManager(d.SR),m=l.getResource.bind(l),n=void 0,o=null,p=d.Workbook.prototype,p.qv=function(a){var b=this,c=b.Wu;b.Wu=new g.CalcService,a&&c&&b.Wu.cloneFrom(c),b.yv=new j(b),b.zv=b.Wu.getGlobalSourceModel(b.yv)},p.addCustomFunction=function(a){this.Xu(a)},p.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(m().Exp_InvalidCustomFunction);this.Su[k(a.name)]=a},p.getCustomFunction=function(a){return a?this.Su[k(a)]:n},p.removeCustomFunction=function(a){a&&(delete this.Su[k(a)],this.iK())},p.clearCustomFunctions=function(){this.Su={}},p.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},p.H$a=function(a){return!this.Tu[k(a)]},p.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},p.Yu=function(a,b,c,d,e,f){var g,h,j,l,n=this;if(!a||!b||!e&&!n.isValidCustomName(a))throw Error(m().Exp_InvalidCustomName);if(n.Wu){if(g=this.getActiveSheet(),h=g?g.yj():o,j=void 0,e)try{j=n.Wu.parse(h,b,c,d,!1,!1,!0)}catch(a){}else j=n.Wu.parse(h,b,c,d);n.Tu[k(a)]=new i.NameInfo(a,j,c,d,f),e||(l={},l[a]=a,this.Zu(l,!0))}},p.getCustomName=function(a){return a?this.Tu[k(a)]:n},p.getCustomNames=function(){var a=[];return d.GC$.each(this.Tu,function(b,c){a.push(c)}),a},p.removeCustomName=function(a){if(a){delete this.Tu[k(a)];var b={};b[a]=a,this.Zu(b,!1)}},p.clearCustomNames=function(){var a=this.Tu;this.Tu={},this.Zu(a,!1)},p.Zu=function(a,b){var c,d;if(a){c=this.zv;for(d in a)c&&c.updateNameCalc(d,b);this.iK()}},p.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var a=this.getActiveSheet();a&&(a.suspendPaint(),this.Wu.recalculateAll(),a.resumePaint())}},p.getCalcService=function(){return this.Wu},p.Cf=function(){return this.Wu},p.suspendCalcService=function(a){this.Wu&&this.Wu.suspend(a)},p.resumeCalcService=function(a){this.Wu&&this.Wu.resume(a)},d.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={}},toJson:function(a){var b,c,e,f=this,g=f.Su;d.GC$.isEmptyObject(g)||(a.customFunctions=g),b=[],c=f.getCustomNames(),e=f.Wu,c&&e&&(d.GC$.each(c,function(a,c){var d,f,g=c.getName(),h=c.getRow(),i=c.getColumn(),j=c.getExpression(),k=c.getComment();j&&(d=e.unparse(null,j,h,i,!1,!0),f={name:g,formula:d,row:h,col:i},k&&(f.comment=k),b.push(f))}),b.length>0&&(a.names=b))},fromJson:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.Wu;if(t&&t.suspend(),s.clearCustomNames(),d=a.names)for(f=0;f<d.length;f++)g=d[f],s.Yu(g.name,g.formula,g.row,g.col,!0,g.comment);if(s.clearCustomFunctions(),h=a.customFunctions)for(i in h)h.hasOwnProperty(i)&&(j=h[i],k=e.getTypeFromString(j.typeName),k&&(l=new k,l.fromJSON(j,b),s.Xu(l)));if(o=a.sheets,p=[],o){m=0;for(q in o)"string"==typeof q&&(r=o[q],n=s.getSheetFromName(r.name||q),p.push(n),n.nameFunctionsFromJSON(r,b,c),m++);for(m=0;m<p.length;m++)p[m].formulaFromJSON(o[p[m].name()],b,c)}t&&(a.noRecalc||c&&c.doNotRecalculateAfterLoad?t.resumeWithoutCalc():t.resume(!0))}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/referenceExpression.js"),j=c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),k=null,l=void 0,m=d.GC$.each,n=f.Common.u.Nb,o=new f.Common.ResourceManager(d.SR),p=o.getResource.bind(o),q=f.Common.j.Fa,r=parseInt;function t(a){return a.columnRelative}function u(a){return a.endColumnRelative}function v(a){return a.rowRelative}function w(a){return a.endRowRelative}function x(a){return a.Cf()}function y(a){return a.column}function z(){var a=this;return a.Ru?void(a.Ru=!1):(a.Su={},a.Tu={},void(a.et?a.et.clearAll():a.ft=new h.SheetSource(a)))}function A(a,b,c,d,e){var f=a.Ms(b,c,d,e),g=f&&f.formulas;return g&&g.length>0}s=d.Worksheet.prototype,s.resetCalc=function(){z.call(this),this.Ru=!0},s.recalcAll=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=x(this);if(q){if(this.suspendPaint(),q.suspend(!0),a)for(b=this.parent,c=void 0,c=b&&b.sheets||[this],d=0;d<c.length;d++){if(e=c[d],f=e.Tu,g=e.yj(),f)for(h in f)i=f[h],j=i.Lf,k=q.unparse(g,j,0,0),i.Lf=q.parse(g,k,0,0);for(l=g.getCalcSourceModel(),m=l.getAllNodes(),n=0;n<m.length;n++)o=m[n],p=o.calc,p&&o.Lf&&D(q,p)}q.resume(!0),this.resumePaint()}},s.recalcRange=function(a,b,c,d){var e=x(this);e&&e.recalcRange(this.yj(),a,b,c,d)},s.recalcRows=function(a){var b,c=x(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,a[b],-1);c.resume(!1)}},s.zq=function(a,b){var c=x(this);c&&!c.ignoreDirty()&&c.recalculate(this.ft,a,b)},s.getCalcService=function(){return this.Wu||(this.Wu=new g.CalcService,this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},s.Cf=function(){return this.getCalcService()},s.suspendCalcService=function(a){var b=x(this);b&&b.suspend(a)},s.resumeCalcService=function(a){var b=x(this);b&&b.resume(a)},s.yj=function(a){return q(a)||3===a?this.ft:k},s.Bj=function(){var a=this;return!a.et&&a.ft&&(a.et=a.Cf().getSourceModel(a.ft)),a.et},s.Ns=function(a,b,c,d){return this.Bj()&&this.Bj().tg(a,b,c,d,!0,!0)},s.Ms=function(a,b,c,d){return this.Bj()&&this.Bj().tg(a,b,c,d,!1,!0)},s.Vq=function(a,b,c,d,e){return void 0===e&&(e=!0),!(e&&this.Ns(a,b,c,d)||!e&&A(this,a,b,c,d))||(this.Os(4,p().Exp_ChangePartOfArray),!1)},s.addCustomFunction=function(a){this.Xu(a),this.recalcAll()},s.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(p().Exp_InvalidCustomFunction);this.Su[n(a.name)]=a},s.getCustomFunction=function(a){return a?this.Su[n(a)]:k},s.removeCustomFunction=function(a){a&&(delete this.Su[n(a)],this.recalcAll())},s.clearCustomFunctions=function(){this.Su={},this.recalcAll()},s.Pu=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomFunction(a),!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d):k},s.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},s.getCustomName=function(a){return a?this.Tu[n(a)]:l},s.getCustomNames=function(){var a=[];return m(this.Tu,function(b,c){a.push(c)}),a},s.removeCustomName=function(a){var b,c;a&&(b=n(a),delete this.Tu[b],c={},c[b]=b,this.Zu(c,!1))},s.clearCustomNames=function(){var a=this,b=a.Tu;a.Tu={},this.Zu(b,!1)},s.createNameInfo=function(a,b,c,d,e){var f,g=this,i=x(g),j=g.yj();return i&&j?(f=i.parse(j,b,d,e),new h.NameInfo(a,f,d,e,c)):k},s.H$a=function(a){var b,c=this,d=!c.Tu[n(a)];return d&&(b=c.tables,b&&(d=!b.findByName(a))),d},s.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},s.Yu=function(a,b,c,d,e,f){var g,i,j,k,l=this;if(!a||!b||!e&&!l.isValidCustomName(a))throw Error(p().Exp_InvalidCustomName);if(g=x(l),i=l.yj(),g&&i){if(j=void 0,e)try{j=g.parse(i,b,c,d,!1,!1,!0)}catch(a){}else j=g.parse(i,b,c,d);l.Tu[n(a)]=new h.NameInfo(a,j,c,d,f),e||(k={},k[a]=a,this.Zu(k,!0))}},s.Zu=function(a,b){var c,d=this.Bj();if(d){for(c in a)d.updateNameCalc(c,b);this.recalcAll()}},s.$u=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomName(a),!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d):k},s.setFormula=function(a,b,c){this._u(a,b,c,k,!1)},s._u=function(a,b,c,d,e,f,g){var h,i,j,m,n,o,r,s,t=this;if(1!==f&&2!==f){if(q(f)&&(f=3),a<0||a>=t.getRowCount()||b<0||b>=t.getColumnCount())return void t.Os(0,p().Exp_IndexOutOfRange);h=a>=0?a:0,i=b>=0?b:0,d=d||(c&&t.Wu?t.Wu.parse(t.ft,c,h,i,!1,e,e):k),j=t.tables,3===f&&a>=0&&b>=0&&j&&!(m=j.Hma(a,b,1,1,c,d))||(n=t.Bj(),o=t.conditionalFormats,n&&(r=n.getFormula(a,b),s=t.ITa,n.setFormula(a,b,c,d,e,l,s.dUa()),o&&o.Nm(),g||t.Bq("formula",a,b,f,r,c)),t.t4&&t.t4(a,b,1,1,f),t.$p())}},s.setArrayFormula=function(a,b,c,d,e){this.bv(a,b,c,d,e,!1)},s.bv=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;if(void 0===g&&(g=3),h=this,1!==g&&2!==g){if(a<0||a+c>h.getRowCount()||b<0||b+d>h.getColumnCount())return void h.Os(0,p().Exp_IndexOutOfRange);if(h.ITa.MTa(a,b,c,d))return void h.Os(0,p().Exp_ArrayFromulaSpan);if(i=h.tables,!(3===g&&a>=0&&b>=0&&i)||(j=i.Hma(a,b,c,d,e))){if(k=h.Bj(),l=h.conditionalFormats,k&&(h.suspendEvent(),k.setArrayFormula(a,b,c,d,e,f,h.ITa.dUa()),h.resumeEvent(),l&&l.Nm(),h.jm<1)){for(m=[],n=a;n<a+c;n++)for(o=b;o<b+d;o++)m.push({row:n,col:o});h.Bu(a,b,c,d,m,5,g,e)}h.$p()}}},s.getFormula=function(a,b,c){var d=this.Bj();return d?d.getFormula(a,b,c):k},s.Ima=function(a,b){var c=this.Bj();return c?c.Kf(a,b):k},s.getFormulaInformation=function(a,b){var c,e,f={},g=this.Bj();return g&&(c=g.Kf(a,b),c&&(e=g.Qf(a,b),f.hasFormula=!0,e&&(f.baseRange=new d.Range(e.row,e.col,e.rowCount,e.colCount)),f.isArrayFormula=!!e,a=e?e.row:a,b=e?e.col:b,f.formula=this.Wu.unparse(this.ft,c,a,b),f.formulaWithCulture=this.Wu.unparse(this.ft,c,a,b,!0),f.hasFormula=!!f.formula)),f},s.hasFormula=function(a,b){var c=this.Bj();return!!c&&c.hasFormula(a,b)},s.dv=function(){var a,b,c,d,e,f=this.Bj();if(f)for(a=0,b=f.rC(),c=f.cC();a<b;){for(d=0;d<c;)e=f.qg(a,d),e&&(e.ng(),e.og()),d++;a++}},s.clearFormula=function(a,b,c,d,e){var f,g,h=this;for(a<0&&(a=0,c=h.getRowCount()),b<0&&(b=0,d=h.getColumnCount()),f=0;f<c;f++)if(e(h,f+a))for(g=0;g<d;g++)h.setFormula(f+a,g+b,k)},s.nameFunctionsFromJSON=function(a,b){var c,d,f,g,h,i,j,k,l,m,n=[];for(c=2;c<arguments.length;c++)n[c-2]=arguments[c];if(a){if(d=this,f=a.customFunctions)for(g in f)f.hasOwnProperty(g)&&(h=f[g],i=e.getTypeFromString(h.typeName),i&&(j=new i,j.fromJSON(h,b),d.Xu(j)));if(k=a.names){for(l=0;l<k.length;l++)m=k[l],d.Yu(m.name,m.formula,m.row,m.col,!0,m.comment);d.dv()}}},s.formulaFromJSON=function(a,b,c){var e,f,g,h,i,j,l,n,o,p,q,s,t;if(a){if(e=this,f=a.data,g=c&&c.ignoreFormula,f&&!g&&(h=f.dataTable))for(i=void 0,j=void 0,l=e.getRowCount(),n=e.getColumnCount(),o=0;o<l;o++)if(i=h[o])for(p=0;p<n;p++)j=i[p],q=j&&j.formula,q&&(s=j.arrayInfo,s?e.bv(o,p,r(s.rowCount,10),r(s.colCount,10),q,!0):e._u(o,p,q,k,!0,k,!0));t=d.Worksheet._n,t&&m(t,function(d,f){var g=f.fromJsonAfterFormula;g&&g.call(e,a,b,c)})}},s.ev=function(a){var b=this,c=b.Wu;c&&!a||(b.Wu=a?a:new g.CalcService,b.yj().setCalcService(b.Wu),b.Wu.initParserContext(b.yj()),c?a.setSourceModel(b.yj(),c.getSourceModel(b.ft)):b.et=b.Wu.getSourceModel(b.ft))},s.setCalc=function(a,b){this.Wu=a,this.ft=b||this.ft,this.et=a.getSourceModel(this.ft),this.parent&&(this.parent.Wu=a)},s.fv=function(){this.gv(!1,1)},s.mUa=function(a){var b,c,d,e,f,g=this,h=a.changeType,i=a.row,j=a.rowCount,k=a.col,l=a.colCount,m=g.Bj();m&&(b=g.ITa.dUa(),c=x(m),d=m.xf,e=c.ih(),f=c.lh.asyncManager,"addingRows"===h?g.Vq(i,0,0,g.getColumnCount())?(e.onBeforeAddRemoveRows(m,i),B(g,i,j,!0,!0),m.addRows(i,j),f.addRows(d,i,j)):a.canAdd=!1:"addRows"===h?(c.suspend(),e.onAfterAddRemoveRows(m,i,j,!0),c.resume(!1),b&&b.push({type:"addRows",row:i,rowCount:j})):"deletingRows"===h?g.Vq(i,0,j,g.getColumnCount())?(e.onBeforeAddRemoveRows(m,i),B(g,i,j,!1,!0),m.deleteRows(i,j),f.deleteRows(d,i,j)):a.canDelete=!1:"deleteRows"===h?(c.suspend(),e.onAfterAddRemoveRows(m,i,j,!1),c.resume(!1),b&&b.push({type:"deleteRows",row:i,rowCount:j})):"addingColumns"===h?g.Vq(0,k,g.getRowCount(),0)?(e.onBeforeAddRemoveColumns(m,k),B(g,k,l,!0,!1),m.addColumns(k,l),f.addColumns(d,i,j)):a.canAdd=!1:"addColumns"===h?(c.suspend(),e.onAfterAddRemoveColumns(m,k,l,!0),c.resume(!1),b&&b.push({type:"addColumns",col:k,colCount:l})):"deletingColumns"===h?g.Vq(0,k,g.getRowCount(),l)?(e.onBeforeAddRemoveColumns(m,k),B(g,k,l,!1,!1),m.deleteColumns(k,l),f.deleteColumns(d,i,j)):a.canDelete=!1:"deleteColumns"===h&&(c.suspend(),e.onAfterAddRemoveColumns(m,k,l,!1),c.resume(!1),b&&b.push({type:"deleteColumns",col:k,colCount:l})))},s.nUa=function(a,b,c){var d=c.type,e=this;"addRows"===d?(c.changeType="deletingRows",e.mUa(c),c.changeType="deleteRows",e.mUa(c)):"deleteRows"===d?(c.changeType="addingRows",e.mUa(c),c.changeType="addRows",e.mUa(c)):"addColumns"===d?(c.changeType="deletingColumns",e.mUa(c),c.changeType="deleteColumns",e.mUa(c)):"deleteColumns"===d?(c.changeType="addingColumns",e.mUa(c),c.changeType="addColumns",e.mUa(c)):"customName"===d?c.nameInfo.fg(c.expr):"condition"===d&&c.condition.setExpressions(c.expressions)},s.gUa=function(a){var b,c=x(this),d=this.Bj();for(c.suspend();a.length;)b=a.pop(),b.type?this.nUa(c,d,b):d.$Va.apply(d,b);c.resume(!1)};function B(a,b,c,d,e){var f,g,h,i,j,k,l;if(!a.parent||!a.parent.sheets)return f=a.getCustomNames(),void(f&&m(f,function(f,i){g=i.getExpression(),h=C(a,a,b,c,d,e,g),h!==g&&i.fg(h)}));for(i=a.parent.sheets,j=a.parent.getCustomNames(),j&&m(j,function(f,i){g=i.getExpression(),h=C(null,a,b,c,d,e,g),h!==g&&i.fg(h)}),k=function(j){f=i[j].getCustomNames(),f&&m(f,function(f,k){g=k.getExpression(),h=C(i[j],a,b,c,d,e,g),h!==g&&k.fg(h)})},l=0;l<i.length;l++)k(l)}function C(a,b,c,d,e,f,h){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,D,E,F,G,H,I,J,K,L,M,N=b.yj(),O=g.Hh(g.Errors.Reference,N);if(9===h.type){if(l=h.value,m=h.value2,n=C(a,b,c,d,e,f,l),o=m&&C(a,b,c,d,e,f,m),l!==n||m!==o)return g.Kh(h.operatorType,n,o)}else if(7===h.type){for(p=!1,q=[],r=void 0,s=0;s<h.arguments.length;s++)r=h.arguments[s],t=C(a,b,c,d,e,f,r),p=p||r!==t,q.push(t);if(p)return g.Jh(h,q)}else if(1===h.type&&h.sf()){if(j=h.source||a&&a.yj(),u=h.row,v=h.column,w=u,x=v,j&&j===N&&(f&&!h.rowRelative||!f&&!h.columnRelative)){if(f&&e)u+=u>=c?d:0;else if(!f&&e)v+=v>=c?d:0;else if(f){if(u>=c+d)u-=d;else if(u>=c)return O}else if(v>=c+d)v-=d;else if(v>=c)return O;if(u!==w||v!==x)return i.rf(N,k,u,v,h.rowRelative,h.columnRelative)}}else if(1===h.type){if(j=h.source||a&&a.yj(),y=h.row,z=h.column,A=h.endRow,B=h.endColumn,D=h.rowRelative,E=h.columnRelative,F=h.endRowRelative,G=h.endColumnRelative,H=y,I=z,J=A,K=B,j&&j===N){if(f&&e)y+=!D&&y>=c?d:0,A+=!F&&A>=c?d:0;else if(!f&&e)z+=!E&&z>=c?d:0,B+=!G&&B>=c?d:0;else if(f&&!e){if(!D&&y>=c&&!F&&A<c+d)return O;if(D&&F||A<c)return h;if(!D)if(y>=c+d)y-=d;else if(y<c);else{if(F)return O;y>c&&(y=c)}if(!F)if(A>=c+d)A-=d;else{if(D)return O;A<c+d&&(A=c-1)}}else{if(!E&&z>=c&&!G&&B<c+d)return O;if(E&&G||B<c)return h;if(!E)if(z>=c+d)z-=d;else if(z<c);else{if(G)return O;z>c&&(z=c)}if(!G)if(B>=c+d)B-=d;else{if(E)return O;B<c+d&&(B=c-1)}}if(z!==I||B!==K||y!==H||A!==J)return i.uf(N,k,y,z,A,B,D,E,F,G)}}else if(10===h.type&&(L=h.value,M=C(a,b,c,d,e,f,L),L!==M))return g.Lh(M);return h}function D(a,b){var c,d,e,f,g,h,i,j=b.ah,k=j.getSource(),l=-1,m=-1;b.name?(d=b.name,f=b.id,q(f)?c=j.getNodeByName(d):(c={Lf:b.expression},e=!0)):(l=b.row,m=b.column,l=void 0===l?-1:l,m=void 0===m?-1:m,c=j.getNode(l,m)),g=c.Lf,h=c.Pf,i=a.unparse(k,g,l<0?0:l,m<0?0:m),h?l===h.row&&m===h.col&&j.setArrayFormula(h.row,h.col,h.rowCount,h.colCount,i):d?e?j.setFormula(f,d,i):j.setFormulaByName(d,i):j.setFormula(l,m,i,null,!0,!0)}function E(a){var b,c,d,e,f,g,h,i,j,k=x(a),l=k.getSourceModel(a.yj());if(l)for(b=l.getAllNodes(),c=0;c<b.length;c++)if(d=b[c],e=d.calc)for(d.Lf&&D(k,e),f=e.Ze,g=void 0,h=0;h<f.length;h++)if(i=e[f[h]])for(j in i)g=i[j],g&&g.ah!==l&&D(k,g)}function F(a,b,c,d,e,f,g,h,i){j.CalcOperatorAdjustor.copyFormula(a.Bj(),b,c,d.Bj(),e,f,g,h,i)}b.vyb=F;function G(a,b,c,d,e,f,h,j,l,m){var n,o,p,q,r,s,x,z,A,B,C,D,E,F=f-c,H=h-d,I=b.yj(),J=e.yj();if(9===m.type){if(n=m.value,o=m.value2,p=G(a,b,c,d,e,f,h,j,l,n),q=o&&G(a,b,c,d,e,f,h,j,l,o),n!==p||o!==q)return g.Kh(m.operatorType,p,q)}else if(7===m.type){for(r=!1,s=[],x=void 0,z=0;z<m.arguments.length;z++)x=m.arguments[z],A=G(a,b,c,d,e,f,h,j,l,x),r=r||x!==A,s.push(A);if(r)return g.Jh(m,s)}else if(1===m.type&&m.sf()){if((!m.source||m.source===I)&&!m.rowRelative&&m.row>=c&&m.row<c+j&&!m.columnRelative&&m.column>=d&&m.column<d+l)return i.rf(J,k,m.row+F,m.column+H)}else if(1===m.type){if(B=!v(m)&&!t(m),C=!w(m)&&!u(m),(!m.source||m.source===I)&&B&&m.row>=c&&y(m)>=d&&C&&m.endColumn<d+l&&m.endRow<c+j)return i.uf(J,k,m.row+(B?F:0),y(m)+(B?H:0),m.endRow+(C?F:0),m.endColumn+(C?H:0),v(m),t(m),w(m),u(m))}else if(10===m.type&&(D=m.value,E=G(a,b,c,d,e,f,h,j,l,D),D!==E))return g.Lh(E);return m}b.uyb=G,d.Worksheet.$n("calc",{priority:1e3,init:z,dispose:function(a){var b,c=this;a.clearCache!==!1&&(c.ft=k,c.Wu=k,b=c.et,b&&(a.isSpreadDestroy===!0?b.aCb():b.rzb(),c.et=k))},attach:function(a){var b=this;a instanceof d.Workbook?b.ev(a.Wu):b.ev()},onLayoutChanged:function(a){this.Cf().isAdjustSuspended()||this.mUa(a)},toJson:function(a,b){var c,e,f,g,h,i=this,j=i.Su;d.GC$.isEmptyObject(j)||(a.customFunctions=j),c=[],e=i.getCustomNames(),f=x(i),e&&f&&(m(e,function(a,b){var d,e,g=b.getName(),h=b.getRow(),j=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=f.unparse(i.yj(),k,h,j,!1,!0),e={name:g,formula:d,row:h,col:j},l&&(e.comment=l),c.push(e))}),c.length>0&&(a.names=c)),g=b&&b.ignoreFormula,h=i.et,h&&!g&&h.toJSON(a)},fromJson:function(a,b,c,d){var e=this;e.clearCustomFunctions(),e.clearCustomNames(),d&&(e.nameFunctionsFromJSON(a,b,c),e.formulaFromJSON(a,b,c))},setName:function(a){var b,c,d;E(this),b=this.Bj(),c=x(b),d=c.lh.asyncManager,d.changeSourceName(a.oldName,a.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function a(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function a(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},"./node_modules/process/browser.js":function(a,b){var c,d,e,f,g,h,i=a.exports={};function j(){throw Error("setTimeout has not been defined")}function k(){throw Error("clearTimeout has not been defined")}!function(){try{c="function"==typeof setTimeout?setTimeout:j}catch(a){c=j}try{d="function"==typeof clearTimeout?clearTimeout:k}catch(a){d=k}}();function l(a){if(c===setTimeout)return setTimeout(a,0);if((c===j||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(b){try{return c.call(null,a,0)}catch(b){return c.call(this,a,0)}}}function m(a){if(d===clearTimeout)return clearTimeout(a);if((d===k||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(b){try{return d.call(null,a)}catch(b){return d.call(this,a)}}}e=[],f=!1,h=-1;function n(){f&&g&&(f=!1,g.length?e=g.concat(e):h=-1,e.length&&o())}function o(){var a,b;if(!f){for(a=l(n),f=!0,b=e.length;b;){for(g=e,e=[];++h<b;)g&&g[h].run();h=-1,b=e.length}g=null,f=!1,m(a)}}i.nextTick=function(a){var b,c=Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];e.push(new p(a,c)),1!==e.length||f||l(o)};function p(a,b){this.fun=a,this.array=b}p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function q(){}i.on=q,i.addListener=q,i.once=q,i.off=q,i.removeListener=q,i.removeAllListeners=q,i.emit=q,i.prependListener=q,i.prependOnceListener=q,i.listeners=function(a){return[]},i.binding=function(a){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function a(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},"./node_modules/util/util.js":function(a,b,c){(function(a){var d,e,f,g,h=Object.getOwnPropertyDescriptors||function a(b){var c,d=Object.keys(b),e={};for(c=0;c<d.length;c++)e[d[c]]=Object.getOwnPropertyDescriptor(b,d[c]);return e},i=/%[sdj%]/g;b.format=function(a){var b,c,d,e,f,g;if(!y(a)){for(b=[],c=0;c<arguments.length;c++)b.push(j(arguments[c]));return b.join(" ")}for(c=1,d=arguments,e=d.length,f=(a+"").replace(i,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case"%s":return d[c++]+"";case"%d":return+d[c++];case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),g=d[c];c<e;g=d[++c])f+=v(g)||!C(g)?" "+g:" "+j(g);return f},b.deprecate=function(c,d){if(void 0!==a&&a.noDeprecation===!0)return c;if(void 0===a)return function(){return b.deprecate(c,d).apply(this,arguments)};var e=!1;function f(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d),e=!0}return c.apply(this,arguments)}return f},d={},b.debuglog=function(c){if(A(e)&&(e=a.env.NODE_DEBUG||""),c=c.toUpperCase(),!d[c])if(RegExp("\\b"+c+"\\b","i").test(e)){var f=a.pid;d[c]=function(){var a=b.format.apply(b,arguments);console.error("%s %d: %s",c,f,a)}}else d[c]=function(){};return d[c]};function j(a,c){var d={seen:[],stylize:l};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),u(c)?d.showHidden=c:c&&b.Ia(d,c),A(d.showHidden)&&(d.showHidden=!1),A(d.depth)&&(d.depth=2),A(d.colors)&&(d.colors=!1),A(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=k),n(d,a,d.depth)}b.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function k(a,b){var c=j.styles[b];return c?"\x1b["+j.colors[c][0]+"m"+a+"\x1b["+j.colors[c][1]+"m":a}function l(a,b){return a}function m(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function n(a,c,d){var e,f,g,h,i,j,k,l,u,v;if(a.customInspect&&c&&F(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c))return e=c.inspect(d,a),y(e)||(e=n(a,e,d)),e;if(f=o(a,c))return f;if(g=Object.keys(c),h=m(g),a.showHidden&&(g=Object.getOwnPropertyNames(c)),E(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return p(c);if(0===g.length){if(F(c))return i=c.name?": "+c.name:"",a.stylize("[Function"+i+"]","special");if(B(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(D(c))return a.stylize(Date.prototype.toString.call(c),"date");if(E(c))return p(c)}return j="",k=!1,l=["{","}"],t(c)&&(k=!0,l=["[","]"]),F(c)&&(u=c.name?": "+c.name:"",j=" [Function"+u+"]"),B(c)&&(j=" "+RegExp.prototype.toString.call(c)),D(c)&&(j=" "+Date.prototype.toUTCString.call(c)),E(c)&&(j=" "+p(c)),0!==g.length||k&&0!=c.length?d<0?B(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),v=k?q(a,c,d,h,g):g.map(function(b){return r(a,c,d,h,b,k)}),a.seen.pop(),s(v,j,l)):l[0]+j+l[1]}function o(a,b){if(A(b))return a.stylize("undefined","undefined");if(y(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return x(b)?a.stylize(""+b,"number"):u(b)?a.stylize(""+b,"boolean"):v(b)?a.stylize("null","null"):void 0}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function q(a,b,c,d,e){var f,g,h=[];for(f=0,g=b.length;f<g;++f)K(b,f+"")?h.push(r(a,b,c,d,f+"",!0)):h.push("");return e.forEach(function(e){e.match(/^\d+$/)||h.push(r(a,b,c,d,e,!0))}),h}function r(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=v(c)?n(a,i.value,null):n(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),A(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function s(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}b.isArray=t;function u(a){return"boolean"==typeof a}b.isBoolean=u;function v(a){return null===a}b.isNull=v;function w(a){return null==a}b.isNullOrUndefined=w;function x(a){return"number"==typeof a}b.isNumber=x;function y(a){return"string"==typeof a}b.isString=y;function z(a){return"symbol"==typeof a}b.isSymbol=z;function A(a){return void 0===a}b.isUndefined=A;function B(a){return C(a)&&"[object RegExp]"===H(a)}b.isRegExp=B;function C(a){return"object"==typeof a&&null!==a}b.isObject=C;function D(a){return C(a)&&"[object Date]"===H(a)}b.isDate=D;function E(a){return C(a)&&("[object Error]"===H(a)||a instanceof Error)}b.isError=E;function F(a){return"function"==typeof a}b.isFunction=F;function G(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}b.isPrimitive=G,b.isBuffer=c("./node_modules/util/support/isBufferBrowser.js");function H(a){return Object.prototype.toString.call(a)}function I(a){return a<10?"0"+a.toString(10):a.toString(10)}f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[I(a.getHours()),I(a.getMinutes()),I(a.getSeconds())].join(":");return[a.getDate(),f[a.getMonth()],b].join(" ")}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c("./node_modules/inherits/inherits_browser.js"),b.Ia=function(a,b){var c,d;if(!b||!C(b))return a;for(c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,b.promisify=function a(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');if(g&&b[g]){var c=b[g];if("function"!=typeof c)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),c}function c(){var a,c,d,e=new Promise(function(b,d){a=b,c=d}),f=[];for(d=0;d<arguments.length;d++)f.push(arguments[d]);f.push(function(b,d){b?c(b):a(d)});try{b.apply(this,f)}catch(a){c(a)}return e}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),g&&Object.defineProperty(c,g,{value:c,
enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(c,h(b))},b.promisify.custom=g;function L(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function M(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');function c(){var c,d,e,f,g=[];for(c=0;c<arguments.length;c++)g.push(arguments[c]);if(d=g.pop(),"function"!=typeof d)throw new TypeError("The last argument must be of type Function");e=this,f=function(){return d.apply(e,arguments)},b.apply(this,g).then(function(b){a.nextTick(f,null,b)},function(b){a.nextTick(L,b,f)})}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),Object.defineProperties(c,h(b)),c}b.callbackify=M}).call(this,c("./node_modules/process/browser.js"))},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});