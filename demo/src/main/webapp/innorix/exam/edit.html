<html>    <head>        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />        <link rel="stylesheet" href="../innorix.css">        <script src="../innorix.js"></script>        <script>            var innoJquery = innorix._load("innoJquery");                    var urlBase         = location.href.substring(0, location.href.lastIndexOf("/") + 1);            var control         = new Object(); // 파일전송 컨트롤 객체선언            var downFileArr     = new Array(); // 다운로드 목록 정보            var resetFileArr    = new Array(); // 다운로드 목록 초기화 정보            var delFileArr      = new Array(); // 삭제된 파일 정보            var removeFlag      = true; // 삭제 이벤트 조건 플래그            // 키값에 해당하는 인덱스 삭제            function deleteArr(array, key, value) {                for (var i = 0; i < array.length; i++) {                    if (array[i][key] == value) {                        array.splice(i, 1);                    }                }            }            // 목록 초기화            function reset() {                removeFlag = false;                delFileArr = new Array(); // 삭제정보 초기화                control.removeAllFiles(); // 리스트 컨트롤에서 파일을 삭제                control.presetDownloadFiles(resetFileArr); // 다운로드 목록 초기화            }            // 저장하기            function save() {                if (control.getUploadFiles().length > 0) {                    control.upload();                } else if (delFileArr.length > 0) {                    submit(null, delFileArr, './result.jsp');                } else {                    alert("변경 사항이 없습니다.");                }            }            // 업로드, 삭제된 파일정보 submit            function submit(uploadFileArr, delFileArr, url) {                innoJquery.post(url, { uploadFiles: uploadFileArr, deleteFiles: delFileArr})                  .done(function(data) {                    delFileArr = new Array(); // 삭제정보 초기화                    alert(data);                });            }            window.onload = function() {                // 파일전송 컨트롤 생성                control = innorix.create({                    el: '#fileControl', // 컨트롤 출력 HTML 객체 ID                    transferMode: 'both', // 업로드, 다운로드 혼합사용                    installUrl: '../install/install.html', // Agent 설치 페이지                    uploadUrl: './upload.jsp' // 업로드 URL                });                                // 업로드 완료 이벤트                control.on('uploadComplete', function (p) {                    alert("업로드가 완료 되었습니다.\n다운로드 가능하게 재구성 합니다.");                    var fileArray = new Array();                    var f = p.files;                    // 업로드, 삭제된 파일정보 submit                    submit(f, delFileArr, "./result.jsp");                                        // 업로드 완료된 파일을 다운로드 배열에 담기                    for (var i = 0; i < f.length; i++ ) {                        var fileObj = new Object();                            fileObj.printFileName   = f[i].clientFileName;                            fileObj.fileSize        = f[i].fileSize;                            fileObj.downloadUrl     = urlBase + "download.jsp?fileName=" + f[i].serverFileName;                        downFileArr.push(fileObj);                    }                    removeFlag = false; // 삭제 이벤트 발생시 동작을 방지                    control.removeAllFiles(); // 리스트 컨트롤에서 파일을 삭제                    control.presetDownloadFiles(downFileArr); // 다운로드 목록을 구성                });                // 파일전송 컨트롤 로딩 완료                control.on('loadComplete', function (p) {                    // 다운로드 목록                    downFileArr =                        [{                            printFileName: "INNORIX WP 브로셔.pdf",                            fileSize: 1433885,                            downloadUrl: urlBase + "download.jsp?fileID=1"                        },                        {                            printFileName: "INNORIX WP Brochure.pdf",                            fileSize: 1433885,                            downloadUrl: urlBase + "download.jsp?fileID=2"                        },                        {                            printFileName: "INNORIX WP パンフレット.pdf",                            fileSize: 1433885,                            downloadUrl: urlBase + "download.jsp?fileID=3"                        }];                    resetFileArr = downFileArr; // 다운로드 정보 초기화 정보 생성                    resetFileArr = resetFileArr.slice(0); // 배열 깊은 복사                    control.presetDownloadFiles(resetFileArr); // 다운로드 파일 추가                });                // 파일 삭제 이벤트                control.on('removeFiles', function (p) {                    if (removeFlag == true) {                        // 삭제된 파일정보 배열에 담기                        for (var i = 0; i < p.length; i++ ) {                            var fileObj = new Object();                            if (p[i].transferType == "download")                            {                                fileObj.downloadUrl     = p[i].downloadUrl;                                fileObj.printFileName   = p[i].printFileName;                                fileObj.fileSize        = p[i].fileSize;                                                                delFileArr.push(fileObj);                                deleteArr(downFileArr, "printFileName", p[i].printFileName);                            }                        }                    }                    removeFlag = true;                });            };        </script>    </head>    <body>        <a href="../index.html">&larr; 예제 목록</a><br /><br />        <div id="fileControl"></div><br/>        <input type="button" value="파일추가" onclick="control.openFileDialog();"/> |        <input type="button" value="선택파일 다운로드" onclick="control.downloadSelectedFiles();"/>        <input type="button" value="전체파일 다운로드" onclick="control.download();"/> |        <input type="button" value="선택파일 삭제" onclick="control.removeSelectedFiles();"/>        <input type="button" value="전체파일 삭제" onclick="control.removeAllFiles();"/>        <br /><br />        <input type="button" value="목록 초기화" onclick="reset();"/>        <input type="button" value="저장하기" onclick="save();"/>    </body></html>