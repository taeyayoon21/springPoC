/*!
    *
    * Wijmo Library 5.20202.724
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){!function(t){"use strict";var o=function(t){__extends(_Cell,t);function _Cell(o){var r=t.call(this)||this;r._row=r._col=0;r._rowspan=r._colspan=1;e.copy(r,o);return r}Object.defineProperty(_Cell.prototype,"row",{get:function(){return this._row},set:function(t){this._row=e.asInt(t,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(_Cell.prototype,"col",{get:function(){return this._col},set:function(t){this._col=e.asInt(t,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(_Cell.prototype,"colspan",{get:function(){return this._colspan},set:function(t){this._colspan=e.asInt(t,!1,!0);e.assert(this._colspan>0,"colspan must be >= 1")},enumerable:!0,configurable:!0});Object.defineProperty(_Cell.prototype,"rowspan",{get:function(){return this._rowspan},set:function(t){this._rowspan=e.asInt(t,!1,!0);e.assert(this._rowspan>0,"colspan must be >= 1")},enumerable:!0,configurable:!0});return _Cell}(e.grid.Column);t._Cell=o}(t.multirow||(t.multirow={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var o=function(e){__extends(_MultiRow,e);function _MultiRow(t,o,r){var n=e.call(this,t)||this;n._idxData=o;n._idxRecord=r;return n}Object.defineProperty(_MultiRow.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});return _MultiRow}(e.grid.Row);t._MultiRow=o;var r=function(t){__extends(_MultiGroupRow,t);function _MultiGroupRow(e,o){var r=t.call(this,e)||this;r._idxRecord=o;return r}Object.defineProperty(_MultiGroupRow.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});Object.defineProperty(_MultiGroupRow.prototype,"hasChildren",{get:function(){return!0},enumerable:!0,configurable:!0});_MultiGroupRow.prototype.getCellRange=function(){var e=this._getLastRowInHeader();return e!=this?e.getCellRange():t.prototype.getCellRange.call(this)};Object.defineProperty(_MultiGroupRow.prototype,"isCollapsed",{get:function(){return this._getLastRowInHeader()._getFlag(e.grid.RowColFlags.Collapsed)},set:function(t){var o=this._getLastRowInHeader();t!=o.isCollapsed&&null!=o._list&&o._setCollapsed(e.asBoolean(t))},enumerable:!0,configurable:!0});_MultiGroupRow.prototype._setCollapsed=function(t){var o=this,r=this.grid,n=r.rows,i=this.getCellRange(),l=new e.grid.CellRangeEventArgs(r.cells,new e.grid.CellRange(this.index,-1));if(r.onGroupCollapsedChanging(l)){r.deferUpdate((function(){n.deferUpdate((function(){o._setFlag(e.grid.RowColFlags.Collapsed,t,!0);for(var r=i.topRow+1;r<=i.bottomRow&&r>-1&&r<n.length;r++){n[r]._setFlag(e.grid.RowColFlags.ParentCollapsed,t,!0);var l=n[r];if(l instanceof _MultiGroupRow){var s=l._getLastRowInHeader();for(r+=1;r<=s.index;r++)(l=n[r])._setFlag(e.grid.RowColFlags.ParentCollapsed,t,!0);r--}l instanceof e.grid.GroupRow&&l.isCollapsed&&(r=l.getCellRange().bottomRow)}}))}));r.onGroupCollapsedChanged(l)}};_MultiGroupRow.prototype._getLastRowInHeader=function(){var t=this.grid,o=this;if(t.multiRowGroupHeaders)for(var r=t.rows,n=this.dataItem,i=this.index+1;i<r.length&&r[i].dataItem==n;i++)o=r[i];e.assert(o instanceof _MultiGroupRow,"last row in header should be a _MultiRowGroup");return o};return _MultiGroupRow}(e.grid.GroupRow);t._MultiGroupRow=r})((t=e.grid||(e.grid={})).multirow||(t.multirow={}))}(wijmo||(wijmo={}));!function(e){!function(t){!function(t){"use strict";var o=function(o){__extends(MultiRow,o);function MultiRow(r,n){var i=o.call(this,r)||this;i._centerVert=!0;i._collapsedHeaders=!1;i._multiRowGroupHeaders=!1;i._rowHdrCnt=0;i.collapsedHeadersChanging=new e.Event;i.collapsedHeadersChanged=new e.Event;i._layout=new t._MultiRowLayout(i,null);e.addClass(i.hostElement,"wj-multirow");var l=i.columnHeaders.hostElement.parentElement,s=e.createElement('<div class="wj-hdr-collapse"><span></span></div>');s.style.display="none";l.appendChild(s);i._btnCollapse=s;i._updateButtonGlyph();i.addEventListener(s,"mousedown",(function(e){switch(i.collapsedHeaders){case null:case!1:i._collapsedHeadersWasNull=null==i.collapsedHeaders;i.collapsedHeaders=!0;break;case!0:i.collapsedHeaders=!!i._collapsedHeadersWasNull&&null}e.preventDefault();i.focus()}),!0);var a=i.hostElement;i.addEventListener(a,"mousedown",(function(e){if(!i._mouseHdl._szRowCol){var t=i._layout?i._layout._bindingGroups:null;if(t&&t[0].isRowHeader){var o=i.hitTest(e);if(o.panel==i.columnHeaders&&o.col<i.frozenColumns){e.preventDefault();i.selectAll()}}}}),!0);i.removeEventListener(a,"dragover");i.removeEventListener(a,"dragleave");i.removeEventListener(a,"dragdrop");i._addHdl=new t._MultiRowAddNewHandler(i);i.formatItem.addHandler(i._formatItem,i);i.autoGenerateColumns=!1;i.allowDragging=e.grid.AllowDragging.None;i.mergeManager=new t._MergeManager(i);i.initialize(n);return i}MultiRow.prototype._getProductInfo=function(){return"H87K,MultiRow"};Object.defineProperty(MultiRow.prototype,"layoutDefinition",{get:function(){return this._layoutDef},set:function(o){this._layoutDef=e.asArray(o);this._layout=new t._MultiRowLayout(this,o);this._rowHdrCnt=0;if(this._layout)for(var r=this._layout._bindingGroups,n=0;n<r.length;n++){var i=r[n];if(!i.isRowHeader)break;this._rowHdrCnt=i._colstart+i.colspan;i.cells.forEach((function(e){e.isReadOnly=!0;!e.header||e.binding||e.cellTemplate||(e.cellTemplate=e.header);e.cssClass?e.cssClass.indexOf("wj-header")<0&&(e.cssClass+=" wj-header"):e.cssClass="wj-header"}))}this.frozenColumns=this._rowHdrCnt;this._bindGrid(!0);this._rowHdrCnt&&this.selectionMode&&this.select(this.selection.row,this._rowHdrCnt)},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"headerLayoutDefinition",{get:function(){return this._hdrLayoutDef},set:function(o){this._hdrLayoutDef=e.asArray(o);this._hdrLayout=o?new t._MultiRowLayout(this,o):null;this._bindGrid(!0)},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"rowsPerItem",{get:function(){return this._layout._rowsPerItem},enumerable:!0,configurable:!0});MultiRow.prototype.getBindingColumn=function(e,t,o){return this._getBindingColumn(e,t,e.columns[o])};MultiRow.prototype.getColumn=function(t){if(e.isString(t)){for(var r=this._layout._bindingGroups,n=null,i=0;i<r.length&&!n;i++)n=r[i].getColumn(t);return n}return o.prototype.getColumn.call(this,t)};Object.defineProperty(MultiRow.prototype,"centerHeadersVertically",{get:function(){return this._centerVert},set:function(t){if(t!=this._centerVert){this._centerVert=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"collapsedHeaders",{get:function(){return this._collapsedHeaders},set:function(t){if(t!=this._collapsedHeaders){var o=new e.CancelEventArgs;if(this.onCollapsedHeadersChanging(o)){this._collapsedHeaders=e.asBoolean(t,!0);this._updateCollapsedHeaders();this._updateButtonGlyph();this.onCollapsedHeadersChanged(o)}}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"showHeaderCollapseButton",{get:function(){return""==this._btnCollapse.style.display},set:function(t){t!=this.showHeaderCollapseButton&&(this._btnCollapse.style.display=e.asBoolean(t)?"":"none")},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"multiRowGroupHeaders",{get:function(){return this._multiRowGroupHeaders},set:function(t){if(t!=this._multiRowGroupHeaders){this._multiRowGroupHeaders=e.asBoolean(t);this._bindGrid(!0)}},enumerable:!0,configurable:!0});MultiRow.prototype.onCollapsedHeadersChanging=function(e){this.collapsedHeadersChanging.raise(this,e);return!e.cancel};MultiRow.prototype.onCollapsedHeadersChanged=function(e){this.collapsedHeadersChanged.raise(this,e)};Object.defineProperty(MultiRow.prototype,"allowPinning",{get:function(){return!1},set:function(t){e.assert(!t,"MultiRow does not support pinning.")},enumerable:!0,configurable:!0});MultiRow.prototype.onSelectionChanging=function(r){var n=r._rng;if(n&&n.isValid&&this.selectionMode){var i=this._mouseHdl._htDown,l=this.rows,s=this.columns,a=this._rowHdrCnt;if(a){n.col=Math.max(n.col,a);n.col2=Math.max(n.col2,a)}if(i&&(i.panel==this.rowHeaders||i.panel==this.cells&&i.col<a)){var u=l[n.topRow],c=l[n.bottomRow];if(u&&null!=u.recordIndex){var d=u.index-u.recordIndex,p=c instanceof t._MultiGroupRow&&!this._multiRowGroupHeaders?1:this.rowsPerItem,w=c.index-c.recordIndex+p-1,h=s.length-1,g=n.row!=n.topRow?new e.grid.CellRange(w,0,d,h):new e.grid.CellRange(d,0,w,h);n.row=g.row;n.row2=g.row2;n.col2=h;switch(this.selectionMode){case e.grid.SelectionMode.Cell:n.row2=g.row;n.col2=g.col;break;case e.grid.SelectionMode.Row:n.row2=g.row}}}}return o.prototype.onSelectionChanging.call(this,r)};MultiRow.prototype._getDeleteColumnIndex=function(){return this._rowHdrCnt};MultiRow.prototype._getQuickAutoSize=function(){return e.isBoolean(this.quickAutoSize)?this.quickAutoSize:this.formatItem.handlerCount<=1&&null==this.itemFormatter};MultiRow.prototype._addBoundRow=function(e,o){for(var r=e[o],n=0;n<this.rowsPerItem;n++)this.rows.push(new t._MultiRow(r,o,n))};MultiRow.prototype._addNode=function(e,t,o){this._addBoundRow(e,t)};MultiRow.prototype._addGroupRow=function(e){for(var o=this._multiRowGroupHeaders?this.rowsPerItem:1,r=0;r<o;r++)this.rows.push(new t._MultiGroupRow(e,r))};MultiRow.prototype._bindColumns=function(){for(var t=this,o=this.columnHeaders.rows,r=this._layout,n=this._hdrLayout,i=(n?n._rowsPerItem:this.rowsPerItem)+1;o.length>i;)o.removeAt(o.length-1);for(;o.length<i;)o.push(new e.grid.Row);this._updateCollapsedHeaders();this.columns.clear();r&&r._bindingGroups.forEach((function(o){for(var _loop_1=function(r){for(var n=new e.grid.Column,_loop_2=function(e){var t=o.cells[e];if(t._col==r){"width,minWidth,maxWidth,binding,header,format,dataMap,name,aggregate,cellTemplate".split(",").forEach((function(e){null!=t[e]&&(n[e]=t[e])}));return"break"}},i=0;i<o.cells.length;i++){if("break"===_loop_2(i))break}t.columns.push(n)},r=0;r<o._colspan;r++)_loop_1(r)}))};MultiRow.prototype._updateCollapsedHeaders=function(){var e=this.columnHeaders.rows,t=this.collapsedHeaders;e[0].visible=0!=t;for(var o=1;o<e.length;o++)e[o].visible=1!=t};MultiRow.prototype._updateColumnTypes=function(){o.prototype._updateColumnTypes.call(this);var t=this.collectionView;if(e.hasItems(t)){var r=t.items[0];this._layout&&this._layout._updateCellTypes(r);this._hdrLayout&&this._hdrLayout._updateCellTypes(r)}};MultiRow.prototype._getBindingColumn=function(t,o,r){if(t==this.cells||t==this.columnHeaders){var n=t.cellType==e.grid.CellType.ColumnHeader;n&&o--;r=this._getGroupByColumn(r.index,n).getBindingColumn(t,o,r.index)}return r};MultiRow.prototype._getBindingColumns=function(){var e=[];this._layout._bindingGroups.forEach((function(t){t._cols.forEach((function(t){e.indexOf(t)<0&&e.push(t)}))}));return e};MultiRow.prototype._cvCollectionChanged=function(o,r){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var n=e.collections.NotifyCollectionChangedAction;switch(r.action){case n.Change:this.invalidate();break;case n.Add:if(r.index==this.collectionView.items.length-1){for(var i=this.rows.length;i>0&&this.rows[i-1]instanceof e.grid._NewRowTemplate;)i--;for(var l=0;l<this.rowsPerItem;l++)this.rows.insert(i+l,new t._MultiRow(r.item,r.index,l));return}e.assert(!1,"added item should be the last one.");break;default:this._bindGrid(!1)}}};MultiRow.prototype._getGroupByColumn=function(o,r){var n=null;r&&this._hdrLayout&&!this.collapsedHeaders&&(n=this._hdrLayout._getGroupByColumn(o));n||(n=this._layout._getGroupByColumn(o));e.assert(n instanceof t._CellGroup,"Failed to get the group!");return n};MultiRow.prototype._formatItem=function(o,r){var n=this.rowsPerItem,i=r.panel,l=i.cellType,s=i.rows[r.range.row],a=i.rows[r.range.row2],u=r.cell;l==e.grid.CellType.ColumnHeader&&e.toggleClass(u,"wj-group-header",0==r.range.row);if(l==e.grid.CellType.Cell||l==e.grid.CellType.ColumnHeader){var c=this._getGroupByColumn(r.col,l==e.grid.CellType.ColumnHeader);e.toggleClass(u,"wj-group-start",c._colstart==r.range.col);e.toggleClass(u,"wj-group-end",c._colstart+c._colspan-1==r.range.col2)}if(n>1&&(l==e.grid.CellType.Cell||l==e.grid.CellType.RowHeader)){var d=s instanceof t._MultiRow||s instanceof t._MultiRowNewRowTemplate,p=a instanceof t._MultiRow||a instanceof t._MultiRowNewRowTemplate;e.toggleClass(u,"wj-record-start",!!d&&0==s.recordIndex);e.toggleClass(u,"wj-record-end",!!p&&a.recordIndex==n-1)}var w=this.alternatingRowStep;if(w){var h=!1;if(s instanceof t._MultiRow){h=s.dataIndex%(w+1)==0;1==w&&(h=!h)}e.toggleClass(u,"wj-alt",h)}if(this._centerVert&&!u.getAttribute("wj-state-measuring")){var g=!1;if(u.innerHTML&&r.range.rowSpan>1){g=!0;if(0==u.childElementCount)u.innerHTML="<div>"+u.innerHTML+"</div>";else{var _=document.createElement("div"),f=document.createRange();f.selectNodeContents(u);f.surroundContents(_)}}e.toggleClass(u,"wj-center-vert",g)}};MultiRow.prototype._updateButtonGlyph=function(){var e=this._btnCollapse.querySelector("span");e instanceof HTMLElement&&(e.className=this.collapsedHeaders?"wj-glyph-left":"wj-glyph-down-left")};MultiRow.prototype._getError=function(t,r,n,i){if(e.isFunction(this.itemValidator)&&t==this.rowHeaders)for(var l=0;l<this.rowsPerItem;l++)for(n=0;n<this.columns.length;n++){var s=this.itemValidator(r+l,n,i);if(s)return s}return o.prototype._getError.call(this,t,r,n,i)};return MultiRow}(e.grid.FlexGrid);t.MultiRow=o}(t.multirow||(t.multirow={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var o=function(t){__extends(_MultiRowAddNewHandler,t);function _MultiRowAddNewHandler(e){e._addHdl._detach();return t.call(this,e)||this}_MultiRowAddNewHandler.prototype.updateNewRowTemplate=function(){for(var e=this._g.editableCollectionView,t=this._g,o=t.rows,n=e&&e.canAddNew&&t.allowAddNew&&!t.isReadOnly,i=-1,l=0;l<o.length;l+=t.rowsPerItem)if(o[l]instanceof r){i=l;break}if(n&&i>-1&&(this._top&&i>0||!this._top&&0==i)){i=-1;this._removeNewRowTemplate()}if(n&&i<0)for(l=0;l<t.rowsPerItem;l++){var s=new r(l);this._top?o.insert(l,s):o.push(s)}!n&&i>-1&&this._removeNewRowTemplate()};_MultiRowAddNewHandler.prototype._keydown=function(o){t.prototype._keydown.call(this,o);o.defaultPrevented||o.keyCode!=e.Key.Escape||this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._rowEditEnded=function(e,o){t.prototype._rowEditEnded.call(this,e,o);this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._beginningEdit=function(e,o){t.prototype._beginningEdit.call(this,e,o);this._top&&!e.rows[0].dataItem&&this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._copyNewDataItem=function(){if(this._top)for(var t=this._g,o=t.rows,r=0;r<t.rowsPerItem;r++)o[r]instanceof e.grid._NewRowTemplate&&(o[r].dataItem=this._nrt.dataItem)};_MultiRowAddNewHandler.prototype._removeNewRowTemplate=function(){for(var t=0,o=this._g.rows;t<o.length;t++)if(o[t]instanceof e.grid._NewRowTemplate){o.removeAt(t);t--}};return _MultiRowAddNewHandler}(e.grid._AddNewHandler);t._MultiRowAddNewHandler=o;var r=function(e){__extends(_MultiRowNewRowTemplate,e);function _MultiRowNewRowTemplate(t){var o=e.call(this)||this;o._idxRecord=t;return o}Object.defineProperty(_MultiRowNewRowTemplate.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});return _MultiRowNewRowTemplate}(e.grid._NewRowTemplate);t._MultiRowNewRowTemplate=r})((t=e.grid||(e.grid={})).multirow||(t.multirow={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var o=function(o){__extends(_CellGroup,o);function _CellGroup(t,r){var n=o.call(this)||this;n._isRowHeader=!1;n._colstart=0;n._layout=t;n._g=t._grid;e.copy(n,r);if(!n._cells)throw"Cell group with no cells?";var i=0,l=0;n._cells.forEach((function(e,t){for(;!n._cellFits(e,t,i,l);)0==(l=(l+1)%n.colspan)&&i++;e.row=i;e.col=l}));var s=1,a=1;n._cells.forEach((function(e){s=Math.max(s,e.row+e.rowspan);a=Math.max(a,e.col+e.colspan)}));n.rowspan=s;n.colspan=a;return n}_CellGroup.prototype._copy=function(o,r){var n=this;if("cells"==o){this._cells=[];e.isArray(r)&&r.forEach((function(o){var r=new t._Cell(o);r.binding&&!r.header&&(r.header=e.toHeaderCase(r.binding));n._cells.push(r);n.colspan=Math.max(n.colspan,r.colspan)}));return!0}return!1};Object.defineProperty(_CellGroup.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0});Object.defineProperty(_CellGroup.prototype,"isRowHeader",{get:function(){return this._isRowHeader},set:function(t){this._isRowHeader=e.asBoolean(t)},enumerable:!0,configurable:!0});_CellGroup.prototype.closeGroup=function(t){var o=this;if(t>this.rowspan){this._cells.forEach((function(e){e.row==o.rowspan-1&&(e.rowspan=t-e.row)}));this.rowspan=t}this._cells.forEach((function(e){for(;e.col+e.colspan<o.colspan&&!o._slotTaken(e.row,e.col+e.colspan);)e.colspan++}));this._cells.forEach((function(e){for(;e.row+e.rowspan<o.rowspan&&!o._slotTaken(e.row+e.rowspan,e.col);)e.rowspan++}));for(var r=0;r<this.rowspan;r++)for(var n=0;n<this.colspan;n++)e.assert(this._slotTaken(r,n),"Invalid layout (empty cells).");this._cols=new e.grid.ColumnCollection(this._g,this._g.columns.defaultSize);this._rng=new Array(t*this.colspan);this._cells.forEach((function(t){for(var r=0;r<t.rowspan;r++)for(var n=0;n<t.colspan;n++){var i=(t.row+r)*o.colspan+t.col+n;o._cols.setAt(i,t);var l=new e.grid.CellRange(0-r,0-n,0-r+t.rowspan-1,0-n+t.colspan-1);l.isSingleCell||(o._rng[i]=l)}}));var i=this._colstart;this._rng[-1]=new e.grid.CellRange(0,i,0,i+this.colspan-1);this._hasAggregates=!1;for(var l=0;l<this._cells.length&&!this._hasAggregates;l++)this._hasAggregates=0!=this._cells[l].aggregate};_CellGroup.prototype.getColumnWidth=function(e){for(var t=0;t<this._cells.length;t++){var o=this._cells[t];if(o.col==e&&1==o.colspan)return o.width}return null};_CellGroup.prototype.getMergedRange=function(o,r,n){if(r<0)return this._rng[-1];var i=o.rows[r],l=null!=i.recordIndex?i.recordIndex:r%this.rowspan,s=n-this._colstart,a=this._rng[l*this.colspan+s];o.cellType==e.grid.CellType.ColumnHeader&&r++;if(o.cellType==e.grid.CellType.Cell&&i instanceof t._MultiGroupRow){var u=o.grid;if(u.multiRowGroupHeaders&&!this._hasAggregates){var c=u._layout._bindingGroups,d=c.indexOf(this),p=u.rowsPerItem;(a=new e.grid.CellRange(Math.floor(r/p)*p,this._colstart)).row2+=p-1;a.col2+=this.colspan-1;for(var w=d-1;w>=0&&!c[w]._hasAggregates;w--)a.col-=c[w].colspan;for(var h=d+1;h<c.length&&!c[h]._hasAggregates;h++)a.col2+=c[h].colspan;return a}}return a?new e.grid.CellRange(r+a.row,n+a.col,r+a.row2,n+a.col2):null};_CellGroup.prototype.getBindingColumn=function(e,t,o){if(t<0)return this;var r=e.rows[t],n=r&&null!=r.recordIndex?r.recordIndex:t%this.rowspan,i=o-this._colstart;return this._cols[n*this.colspan+i]};_CellGroup.prototype.getColumn=function(e){return this._cols.getColumn(e)};_CellGroup.prototype._cellFits=function(e,t,o,r){if(r>0&&r+e.colspan>this.colspan)return!1;for(var n=0;n<e.colspan;n++)if(this._slotTaken(o,r+n,t))return!1;this.colspan=Math.max(this.colspan,r+e.colspan-1);return!0};_CellGroup.prototype._slotTaken=function(e,t,o){void 0===o&&(o=this._cells.length);for(var r=0;r<o;r++){var n=this._cells[r];if(e>=n.row&&e<=n.row+n.rowspan-1&&t>=n.col&&t<=n.col+n.colspan-1)return!0}return!1};return _CellGroup}(t._Cell);t._CellGroup=o})((t=e.grid||(e.grid={})).multirow||(t.multirow={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var o=function(o){__extends(_MergeManager,o);function _MergeManager(){return null!==o&&o.apply(this,arguments)||this}_MergeManager.prototype.getMergedRange=function(r,n,i,l){void 0===l&&(l=!0);var s=r.grid;if(n<0||n>=r.rows.length||i<0||i>=r.columns.length)return null;switch(r.cellType){case e.grid.CellType.Cell:case e.grid.CellType.RowHeader:if(r.rows[n]instanceof e.grid.GroupRow&&!s.multiRowGroupHeaders)return o.prototype.getMergedRange.call(this,r,n,i,l)}switch(r.cellType){case e.grid.CellType.Cell:case e.grid.CellType.ColumnHeader:var a=r.cellType==e.grid.CellType.ColumnHeader,u=s._getGroupByColumn(i,a);e.assert(u instanceof t._CellGroup,"Failed to get the group!");var c=a?u.getMergedRange(r,n-1,i):u.getMergedRange(r,n,i),d=r.columns.frozen;if(d&&c&&c.columnSpan>1&&c.col<d&&c.col2>=d){c=c.clone();i<d?c.col2=d-1:c.col=d}var p=r.rows.frozen;if(p&&c&&c.rowSpan>1&&r.cellType==e.grid.CellType.Cell&&c.row<p&&c.row2>=p){c=c.clone();n<p?c.row2=p-1:c.row=p}e.assert(!c||c.contains(n,i),"Merged range must contain source cell");return c;case e.grid.CellType.RowHeader:var w=s.rowsPerItem,h=n-r.rows[n].recordIndex,g=Math.min(h+w-1,r.rows.length-1);return new e.grid.CellRange(h,0,g,r.columns.length-1);case e.grid.CellType.TopLeft:return new e.grid.CellRange(0,0,r.rows.length-1,r.columns.length-1)}return null};return _MergeManager}(e.grid.MergeManager);t._MergeManager=o})((t=e.grid||(e.grid={})).multirow||(t.multirow={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var o=function(){function _MultiRowLayout(e,t){this._rowsPerItem=1;this._bindingGroups=[];this._groupsByColumn={};this._grid=e;this._bindingGroups=this._parseCellGroups(t)}_MultiRowLayout.prototype._parseCellGroups=function(e){var o=[],r=1;if(e){for(var n=0,i=0;n<e.length;n++){var l=new t._CellGroup(this,e[n]);l._colstart=i;i+=l._colspan;r=Math.max(r,l._rowspan);o.push(l)}o.forEach((function(e){e.closeGroup(r)}));this._rowsPerItem=r}return o};_MultiRowLayout.prototype._getGroupByColumn=function(e){var t=this._groupsByColumn[e];if(!t)for(var o=this._bindingGroups,r=0;r<o.length;r++)if(e>=(t=o[r])._colstart&&e<=t._colstart+t._colspan-1){this._groupsByColumn[e]=t;break}return t};_MultiRowLayout.prototype._updateCellTypes=function(t){this._bindingGroups.forEach((function(o){o._cols.forEach((function(o){null==o.dataType&&o._binding&&(o.dataType=e.getType(o._binding.getValue(t)));if(!o.isReadOnly){var r=e.isIE()?null:Object.getOwnPropertyDescriptor(t,o.binding);o.isReadOnly=r&&!r.writable&&!r.set}}))}))};return _MultiRowLayout}();t._MultiRowLayout=o})((t=e.grid||(e.grid={})).multirow||(t.multirow={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.multirow||(t.multirow={}),e._registerModule("wijmo.grid.multirow",e.grid.multirow)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));