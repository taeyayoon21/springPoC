/*!
    *
    * Wijmo Library 5.20202.724
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){var t;(function(t){var o="wj-column-selector",i=function(){function Selector(t,o){this._col=null;this._grid=null;this._isFixedCol=!1;this._isBound=!1;this._showCheckAll=!0;this._clickBnd=this._click.bind(this);this._mousedownBnd=this._mousedown.bind(this);this.columnChanging=new e.Event;this.columnChanged=new e.Event;this.itemChecked=new e.Event;this._initialize();this.column=this._getColumn(t);e.copy(this,o)}Object.defineProperty(Selector.prototype,"column",{get:function(){return this._col},set:function(t){if((t=this._getColumn(t))!=this._col&&this.onColumnChanging(new e.CancelEventArgs)){var o=this._grid;if(o){var i=o.hostElement;o.formatItem.removeHandler(this._formatItem,this);o.removeEventListener(i,"click",this._clickBnd);o.removeEventListener(i,"mousedown",this._mousedownBnd)}var n=this._col=e.asType(t,e.grid.Column,!0);this._grid=o=n?n.grid:null;this._isFixedCol=!!o&&o.columns.indexOf(n)<0;n&&!this._isBound&&(n.allowMerging=!1);o&&!this._isBound&&(o.selectionMode=e.grid.SelectionMode.Cell);if(o){i=o.hostElement;o.formatItem.addHandler(this._formatItem,this);o.addEventListener(i,"click",this._clickBnd,!0);o.addEventListener(i,"mousedown",this._mousedownBnd,!0)}this.onColumnChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Selector.prototype,"showCheckAll",{get:function(){return this._showCheckAll},set:function(t){if(t!=this._showCheckAll){this._showCheckAll=e.asBoolean(t);this._grid&&this._grid.invalidate()}},enumerable:!0,configurable:!0});Selector.prototype.onColumnChanging=function(e){this.columnChanging.raise(this,e);return!e.cancel};Selector.prototype.onColumnChanged=function(e){this.columnChanged.raise(this,e)};Selector.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)};Selector.prototype._initialize=function(){};Selector.prototype._click=function(t){if(!t.defaultPrevented&&t.target instanceof HTMLElement){var i=this._grid,n=this._col,s=t.target,r=i.hitTest(s);if(n&&r&&r.getColumn()==n){if(s instanceof HTMLInputElement&&e.hasClass(s,o)){var l=void 0,c=r.panel.rows,a=c[r.range.topRow];if(c==i.columnHeaders.rows){l=new e.grid.CellRange(0,0,i.rows.length-1,0);if(this._isBound){var h=i.selection;h.col=h.col2=n.index;i.select(h)}}else l=this._isGroupRow(a)?a.getCellRange():r.range;if(l.isValid){this._setRangeChecked(s.checked,l);this.onItemChecked()}i.invalidate();t.preventDefault();return}if(e.hasClass(s,"wj-cell")&&i.bigCheckboxes&&this._isBound&&(this._isFixedCol||this._isGroupRow(r.getRow()))){var d=s.querySelector("input."+o);if(d instanceof HTMLInputElement){d.click();t.preventDefault()}}}}};Selector.prototype._mousedown=function(t){var o=this._grid,i=this._col,n=o.editableCollectionView;if(this._isBound&&i&&n&&n.currentEditItem){var s=o.hitTest(t);if(s.getColumn()==i&&this._isGroupRow(s.getRow())){var r=e.closestClass(t.target,"wj-column-selector-group");r instanceof HTMLInputElement&&r.click()}}};Selector.prototype._isGroupRow=function(t){return t instanceof e.grid.GroupRow&&(!this._grid.childItemsPath||t.getCellRange().rowSpan>1)};Selector.prototype._getRowChecked=function(e,t){void 0===t&&(t=e);for(var o=0,i=0,n=this._col._binding,s=e;s<=t&&(!o||!i);s++){var r=this._grid.rows[s],l=r.dataItem;l&&!this._isGroupRow(r)&&((this._isBound?n.getValue(l):r.isSelected)?o++:i++)}return!(!o||i)||!(i&&!o)&&null};Selector.prototype._setRangeChecked=function(e,t){var o=this,i=this._grid,n=i.rows,s=this._col,r=s?s._binding:null,l=i.selection,c=this._isBound?i.editableCollectionView:null;if(!this._isBound||!i.isReadOnly&&c&&r){c&&c.beginUpdate();i.deferUpdate((function(){for(var s=t.bottomRow;s>=t.topRow;s--){var l=n[s],a=l.dataItem;if(a)if(o._isGroupRow(l))i.childItemsPath&&!o._isBound&&(l.isSelected=e);else if(o._isBound){c&&c.editItem(a);r.setValue(a,e)}else l.isSelected=e}}));if(c){c.commitEdit();c.endUpdate();i.selection=l}}};Selector.prototype._formatItem=function(t,i){var n=i.getColumn(),s=t.editRange;if(n&&n==this._col&&(!s||!s.contains(i.row,i.col))&&i.panel.rows!=t.columnFooters.rows){var r=i.getRow(),l=i.cell,c="",a=void 0;if(i.panel.rows==t.columnHeaders.rows){if(this._showCheckAll&&i.range.bottomRow==i.panel.rows.length-1){a=this._getRowChecked(0,t.rows.length-1);c=o+" wj-column-selector-group"}}else if(this._isGroupRow(r)){var h=r.getCellRange();a=this._getRowChecked(h.row,h.row2);c=o+" wj-column-selector-group"}else if(r.dataItem&&!this._isBound){a=this._getRowChecked(i.row);c=o}if(c){if(this._isFixedCol||this._isBound&&this._isGroupRow(r)){var d=l.querySelector("."+e.grid.CellFactory._WJC_COLLAPSE);l.textContent="";d&&l.appendChild(d)}var u=e.createElement('<label><input type="checkbox" class="'+c+'" tabindex="-1"><span></span></label>'),_=u.querySelector("input");e.setChecked(_,a);if(this._isBound&&(n.isReadOnly||t.selectionMode==e.grid.SelectionMode.None)){_.disabled=!0;_.style.cursor="default"}l.insertBefore(u,l.firstChild)}}};Selector.prototype._getColumn=function(t){if(t instanceof e.grid.FlexGrid){var o=t,i=o.rowHeaders.columns;t=o.headersVisibility&e.grid.HeadersVisibility.Row&&i.length?i[0]:o.columns[0]}this._grid&&(e.isString(t)||e.isNumber(t))&&(t=this._grid.getColumn(t));return t instanceof e.grid.Column?t:null};return Selector}();t.Selector=i;var n=function(t){__extends(BooleanChecker,t);function BooleanChecker(e,o){return t.call(this,e,o)||this}BooleanChecker.prototype.onColumnChanged=function(o){var i=this.column;e.assert(!i||i.dataType==e.DataType.Boolean,"BooleanChecker should be bound to boolean columns");t.prototype.onColumnChanged.call(this,o)};BooleanChecker.prototype._initialize=function(){this._isBound=!0};return BooleanChecker}(i);t.BooleanChecker=n})((t=e.grid||(e.grid={})).selector||(t.selector={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.selector||(t.selector={}),e._registerModule("wijmo.grid.selector",e.grid.selector)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));