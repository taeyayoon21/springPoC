/*!
    *
    * Wijmo Library 5.20202.724
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,l){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var t in l)l.hasOwnProperty(t)&&(e[t]=l[t])})(e,l)};return function(e,l){extendStatics(e,l);function __(){this.constructor=e}e.prototype=null===l?Object.create(l):(__.prototype=l.prototype,new __)}}();!function(e){!function(l){!function(l){l.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};l.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};l.softTransposed=function softTransposed(){return e._getModule("wijmo.grid.transposed")};l.softTransposedMultiRow=function softTransposedMultiRow(){return e._getModule("wijmo.grid.transposedmultirow")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var l;(function(l){"use strict";var t=function(){function FlexGridXlsxConverter(){}FlexGridXlsxConverter.save=function(l,t,o){var r=new e.xlsx.Workbook;this._saveFlexGridToWorkbook(r,l,t,!1,null);o&&r.save(o);return r};FlexGridXlsxConverter.saveAsync=function(l,t,o,r,n,s,i){var a=this,u=new e.xlsx.Workbook;if(!i){this._saveFlexGridToWorkbook(u,l,t,!1,null);o?u.saveAsync(o,(function(l){e.isFunction(r)&&r(l,u)}),n,null):e.isFunction(r)&&r(null,u);return u}var d=null!=o;this.cancelAsync((function(){var i,c=[l.collectionView&&l.collectionView.collectionChanged,l.columns&&l.columns.collectionChanged,l.rows&&l.rows.collectionChanged,l.resizedColumn,l.resizedRow],removeHandlers=function(){return c.forEach((function(e){e&&e.removeHandler(restart)}))},restart=function(){a._cs&&a._cs.cancel(!1);clearTimeout(i);i=setTimeout((function(){removeHandlers();u=null;a.saveAsync(l,t,o,r,n,s)}),100)},finish=function(){clearTimeout(i);a._cs=null;removeHandlers()};a._cs=new e.xlsx._SyncPromise(null,finish);c.forEach((function(e){e&&e.addHandler(restart)}));a._saveFlexGridToWorkbook(u,l,t,!0,a._cs,(function(l){e.isFunction(s)&&s(d?Math.round(e.xlsx._map(l,0,100,0,50)):l)})).then((function(){if(o){u._externalCancellation=function(){return a._cs};u.saveAsync(o,(function(l){finish();e.isFunction(r)&&r(l,u)}),(function(l){finish();e.isFunction(n)&&n(l)}),(function(l){e.isFunction(s)&&s(Math.round(e.xlsx._map(l,0,100,51,100)))}))}else{finish();e.isFunction(s)&&s(100);e.isFunction(r)&&r(null,u)}}),(function(e){finish();throw e}))}));return null};FlexGridXlsxConverter.cancelAsync=function(l){var t=this;if(this._cs){this._cs.cancel();setTimeout((function(){t._cs=null;e.isFunction(l)&&l()}),100)}else e.isFunction(l)&&l()};FlexGridXlsxConverter.load=function(l,t,o){var r=this;if(t instanceof Blob){var n=new FileReader;n.onload=function(){var t=e.xlsx.Workbook._base64EncArr(new Uint8Array(n.result)),s=new e.xlsx.Workbook;s.load(t);t=null;l.deferUpdate((function(){r._loadToFlexGrid(l,s,o);s=null}))};n.readAsArrayBuffer(t)}else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){r._loadToFlexGrid(l,t,o);t=null}));else{if(t instanceof ArrayBuffer)t=e.xlsx.Workbook._base64EncArr(new Uint8Array(t));else if(!e.isString(t))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.load(t);t=null;l.deferUpdate((function(){r._loadToFlexGrid(l,s,o);s=null}))}};FlexGridXlsxConverter.loadAsync=function(l,t,o,r,n){var s=this;if(t instanceof Blob){var i=new FileReader;i.onload=function(){var t=e.xlsx.Workbook._base64EncArr(new Uint8Array(i.result)),a=new e.xlsx.Workbook;a.loadAsync(t,(function(e){t=null;a=null;l.deferUpdate((function(){s._loadToFlexGrid(l,e,o);r&&r(e);e=null}))}),n)};i.readAsArrayBuffer(t)}else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){s._loadToFlexGrid(l,t,o);r&&r(t);t=null}));else{if(t instanceof ArrayBuffer)t=e.xlsx.Workbook._base64EncArr(new Uint8Array(t));else if(!e.isString(t))throw"Invalid workbook.";(new e.xlsx.Workbook).loadAsync(t,(function(e){t=null;l.deferUpdate((function(){s._loadToFlexGrid(l,e,o);r&&r(e);e=null}))}),n)}};FlexGridXlsxConverter._saveFlexGridToWorkbook=function(l,t,r,s,i,a){var u,d=this,c=new e.xlsx._SyncPromise(i),f=new e.xlsx.WorkSheet,x=!r||null==r.includeColumnHeaders||r.includeColumnHeaders,h=!(!r||null==r.includeRowHeaders)&&r.includeRowHeaders,p=o.Cache,g=r?r.includeColumns:null,m=r?r.formatItem:null,w=0,v=h?t.rowHeaders.columns.length:0,y=[];r&&(p=!1===e.asBoolean(r.includeCellStyles,!0)?o.None:!1===e.asBoolean(r.quickCellStyles,!0)?o.Regular:o.Cache);var _=p===o.Cache?new n(500):null;null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style);var C,b=t.wj_sheetInfo;f.name=r?r.sheetName:"";f.visible=!r||!1!==r.sheetVisible;if(b&&b.tables&&b.tables.length>0)for(var T=0;T<b.tables.length;T++)f.tables.push(b.tables[T]);u=[];if(!b&&(p!==o.None||m)){(C=document.createElement("div")).style.visibility="hidden";C.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true");t.hostElement.appendChild(C)}(h?[t.rowHeaders,t.columnHeaders]:[t.columnHeaders]).forEach((function(l){for(var o=l.rows,r=l.columns,n=0,s=l.cellType===e.grid.CellType.ColumnHeader?v:0,i=0;i<o.length;i++)if(!(o[i].renderSize<=0)){u[n]||(u[n]=[]);for(var a=0,c=0;a<r.length;a++){var h=t._getBindingColumn(l,i,r[a]),p=d._getColumnSetting(h,a,r);if(p){u[n][s+a]=p;if(0===n){if(l.cellType===e.grid.CellType.ColumnHeader&&g&&!g(h))continue;var m=new e.xlsx.WorkbookColumn;m._deserialize(p);f._addWorkbookColumn(m,s+c++)}}}n++}l.cellType===e.grid.CellType.ColumnHeader&&(w=x?n:0)}));var k=[[t.topLeftCells,t.columnHeaders],[t.rowHeaders,t.cells],[t.bottomLeftCells,t.columnFooters]];x||k.shift();var S=k.map((function(e){return e[1].rows.length})).reduce((function(e,l){return e+l}));this._saveContentToWorksheet(i,s,Date.now(),0,{panels:k,panelIdx:0,globRowIdx:0,rowsOffset:0,totalRows:S},t,f,h,u,p,C,y,_,g,m,(function(e){a(Math.round(e/S*100))}),(function(){var n=new e.xlsx.WorkbookFrozenPane;n.rows=x?t.frozenRows+w:t.frozenRows;n.columns=h?t.frozenColumns+v:t.frozenColumns;f.frozenPane=n;l._addWorkSheet(f);if(!b&&(p!==o.None||m)){t.hostElement.removeChild(C);y.forEach((function(e){return e.forEach((function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}))}))}_&&_.clear();l.activeWorksheet=r?r.activeWorksheet:null;c.resolve()}));return c};FlexGridXlsxConverter._saveContentToWorksheet=function(l,t,o,r,n,s,i,a,u,d,c,f,x,h,p,g,m){for(var w=this,v=d?20:200,_loop_1=function(_){if(l&&l.cancelled)return{value:void 0};if(t&&_-r>v&&Date.now()-o>100){setTimeout((function(){if(!l||!l.cancelled){g(_);w._saveContentToWorksheet(l,t,Date.now(),_,n,s,i,a,u,d,c,f,x,h,p,g,m)}}),0);return{value:void 0}}for(;_-n.rowsOffset>=n.panels[n.panelIdx][1].rows.length;){n.rowsOffset+=n.panels[n.panelIdx][1].rows.length;n.panelIdx++}var C=n.panels[n.panelIdx],b=C[0],T=C[1],k=_-n.rowsOffset,S=T.rows[k];if(T.cellType!==e.grid.CellType.Cell&&S.renderSize<=0||S instanceof e.grid._NewRowTemplate)return"continue";var F=0,R={},W=new e.xlsx.WorkbookRow,A=S instanceof e.grid.GroupRow,G=0;T.cellType===e.grid.CellType.Cell&&(A?G=S.level:s.rows.maxGroupLevel>-1&&(G=s.rows.maxGroupLevel+1));a&&(F=y._parseFlexGridRowToSheetRow(b,R,k,0,u,d,c,f,x,A,G,h,p));y._parseFlexGridRowToSheetRow(T,R,k,F,u,d,c,f,x,A,G,h,p);if(R.cells.length>0){W._deserialize(R);i._addWorkbookRow(W,n.globRowIdx)}n.globRowIdx++},y=this,_=r;_<n.totalRows;_++){var C=_loop_1(_);if("object"==typeof C)return C.value}e.isFunction(m)&&m()};FlexGridXlsxConverter._loadToFlexGrid=function(t,o,r){if(l.softTransposedMultiRow()&&t instanceof l.softTransposedMultiRow().TransposedMultiRow)throw"Not supported.";r=r||{};var n,s=null!=t.wj_sheetInfo,i={},a=[],u=[],d={};t.itemsSource=null;t.columns.clear();t.columnHeaders.rows.clear();t.rowHeaders.columns.clear();t.rows.clear();t.frozenColumns=0;t.frozenRows=0;var c=null==r.sheetIndex||isNaN(r.sheetIndex)?0:r.sheetIndex;if(c<0||c>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=r.sheetName)for(var f=0;f<o.sheets.length;f++)if(r.sheetName===o.sheets[f].name){n=o.sheets[f];break}if(null!=(n=n||o.sheets[c]).rows){for(var x=this._getColumnCount(n.rows),h=this._getRowCount(n.rows,x),p=n.columns,g=0;g<x;g++){t.columns.push(new e.grid.Column);if(p[g]){isNaN(+p[g].width)||(t.columns[g].width=+p[g].width);p[g].visible||null==p[g].visible||(t.columns[g].visible=!!p[g].visible);p[g].style&&p[g].style.wordWrap&&(t.columns[g].wordWrap=p[g].style.wordWrap)}}var m,w=(null==r.includeColumnHeaders||r.includeColumnHeaders)&&n.rows.length>0,v=w?this._getColumnHeadersHeight(n):0,y=!1,_=[],C=n.frozenPane&&n.frozenPane.rows,b=n.frozenPane&&n.frozenPane.columns;C=e.isNumber(C)&&!isNaN(C)?C:null;b=e.isNumber(b)&&!isNaN(b)?b:null;for(var T=v;T<h;T++){var k=!1,S=null,F=n.rows[T];if(F)for(var R=T+1;R<n.rows.length;){var W=n.rows[R];if(W){(isNaN(F.groupLevel)&&!isNaN(W.groupLevel)||!isNaN(F.groupLevel)&&F.groupLevel<W.groupLevel)&&(k=!0);break}R++}if(k&&!n.summaryBelow){m&&(m.isCollapsed=y);(m=new e.grid.GroupRow).isReadOnly=!1;y=null!=F.collapsed&&F.collapsed;m.level=isNaN(F.groupLevel)?0:F.groupLevel;d[m.level]=y;this._checkParentCollapsed(d,m.level)&&m._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(m)}else{var A=new e.grid.Row;F&&this._checkParentCollapsed(d,F.groupLevel)&&A._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(A)}F&&F.height&&!isNaN(F.height)&&(t.rows[T-v].height=F.height);for(g=0;g<x;g++)if(F){var G=F.cells[g],N=G?G.formula:null;N&&"="!==N[0]&&(N="="+N);if(G&&G.textRuns&&G.textRuns.length>0){t.rows[T-v].isContentHtml=!0;t.setCellData(T-v,g,this._parseTextRunsToHTML(G.textRuns))}else t.setCellData(T-v,g,N&&s?N:this._getItemValue(G));k||this._setColumn(_,g,G);var D=T*x+g,E=G?G.style:null,B=e.xlsx.Workbook._parseExcelFormat(G),H=void 0;if(E){S=null==S?!!E.wordWrap:S&&!!E.wordWrap;if(E.hAlign)H=e.xlsx.Workbook._parseHAlignToString(e.asEnum(E.hAlign,e.xlsx.HAlign));else switch(this._getItemType(G)){case e.DataType.Number:H="right";break;case e.DataType.Boolean:H="center";break;default:H=B&&0===B.search(/[n,c,p]/i)?"right":"left"}i[D]={fontWeight:E.font&&E.font.bold?"bold":"none",fontStyle:E.font&&E.font.italic?"italic":"none",textDecoration:E.font&&E.font.underline?"underline":"none",textAlign:H,fontFamily:E.font&&E.font.family?E.font.family:"",fontSize:E.font&&E.font.size?E.font.size+"px":"",color:E.font&&E.font.color?E.font.color:"",backgroundColor:E.fill&&E.fill.color?E.fill.color:"",whiteSpace:E.wordWrap?"pre-wrap":"normal",format:B};if(E.borders){if(E.borders.left){this._parseBorderStyle(E.borders.left.style,"Left",i[D]);i[D].borderLeftColor=E.borders.left.color}if(E.borders.right){this._parseBorderStyle(E.borders.right.style,"Right",i[D]);i[D].borderRightColor=E.borders.right.color}if(E.borders.top){this._parseBorderStyle(E.borders.top.style,"Top",i[D]);i[D].borderTopColor=E.borders.top.color}if(E.borders.bottom){this._parseBorderStyle(E.borders.bottom.style,"Bottom",i[D]);i[D].borderBottomColor=E.borders.bottom.color}}if(E.fill&&E.fill.color){var I=i[D],X=E.borders,M=E.fill.color;if(X){X.left&&X.left.color||(I.borderLeftColor=M);X.right&&X.right.color||g===b-1||(I.borderRightColor=M);X.top&&X.top.color||(I.borderTopColor=M);X.bottom&&X.bottom.color||T===C-1||(I.borderBottomColor=M)}else{I.borderLeftColor=M;g!==b-1&&(I.borderRightColor=M);I.borderTopColor=M;T!==C-1&&(I.borderBottomColor=M)}}E.font&&-1===u.indexOf(E.font.family)&&u.push(E.font.family)}G&&e.isNumber(G.rowSpan)&&G.rowSpan>0&&e.isNumber(G.colSpan)&&G.colSpan>0&&(G.rowSpan>1||G.colSpan>1)&&a.push(new e.grid.CellRange(T,g,T+G.rowSpan-1,g+G.colSpan-1))}if(F){this._checkParentCollapsed(d,F.groupLevel)||F.visible||null==F.visible||(t.rows[T-v].visible=F.visible);t.rows[T-v].wordWrap=!!F.style&&!!F.style.wordWrap||!!S}}m&&(m.isCollapsed=y);null!=b&&(t.frozenColumns=b);null!=C&&(t.frozenRows=w&&C>0?C-1:C);for(g=0;g<t.columnHeaders.columns.length;g++){var z=_[g],O=t.columns[g];O.isRequired=!1;if(z){z.dataType===e.DataType.Boolean&&(O.dataType=z.dataType);O.format=z.format;O.align=z.hAlign;O.wordWrap=O.wordWrap||!!z.wordWrap}}for(f=0;f<Math.max(v,1);f++)t.columnHeaders.rows.push(new e.grid.Row);var j=Object.keys(n.rows);for(f=0;f<v;f++)for(var L=0;L<t.columnHeaders.columns.length;L++){var P=n.rows[j[f]].cells[L],V=P&&P.value||"",U=t.columnHeaders.columns[L];if(V){var q=e.xlsx.Workbook._parseExcelFormat(P);V=e.Globalize.format(V,q)}U.header=U.header||V;t.columnHeaders.setCellData(f,L,V)}if(s){var J=null==r.sheetVisible||r.sheetVisible;t.wj_sheetInfo.name=n.name;t.wj_sheetInfo.visible=!0===J||!1!==n.visible;t.wj_sheetInfo.styledCells=i;t.wj_sheetInfo.mergedRanges=a;t.wj_sheetInfo.fonts=u;t.wj_sheetInfo.tables=n.tables}}};FlexGridXlsxConverter._getColumnHeadersHeight=function(e){if(!e&&!e.rows.length)return 0;for(var l=1,t=0;t<e.rows.length;t++){var o=e.rows[t];if(o){o.cells.forEach((function(e){l=Math.max(l,e.rowSpan||0)}));break}}return l};FlexGridXlsxConverter._escapePlainText=function(e){return null==e?"":""===e?"'":e&&("'"===e[0]||e.length>1&&"="===e[0]&&"="===e[1])?"'"+e:e};FlexGridXlsxConverter._parseFlexGridRowToSheetRow=function(t,n,s,i,a,u,d,c,f,x,h,p,g){var m,w,v,y,_,C,b,T,k,S,F,R,W,A,G,N,D,E,B,H,I,X,M,z,O,j,L,P,V,U,q=!1,J=!1;(B=(m=t.grid).wj_sheetInfo)&&(H=B.evaluateFormula);if(null==(w=t.rows[s]).recordIndex){z=0;t.cellType===e.grid.CellType.ColumnHeader&&t.rows.length>1&&(z=s===a.length?s-1:s)}else z=w.recordIndex;n.cells||(n.cells=[]);n.visible=w.isVisible;n.height=w.renderHeight||t.rows.defaultSize;n.groupLevel=h;x&&(n.collapsed=w.isCollapsed);w.wordWrap&&(n.style={wordWrap:w.wordWrap});(w.constructor===e.grid.Row||w.constructor===e.grid._NewRowTemplate||l.softTransposed()&&m instanceof l.softTransposed().TransposedGrid&&w instanceof e.grid.Row||l.softDetail()&&w.constructor===l.softDetail().DetailRow||l.softMultiRow()&&w.constructor===l.softMultiRow()._MultiRow||l.softTransposedMultiRow()&&w instanceof l.softTransposedMultiRow()._MultiRow)&&(q=!0);l.softDetail()&&w.constructor===l.softDetail().DetailRow&&(J=!0);for(y=0;y<t.columns.length;y++){_=null;E=1;D=1;V=0;M=!1;G=null;j=null;T=null;X=m._getBindingColumn(t,s,t.columns[y]);N=null;if(B&&t===m.cells){A=s*t.columns.length+y;B.mergedRanges&&(N=this._getMergedRange(s,y,B.mergedRanges));B.styledCells&&(G=B.styledCells[A])}else if(u!==o.None){j=this._getMeasureCell(t,y,d,c);G=(N=m.getMergedRange(t,s,y,!1))?this._getCellStyle(t,j,N.bottomRow,N.rightCol,f)||{}:this._getCellStyle(t,j,s,y,f)||{}}N||(N=m.getMergedRange(t,s,y,!1));if(N){if(s===N.topRow&&y===N.leftCol){D=N.bottomRow-N.topRow+1;E=this._getColSpan(t,N,p);M=!0}}else M=!0;if(!p||p(X)){v=a[z]?a[z][y+i]:null;if(q||x){b=M?t.getCellData(s,y,!0):null;k=M?t.getCellData(s,y,!1):null;F=this._isFormula(b);W=null;I=e.isDate(k);if(G&&G.format){_=G.format;/[hsmyt\:]/i.test(_)&&(I=!0);C=e.xlsx.Workbook._parseCellFormat(G.format,I)}else if(v&&v.style&&v.style.format){_=X.format;C=v.style.format}else C=null;F&&null!=H&&e.isFunction(H)&&(W=H(b));if(!C)if(I)C="m/d/yyyy";else if(e.isNumber(k)&&!X.dataMap)C=e.isInt(k)?"#,##0":"#,##0.00";else if(F){if((R=b.toLowerCase()).indexOf("now()")>-1){C="m/d/yyyy h:mm";I=!0}else if(R.indexOf("today()")>-1||R.indexOf("date(")>-1){C="m/d/yyyy";I=!0}else if(R.indexOf("time(")>-1){C="h:mm AM/PM";I=!0}}else C="General"}else{b=M?m.columnHeaders.getCellData(0,y,!0):null;C="General"}if(e.isString(b)&&-1!==b.indexOf("<span")){T=this._parseToTextRuns(b);b=null}L=this._parseCellStyle(G)||{};if(t===m.cells&&x&&w.hasChildren&&y===m.columns.firstVisibleIndex){F&&null!=W?S=W:b?S=b:M&&(S=w.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'"));if(null==S&&!G)continue;!(I=e.isDate(S))&&_&&"d"===_.toLowerCase()&&e.isInt(S)&&(C="0");S=e.isString(S)?e.xlsx.Workbook._unescapeXML(S):S;y===m.columns.firstVisibleIndex&&m.treeIndent&&(V=h);O={value:S,isDate:I,formula:F?this._parseToExcelFormula(b,I):null,colSpan:E,rowSpan:D,style:this._extend(L,{format:C,font:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:V}),textRuns:T}}else{b=e.isString(b)?e.xlsx.Workbook._unescapeXML(b):b;k=e.isString(k)?e.xlsx.Workbook._unescapeXML(k):k;!I&&_&&"d"===_.toLowerCase()&&e.isInt(k)&&(C="0");P=L&&L.hAlign?L.hAlign:v&&v.style&&null!=v.style.hAlign?e.asEnum(v.style.hAlign,e.xlsx.HAlign,!0):e.isDate(k)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General;y!==m.columns.firstVisibleIndex||!m.treeIndent||P!==e.xlsx.HAlign.Left&&P!==e.xlsx.HAlign.General||(V=h);O={value:F?W:"General"!==C||""===b&&null==k?this._escapePlainText(k):this._escapePlainText(b),isDate:I,formula:F?this._parseToExcelFormula(b,I):null,colSpan:y<m.columns.firstVisibleIndex?1:E,rowSpan:D,style:this._extend(L,{format:C,hAlign:P,vAlign:D>1?t===m.cells||!1===m.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:V}),textRuns:T};J&&(U=t.getCellElement(s,y))&&U.appendChild(w.detail)}g&&g(new r(t,new e.grid.CellRange(s,y),j,d,c,f,O));n.cells.push(O)}}return i+y};FlexGridXlsxConverter._parseCellStyle=function(l,t){void 0===t&&(t=!1);if(null==l)return null;var o=l.fontSize;o=o?+o.substring(0,o.indexOf("px")):null;isNaN(o)&&(o=null);var r=l.fontWeight;r="bold"===r||+r>=700;var n="italic"===l.fontStyle,s=l.textDecorationStyle;null==s&&(s=l.textDecoration);s="underline"===s;var i=l.whiteSpace;i=!!i&&i.indexOf("pre")>-1;return{font:{bold:r,italic:n,underline:s,family:this._parseToExcelFontFamily(l.fontFamily),size:o,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,t),hAlign:e.xlsx.Workbook._parseStringToHAlign(l.textAlign),wordWrap:i}};FlexGridXlsxConverter._parseBorder=function(e,l){var t={};t.left=this._parseEgdeBorder(e,"Left");t.right=this._parseEgdeBorder(e,"Right");t.top=this._parseEgdeBorder(e,"Top");t.bottom=this._parseEgdeBorder(e,"Bottom");if(l){t.vertical=this._parseEgdeBorder(e,"Vertical");t.horizontal=this._parseEgdeBorder(e,"Horizontal")}return t};FlexGridXlsxConverter._parseEgdeBorder=function(l,t){var o,r=l["border"+t+"Style"],n=l["border"+t+"Width"];n&&(n=parseFloat(n));if(r&&"none"!==r&&"hidden"!==r&&0!==n){o={};switch(r=r.toLowerCase()){case"dotted":o.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":o.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":o.style=e.xlsx.BorderStyle.Double;break;default:o.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}o.color=l["border"+t+"Color"]}return o};FlexGridXlsxConverter._parseBorderStyle=function(l,t,o){var r="border"+t+"Style",n="border"+t+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:o[r]="dotted";o[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:o[r]="dashed";o[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:o[r]="dashed";o[n]="2px";break;case e.xlsx.BorderStyle.Double:o[r]="double";o[n]="3px";break;case e.xlsx.BorderStyle.Medium:o[r]="solid";o[n]="2px";break;case e.xlsx.BorderStyle.Thick:o[r]="solid";o[n]="3px";break;default:o[r]="solid";o[n]="1px"}};FlexGridXlsxConverter._parseToExcelFontFamily=function(e){var l;e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,""));return e};FlexGridXlsxConverter._parseToExcelFormula=function(l,t){var o,r,n,s,i,a,u,d=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(o=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi))for(i=0;i<o.length;i++){u=(a=o[i]).substring(0,a.lastIndexOf(")"))+", 1)";l=l.replace(a,u)}o=null;if(o=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi))for(i=0;i<o.length;i++)if((r=(a=o[i]).match(d))&&2===r.length){n=r[1];if(!/^d{1,4}?$/.test(n)){s=e.xlsx.Workbook._parseCellFormat(n,t);u=a.replace(n,s);l=l.replace(a,u)}}return l};FlexGridXlsxConverter._parseToTextRuns=function(e){var l,t,o,r=e.split("<span "),n=[];for(l=0;l<r.length;l++){o=-1!==(t=r[l]).indexOf("</span>")?{text:t.substring(t.indexOf(">")+1,t.indexOf("</span>")),font:this._parseToTextRunFont(t.substring(t.indexOf('style="')+7,t.indexOf(';"')))}:{text:t};n.push(o)}return n};FlexGridXlsxConverter._parseToTextRunFont=function(e){var l,t,o,r,n,s,i,a,u,d=e.split(";");if(d.length>0){for(l=0;l<d.length;l++)if(2===(t=d[l].split(":")).length){t[1]=t[1].trim();switch(t[0]){case"font-size":s=+t[1].substring(0,t[1].indexOf("px"));isNaN(s)&&(s=null);break;case"font-weight":o="bold"===t[1]||+t[1]>=700;break;case"font-style":r="italic"===t[1];break;case"text-decoration-style":case"text-decoration":n="underline"===t[1];break;case"font-family":i=this._parseToExcelFontFamily(t[1]);break;case"color":a=t[1]}}u={bold:o,italic:r,underline:n,family:i,size:s,color:a}}return u};FlexGridXlsxConverter._getMeasureCell=function(e,l,t,o){var r=o[e.cellType],n=r&&r[l],s=null==n;if(n){if(this.hasCssText){n.style;n.style.cssText="";n.style.visibility="hidden"}}else{r||(o[e.cellType]=r=[]);r[l]=n=t.cloneNode()}!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n));return n};FlexGridXlsxConverter._getColumnSetting=function(l,t,o){var r=l;null!=l.colspan&&(r=this._getRenderColumn(t,o));return r?{autoWidth:!0,width:r.renderWidth||o.defaultSize,visible:r.visible,style:{format:r.format?e.xlsx.Workbook._parseCellFormat(r.format,r.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(r.getAlignment())),wordWrap:r.wordWrap}}:null};FlexGridXlsxConverter._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e};FlexGridXlsxConverter._getColumnCount=function(l){for(var t,o=0,r=0,n=0;n<l.length;n++)if((t=l[n]&&l[n].cells?l[n].cells:[])&&t.length>0){r=t.length;e.isInt(t[r-1].colSpan)&&t[r-1].colSpan>1&&(r=r+t[r-1].colSpan-1);r>o&&(o=r)}return o};FlexGridXlsxConverter._getRowCount=function(l,t){for(var o,r,n=l.length,s=n-1,i=0;i<t;i++)e:for(;s>=0;s--)if((r=((o=l[s])&&o.cells?o.cells:[])[i])&&(null!=r.value&&""!==r.value||e.isInt(r.rowSpan)&&r.rowSpan>1)){e.isInt(r.rowSpan)&&r.rowSpan>1&&s+r.rowSpan>n&&(n=s+r.rowSpan);break e}return n};FlexGridXlsxConverter._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)};FlexGridXlsxConverter._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)};FlexGridXlsxConverter._setColumn=function(l,t,o){var r,n,s,i=l[t];if(i){r=this._getItemType(o);i.dataType!==r&&i.dataType===e.DataType.Boolean&&r!==e.DataType.Boolean&&(i.dataType=r);!o||null==o.value||e.isString(o.value)&&e.isNullOrWhiteSpace(o.value)||(n=e.xlsx.Workbook._parseExcelFormat(o))&&i.format!==n&&"General"!==n&&(i.format=n);if(o&&o.style){o.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(o.style.hAlign,e.xlsx.HAlign)));null==i.wordWrap?i.wordWrap=!!o.style.wordWrap:i.wordWrap=i.wordWrap&&!!o.style.wordWrap}s||r!==e.DataType.Number||(s="right");i.hAlign=s}else l[t]={dataType:this._getItemType(o),format:e.xlsx.Workbook._parseExcelFormat(o),hAlign:"",wordWrap:null}};FlexGridXlsxConverter._getItemValue=function(l){if(null==l||null==l.value)return null;var t=l.value;e.isString(t)&&"'"===t[0]&&(t=t.substr(1));return e.isNumber(t)&&isNaN(t)?"":t instanceof Date&&isNaN(t.getTime())?"":t};FlexGridXlsxConverter._getCellStyle=function(e,l,t,o,r){var n,s=e.grid;try{var i=!(r&&!s.formatItem.hasHandlers&&!s.itemFormatter);s.cellFactory.updateCell(e,t,o,l,null,i);l.className=l.className.replace("wj-state-selected","");l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}if(r){var a,u=e.hostElement,d=l;a=d.style.cssText.split(/;\s+/).filter((function(e){var l=e.substring(0,e.indexOf(":"));return/^(color|background|border|font|text|whitespace)/i.test(l)})).join(";");do{a=d.className+a}while(d!==u&&(d=d.parentElement));if(!(n=r.getValue(a))){n=window.getComputedStyle(l);r.add(a,n)}}else n=window.getComputedStyle(l);return n};FlexGridXlsxConverter._parseTextRunsToHTML=function(e){var l,t,o,r;o="";for(r=0;r<e.length;r++)o+=(t=(l=e[r]).font)?'<span style="'+(t.bold?"font-weight: bold;":"")+(t.italic?"font-style: italic;":"")+(t.underline?"text-decoration: underline;":"")+(t.family?"font-family: "+t.family+";":"")+(null!=t.size?"font-size: "+t.size+"px;":"")+(t.color?"color: "+t.color+";":"")+'">'+l.text+"</span>":l.text;return o};FlexGridXlsxConverter._extend=function(l,t){for(var o in t){var r=t[o];e.isObject(r)&&l[o]?e.copy(l[o],r):l[o]=r}return l};FlexGridXlsxConverter._checkParentCollapsed=function(e,l){var t=!1;Object.keys(e).forEach((function(o){!0===e[o]&&!1===t&&!isNaN(l)&&+o<l&&(t=!0)}));return t};FlexGridXlsxConverter._getColSpan=function(e,l,t){for(var o=0,r=l.leftCol;r<=l.rightCol;r++)t&&!t(e.columns[r])||o++;return o};FlexGridXlsxConverter._getRenderColumn=function(e,l){return e>=l.length?null:l[e]};FlexGridXlsxConverter._getMergedRange=function(e,l,t){var o,r;for(o=0;o<t.length;o++)if(e>=(r=t[o]).topRow&&e<=r.bottomRow&&l>=r.leftCol&&l<=r.rightCol)return r;return null};FlexGridXlsxConverter._isFormula=function(e){return e&&"string"==typeof e&&e.length>1&&"="===e[0]&&"="!==e[1]};return FlexGridXlsxConverter}();l.FlexGridXlsxConverter=t;var o,r=function(e){__extends(XlsxFormatItemEventArgs,e);function XlsxFormatItemEventArgs(l,t,o,r,n,s,i){var a=e.call(this,l,t)||this;a._cell=o;a._patternCell=r;a._xlsxCell=i;a._cellsCache=n;a._styleCache=s;return a}Object.defineProperty(XlsxFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(XlsxFormatItemEventArgs.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0});XlsxFormatItemEventArgs.prototype.getFormattedCell=function(){if(!this._cell){this._cell=t._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache);t._getCellStyle(this.panel,this._cell,this.row,this.col,this._styleCache)}return this._cell};return XlsxFormatItemEventArgs}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=r;!function(e){e[e.None=0]="None";e[e.Regular=1]="Regular";e[e.Cache=2]="Cache"}(o||(o={}));var n=function(){function _StyleCache(e){this._cache={};this._size=0;this._max=e}_StyleCache.prototype.add=function(e,l){this._size>=this._max&&this.clear();this._cache[e]=this._cloneStyle(l);this._size++};_StyleCache.prototype.clear=function(){this._cache={};this._size=0};_StyleCache.prototype.getValue=function(e){return this._cache[e]||null};_StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};_StyleCache.prototype._cloneStyle=function(e){if(!e)return null;for(var l={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,l,t){return t>0?l.toUpperCase():l}))},t=0,o=e.length;t<o;t++){var r=e[t];l[toCamel(r)]=e.getPropertyValue(r)}return l};return _StyleCache}();l._StyleCache=n})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={}));!function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));