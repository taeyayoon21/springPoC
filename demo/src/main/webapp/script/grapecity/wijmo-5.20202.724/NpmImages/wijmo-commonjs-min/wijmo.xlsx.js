/*!
    *
    * Wijmo Library 5.20202.724
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var wijmo_1=require("wijmo/wijmo"),JSZipRef=require("jszip"),selfModule=require("wijmo/wijmo.xlsx"),Workbook=function(){function Workbook(){this._externalCancellation=null}Object.defineProperty(Workbook.prototype,"sheets",{get:function(){null==this._sheets&&(this._sheets=[]);return this._sheets},enumerable:!0,configurable:!0});Object.defineProperty(Workbook.prototype,"styles",{get:function(){null==this._styles&&(this._styles=[]);return this._styles},enumerable:!0,configurable:!0});Object.defineProperty(Workbook.prototype,"definedNames",{get:function(){null==this._definedNames&&(this._definedNames=[]);return this._definedNames},enumerable:!0,configurable:!0});Object.defineProperty(Workbook.prototype,"colorThemes",{get:function(){null==this._colorThemes&&(this._colorThemes=[]);return this._colorThemes},enumerable:!0,configurable:!0});Object.defineProperty(Workbook.prototype,"reservedContent",{get:function(){null==this._reservedContent&&(this._reservedContent={});return this._reservedContent},set:function(e){this._reservedContent=e},enumerable:!0,configurable:!0});Workbook.prototype.save=function(e){var t=_xlsx.save(this),o=!(!this._reservedContent||!this._reservedContent.macros);e&&Workbook._saveToFile(t.base64,e,o);return t.base64};Workbook.prototype.saveAsync=function(e,t,o,r){var l=this;this.cancelAsync((function(){l._cs=wijmo_1.isFunction(l._externalCancellation)?l._externalCancellation():new _SyncPromise;_xlsx.saveAsync(l,l._cs,o,r).then((function(o){if(e){var i=!(!l._reservedContent||!l._reservedContent.macros);Workbook._saveToFile(o,e,i)}l._cs=null;wijmo_1.isFunction(r)&&r(100);t&&t(o)}),(function(){return l._cs=null}))}))};Workbook.prototype.cancelAsync=function(e){var t=this;if(this._cs){this._cs.cancel();setTimeout((function(){t._cs=null;wijmo_1.isFunction(e)&&e()}),100)}else wijmo_1.isFunction(e)&&e()};Workbook.prototype.load=function(e){var t=_xlsx.load(this._getBase64String(e));this._deserialize(t);t=null};Workbook.prototype.loadAsync=function(e,t,o){var r=this;_xlsx.loadAsync(r._getBase64String(e)).then((function(e){r._deserialize(e);e=null;t(r)})).catch(o)};Workbook.prototype._serialize=function(){var e={sheets:[]};e.sheets=this._serializeWorkSheets();this._styles&&this._styles.length>0&&(e.styles=this._serializeWorkbookStyles());this._reservedContent&&(e.reservedContent=this._reservedContent);null!=this.activeWorksheet&&!isNaN(this.activeWorksheet)&&this.activeWorksheet>=0&&(e.activeWorksheet=this.activeWorksheet);this.application&&(e.application=this.application);this.company&&(e.company=this.company);null!=this.created&&(e.created=this.created);this.creator&&(e.creator=this.creator);this.lastModifiedBy&&(e.lastModifiedBy=this.lastModifiedBy);null!=this.modified&&(e.modified=this.modified);this._definedNames&&this._definedNames.length>0&&(e.definedNames=this._serializeDefinedNames());this._colorThemes&&this._colorThemes.length>0&&(e.colorThemes=this._colorThemes.slice());return e};Workbook.prototype._deserialize=function(e){this._deserializeWorkSheets(e.sheets);e.styles&&e.styles.length>0&&this._deserializeWorkbookStyles(e.styles);this.activeWorksheet=e.activeWorksheet;this.application=e.application;this.company=e.company;this.created=e.created;this.creator=e.creator;this.lastModifiedBy=e.lastModifiedBy;this.modified=e.modified;this.reservedContent=e.reservedContent;e.definedNames&&e.definedNames.length>0&&this._deserializeDefinedNames(e.definedNames);e.colorThemes&&e.colorThemes.length>0&&(this._colorThemes=e.colorThemes.slice())};Workbook.prototype._addWorkSheet=function(e,t){null==this._sheets&&(this._sheets=[]);null==t||isNaN(t)?this._sheets.push(e):this._sheets[t]=e};Workbook._saveToFile=function(e,t,o){var r,l,i,s,n,a,h=window.document,u=o?"xlsm":"xlsx",f="xlsm"===u?"application/vnd.ms-excel.sheet.macroEnabled.12":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if((l=t.lastIndexOf("."))<0)t+="."+u;else{if(0===l)throw"Invalid file name.";""===(r=t.substring(l+1))?t+="."+u:r!==u&&(t+="."+u)}i=new Blob([Workbook._base64DecToArr(e)],{type:f});if(navigator.msSaveBlob)navigator.msSaveBlob(i,t);else if(URL.createObjectURL){n=h.createElement("a");a=function(e){var t=h.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);e.dispatchEvent(t)};n.download=t;n.href=URL.createObjectURL(i);a(n);n=null}else{s=new FileReader;n=h.createElement("a");a=function(e){var t=h.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);e.dispatchEvent(t)};s.onload=function(){n.download=t;n.href=s.result;a(n);n=null};s.readAsDataURL(i)}};Workbook.prototype._getBase64String=function(e){var t;if(null==e||0===e.length)throw"Invalid xlsx file content.";-1!==(t=e.search(/base64,/i))&&(e=e.substring(t+7));return e};Workbook.toXlsxDateFormat=function(e){var t;if(1===e.length)switch(e){case"r":case"R":return"ddd, dd MMM yyyy HH:mm:ss &quot;GMT&quot;";case"u":return"yyyy-MM-dd&quot;T&quot;HH:mm:ss&quot;Z&quot;";case"o":case"O":t=(t=wijmo_1.culture.Globalize.calendar.patterns[e]).replace(/f+k/gi,"000");break;default:t=wijmo_1.culture.Globalize.calendar.patterns[e]}t||(t=e);t=t.replace(/"/g,"").replace(/tt/,"AM/PM").replace(/t/,"A/P").replace(/M+/gi,(function(e){return e.toLowerCase()})).replace(/g+y+/gi,(function(e){return e.substring(0,e.indexOf("y"))+"e"}));return/FY|Q/i.test(t)?"General":t};Workbook.toXlsxNumberFormat=function(e){var t,o,r,l,i,s,n,a=-1,h=e?e.toLowerCase():"",u=[];if(/^[ncpfdg]\d*.*,*$/.test(h)){t=h[0];o=this._formatMap[t]}if(o){l=h.split(",");if("c"===t){"​"===(r=(n=e?e.match(/([a-z])(\d*)(,*)(.*)/i):null)&&n[4]?n[4]:wijmo_1.culture.Globalize.numberFormat.currency.symbol)&&(r="");o=o.replace(/\{1\}/g,r)}h.length>1?a=parseInt(l[0].substr(1)):"d"!==t&&(a=2);if(!isNaN(a))for(s=0;s<a;s++)u.push(0);for(s=0;s<l.length-1;s++)u.push(",");i=u.length>0?"d"===t?o.replace(/\{0\}/g,u.join("")):o.replace(/\{0\}/g,(!isNaN(a)&&a>0?".":"")+u.join("")):"d"===t?o.replace(/\{0\}/g,"0"):o.replace(/\{0\}/g,"")}else i=h;return i};Workbook.fromXlsxFormat=function(e){var t,o,r,l,i,s,n,a,h,u=[],f=wijmo_1.culture.Globalize.numberFormat.currency.symbol;if(!e||"General"===e)return[""];o=(e=e.replace(/;@/g,"").replace(/&quot;?/g,"")).split(";");for(l=0;l<o.length;l++){r=o[l];if(/[hsmy\:]/i.test(r))t=r.replace(/\[\$\-.+\]/g,"").replace(/(\\)(.)/g,"$2").replace(/H+/g,(function(e){return e.toLowerCase()})).replace(/m+/g,(function(e){return e.toUpperCase()})).replace(/S+/g,(function(e){return e.toLowerCase()})).replace(/AM\/PM/gi,"tt").replace(/A\/P/gi,"t").replace(/\.000/g,".fff").replace(/\.00/g,".ff").replace(/\.0/g,".f").replace(/\\[\-\s,]/g,(function(e){return e.substring(1)})).replace(/Y+/g,(function(e){return e.toLowerCase()})).replace(/D+/g,(function(e){return e.toLowerCase()})).replace(/M+:?|:?M+/gi,(function(e){return e.indexOf(":")>-1?e.toLowerCase():e})).replace(/g+e/gi,(function(e){return e.substring(0,e.length-1)+"yy"}));else{s=r.lastIndexOf(".");n=r.lastIndexOf("0");a=r.lastIndexOf(",");t=r.search(/\[\$([^\-\]]+)[^\]]*\]/)>-1||r.indexOf(f)>-1&&-1===r.search(/\[\$([\-\]]+)[^\]]*\]/)?"c":"%"===r[e.length-1]?"p":"n";t+=s>-1&&s<n?r.substring(s,n).length:"0";/^0+,*$/.test(r)&&(t="d"+((n=r.lastIndexOf("0"))+1));if(a>-1&&n>-1&&n<a){h=r.substring(n+1,a+1).split("");for(i=0;i<h.length;i++)t+=","}}u.push(t)}return u};Workbook._parseCellFormat=function(e,t){return t?this.toXlsxDateFormat(e):this.toXlsxNumberFormat(e)};Workbook._parseExcelFormat=function(e){if(null!=e){var t=e&&e.style&&e.style.format;if((null!=e.value||t)&&!isNaN(e.value)){var o=wijmo_1.isNumber(e.value);return!o||t&&"General"!==t?e.isDate||wijmo_1.isDate(e.value)||o||""===e.value||e.isNumber?this.fromXlsxFormat(t)[0]:t:wijmo_1.isInt(e.value)?"d":"f2"}}};Workbook.xlsxAddress=function(e,t,o,r,l){var i=o?"$":"",s=null==r?i:r?"$":"";return!0===l?"":(isNaN(t)?"":s+this._numAlpha(t))+(!1===l?"":isNaN(e)?"":i+(e+1).toString())};Workbook.tableAddress=function(e){var t=e&&/^((\$?)([A-Za-z]+))?((\$?)(\d+))?$/.exec(e),o={};if(!t)return null;if(t[3]){o.col=this._alphaNum(t[3]);o.absCol=!!t[2]}if(t[6]){o.row=+t[6]-1;o.absRow=!!t[5]}return o};Workbook._parseHAlignToString=function(e){switch(e){case HAlign.Left:return"left";case HAlign.Center:return"center";case HAlign.Right:return"right";case HAlign.Justify:return"justify";default:return"general"}};Workbook._parseStringToHAlign=function(e){var t=e?e.toLowerCase():"";return"left"===t?HAlign.Left:"center"===t?HAlign.Center:"right"===t?HAlign.Right:"justify"===t?HAlign.Justify:HAlign.General};Workbook._parseVAlignToString=function(e){switch(e){case VAlign.Bottom:return"bottom";case VAlign.Center:return"center";case VAlign.Top:return"top";default:return null}};Workbook._parseStringToVAlign=function(e){var t=e?e.toLowerCase():"";return"top"===t?VAlign.Top:"center"===t?VAlign.Center:"bottom"===t?VAlign.Bottom:null};Workbook._parseBorderTypeToString=function(e){switch(e){case BorderStyle.Dashed:return"dashed";case BorderStyle.Dotted:return"dotted";case BorderStyle.Double:return"double";case BorderStyle.Hair:return"hair";case BorderStyle.Medium:return"medium";case BorderStyle.MediumDashDotDotted:return"mediumDashDotDot";case BorderStyle.MediumDashDotted:return"mediumDashDot";case BorderStyle.MediumDashed:return"mediumDashed";case BorderStyle.SlantedMediumDashDotted:return"slantDashDot";case BorderStyle.Thick:return"thick";case BorderStyle.Thin:return"thin";case BorderStyle.ThinDashDotDotted:return"dashDotDot";case BorderStyle.ThinDashDotted:return"dashDot";case BorderStyle.None:default:return"none"}};Workbook._parseStringToBorderType=function(e){return"dashed"===e?BorderStyle.Dashed:"dotted"===e?BorderStyle.Dotted:"double"===e?BorderStyle.Double:"hair"===e?BorderStyle.Hair:"medium"===e?BorderStyle.Medium:"mediumDashDotDot"===e?BorderStyle.MediumDashDotDotted:"mediumDashDot"===e?BorderStyle.MediumDashDotted:"mediumDashed"===e?BorderStyle.MediumDashed:"slantDashDot"===e?BorderStyle.SlantedMediumDashDotted:"thick"===e?BorderStyle.Thick:"thin"===e?BorderStyle.Thin:"dashDotDot"===e?BorderStyle.ThinDashDotDotted:"dashDot"===e?BorderStyle.ThinDashDotted:null};Workbook._escapeXML=function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""};Workbook._unescapeXML=function(e){return"string"==typeof e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/"):""};Workbook._numAlpha=function(e){var t=Math.floor(e/26)-1;return(t>-1?this._numAlpha(t):"")+this._alphabet.charAt(e%26)};Workbook._alphaNum=function(e){var t=0;e&&(e=e.toUpperCase());2===e.length&&(t=this._alphaNum(e.charAt(0))+1);return 26*t+this._alphabet.indexOf(e.substr(-1))};Workbook._b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0};Workbook._base64DecToArr=function(e,t){for(var o,r,l=e.replace(/[^A-Za-z0-9\+\/]/g,""),i=l.length,s=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,n=new Uint8Array(s),a=0,h=0,u=0;u<i;u++){r=3&u;a|=this._b64ToUint6(l.charCodeAt(u))<<18-6*r;if(3===r||i-u==1){for(o=0;o<3&&h<s;o++,h++)n[h]=a>>>(16>>>o&24)&255;a=0}}return n};Workbook._uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65};Workbook._base64EncArr=function(e){for(var t=2,o="",r=e.length,l=0,i=0;i<r;i++){t=i%3;i>0&&4*i/3%76==0&&(o+="\r\n");l|=e[i]<<(16>>>t&24);if(2===t||e.length-i==1){o+=String.fromCharCode(this._uint6ToB64(l>>>18&63),this._uint6ToB64(l>>>12&63),this._uint6ToB64(l>>>6&63),this._uint6ToB64(63&l));l=0}}return o.substr(0,o.length-2+t)+(2===t?"":1===t?"=":"==")};Workbook.prototype._serializeWorkSheets=function(){var e,t,o=[];for(t=0;t<this._sheets.length;t++)(e=this._sheets[t])&&(o[t]=e._serialize());return o};Workbook.prototype._serializeWorkbookStyles=function(){var e,t,o=[];for(t=0;t<this._styles.length;t++)(e=this._styles[t])&&(o[t]=e._serialize());return o};Workbook.prototype._serializeDefinedNames=function(){var e,t,o=[];for(t=0;t<this._definedNames.length;t++)(e=this._definedNames[t])&&(o[t]=e._serialize());return o};Workbook.prototype._serializeTableStyles=function(){var e,t,o=[];for(t=0;t<this._tableStyles.length;t++)(e=this._tableStyles[t])&&(o[t]=e._serialize());return o};Workbook.prototype._deserializeWorkSheets=function(e){var t,o,r;this._sheets=[];wijmo_1.assert(null!=e,"workSheets should not be null.");for(r=0;r<e.length;r++)if(o=e[r]){(t=new WorkSheet)._deserialize(o);this._sheets[r]=t}};Workbook.prototype._deserializeWorkbookStyles=function(e){var t,o,r;this._styles=[];for(r=0;r<e.length;r++)if(o=e[r]){(t=new WorkbookStyle)._deserialize(o);this._styles[r]=t}};Workbook.prototype._deserializeDefinedNames=function(e){var t,o,r;this._definedNames=[];for(r=0;r<e.length;r++)if(o=e[r]){(t=new DefinedName)._deserialize(o);this._definedNames[r]=t}};Workbook.prototype._deserializeTableStyles=function(e){var t,o,r;this._tableStyles=[];for(r=0;r<e.length;r++)if(o=e[r]){(t=new WorkbookTableStyle)._deserialize(o);this._tableStyles[r]=t}};Workbook._alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";Workbook._formatMap={n:"#,##0{0}",c:"{1}#,##0{0}_);({1}#,##0{0})",p:"#,##0{0}%",f:"0{0}",d:"{0}",g:"0{0}"};return Workbook}();exports.Workbook=Workbook;var WorkSheet=function(){function WorkSheet(){}Object.defineProperty(WorkSheet.prototype,"columns",{get:function(){null==this._columns&&(this._columns=[]);return this._columns},enumerable:!0,configurable:!0});Object.defineProperty(WorkSheet.prototype,"rows",{get:function(){null==this._rows&&(this._rows=[]);return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(WorkSheet.prototype,"tables",{get:function(){null==this._tables&&(this._tables=[]);return this._tables},enumerable:!0,configurable:!0});WorkSheet.prototype._serialize=function(){var e;if(this._checkEmptyWorkSheet())return null;e={};this.style&&(e.style=this.style._serialize());this._columns&&this._columns.length>0&&(e.columns=this._serializeWorkbookColumns());this._rows&&this._rows.length>0&&(e.rows=this._serializeWorkbookRows());this.frozenPane&&(e.frozenPane=this.frozenPane._serialize());this.name&&(e.name=this.name);null!=this.summaryBelow&&(e.summaryBelow=this.summaryBelow);null!=this.visible&&(e.visible=this.visible);this._tables&&this._tables.length>0&&(e.tables=this._serializeTables());return e};WorkSheet.prototype._deserialize=function(e){var t,o;if(e.style){(o=new WorkbookStyle)._deserialize(e.style);this.style=o}e.columns&&e.columns.length>0&&this._deserializeWorkbookColumns(e.columns);e.rows&&e.rows.length>0&&this._deserializeWorkbookRows(e.rows);if(e.frozenPane){(t=new WorkbookFrozenPane)._deserialize(e.frozenPane);this.frozenPane=t}this.name=e.name;this.summaryBelow=e.summaryBelow;this.visible=e.visible;e.tables&&e.tables.length>0&&this._deserializeTables(e.tables)};WorkSheet.prototype._addWorkbookColumn=function(e,t){null==this._columns&&(this._columns=[]);null==t||isNaN(t)?this._columns.push(e):this._columns[t]=e};WorkSheet.prototype._addWorkbookRow=function(e,t){null==this._rows&&(this._rows=[]);null==t||isNaN(t)?this._rows.push(e):this._rows[t]=e};WorkSheet.prototype._serializeWorkbookColumns=function(){var e,t,o=[];for(t=0;t<this._columns.length;t++)(e=this._columns[t])&&(o[t]=e._serialize());return o};WorkSheet.prototype._serializeWorkbookRows=function(){var e,t,o=[];for(t=0;t<this._rows.length;t++)(e=this._rows[t])&&(o[t]=e._serialize());return o};WorkSheet.prototype._serializeTables=function(){var e,t,o=[];for(t=0;t<this._tables.length;t++)(e=this._tables[t])&&(o[t]=e._serialize());return o};WorkSheet.prototype._deserializeWorkbookColumns=function(e){var t,o,r;this._columns=[];for(r=0;r<e.length;r++)if(t=e[r]){(o=new WorkbookColumn)._deserialize(t);this._columns[r]=o}};WorkSheet.prototype._deserializeWorkbookRows=function(e){var t,o,r;this._rows=[];for(r=0;r<e.length;r++)if(t=e[r]){(o=new WorkbookRow)._deserialize(t);this._rows[r]=o}};WorkSheet.prototype._deserializeTables=function(e){var t,o,r;this._tables=[];for(r=0;r<e.length;r++)if(o=e[r]){(t=new WorkbookTable)._deserialize(o);this._tables[r]=t}};WorkSheet.prototype._checkEmptyWorkSheet=function(){return!(null!=this._rows||null!=this._columns||null!=this.visible||null!=this.summaryBelow||null!=this.frozenPane||null!=this.style||null!=this.name&&""!==this.name||null!=this._tables&&0!=this._tables.length)};return WorkSheet}();exports.WorkSheet=WorkSheet;var WorkbookColumn=function(){function WorkbookColumn(){}WorkbookColumn.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookColumn())return null;e={};this.style&&(e.style=this.style._serialize());null!=this.autoWidth&&(e.autoWidth=this.autoWidth);null!=this.width&&(e.width=this.width);null!=this.visible&&(e.visible=this.visible);return e};WorkbookColumn.prototype._deserialize=function(e){var t;if(e.style){(t=new WorkbookStyle)._deserialize(e.style);this.style=t}this.autoWidth=e.autoWidth;this.visible=e.visible;this.width=e.width};WorkbookColumn.prototype._checkEmptyWorkbookColumn=function(){return null==this.style&&null==this.width&&null==this.autoWidth&&null==this.visible};return WorkbookColumn}();exports.WorkbookColumn=WorkbookColumn;var WorkbookRow=function(){function WorkbookRow(){}Object.defineProperty(WorkbookRow.prototype,"cells",{get:function(){null==this._cells&&(this._cells=[]);return this._cells},enumerable:!0,configurable:!0});WorkbookRow.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookRow())return null;e={};this._cells&&this._cells.length>0&&(e.cells=this._serializeWorkbookCells());this.style&&(e.style=this.style._serialize());null!=this.collapsed&&(e.collapsed=this.collapsed);null==this.groupLevel||isNaN(this.groupLevel)||(e.groupLevel=this.groupLevel);null==this.height||isNaN(this.height)||(e.height=this.height);null!=this.visible&&(e.visible=this.visible);return e};WorkbookRow.prototype._deserialize=function(e){var t;e.cells&&e.cells.length>0&&this._deserializeWorkbookCells(e.cells);if(e.style){(t=new WorkbookStyle)._deserialize(e.style);this.style=t}this.collapsed=e.collapsed;this.groupLevel=e.groupLevel;this.height=e.height;this.visible=e.visible};WorkbookRow.prototype._addWorkbookCell=function(e,t){null==this._cells&&(this._cells=[]);null==t||isNaN(t)?this._cells.push(e):this._cells[t]=e};WorkbookRow.prototype._serializeWorkbookCells=function(){var e,t,o=[];for(t=0;t<this._cells.length;t++)(e=this._cells[t])&&(o[t]=e._serialize());return o};WorkbookRow.prototype._deserializeWorkbookCells=function(e){var t,o,r;this._cells=[];for(r=0;r<e.length;r++)if(t=e[r]){(o=new WorkbookCell)._deserialize(t);this._cells[r]=o}};WorkbookRow.prototype._checkEmptyWorkbookRow=function(){return null==this._cells&&null==this.style&&null==this.collapsed&&null==this.visible&&(null==this.height||isNaN(this.height))&&(null==this.groupLevel||isNaN(this.groupLevel))};return WorkbookRow}();exports.WorkbookRow=WorkbookRow;var WorkbookCell=function(){function WorkbookCell(){}WorkbookCell.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookCell())return null;e={};this.style&&(e.style=this.style._serialize());null!=this.value&&(e.value=this.value);this.formula&&(e.formula=this.formula);null!=this.isDate&&(e.isDate=this.isDate);null!=this.isNumber&&(e.isNumber=this.isNumber);null!=this.colSpan&&!isNaN(this.colSpan)&&this.colSpan>1&&(e.colSpan=this.colSpan);null!=this.rowSpan&&!isNaN(this.rowSpan)&&this.rowSpan>1&&(e.rowSpan=this.rowSpan);this.link&&(e.link=this.link);this.textRuns&&this.textRuns.length>0&&(e.textRuns=this._serializeTextRuns());return e};WorkbookCell.prototype._deserialize=function(e){var t;if(e.style){(t=new WorkbookStyle)._deserialize(e.style);this.style=t}this.value=e.value;this.formula=e.formula;this.isDate=e.isDate;this.isNumber=e.isNumber;this.colSpan=e.colSpan;this.rowSpan=e.rowSpan;this.link=e.link;e.textRuns&&e.textRuns.length>0&&this._deserializeTextRuns(e.textRuns)};WorkbookCell.prototype._serializeTextRuns=function(){var e,t,o=[];for(t=0;t<this.textRuns.length;t++){e=this.textRuns[t];o.push(e._serialize())}return o};WorkbookCell.prototype._deserializeTextRuns=function(e){var t,o,r;this.textRuns=[];for(r=0;r<e.length;r++){o=new WorkbookTextRun;t=e[r];o._deserialize(t);this.textRuns.push(o)}};WorkbookCell.prototype._checkEmptyWorkbookCell=function(){return null==this.style&&null==this.value&&null==this.isDate&&null==this.isNumber&&(null==this.formula||""===this.formula)&&(null==this.colSpan||isNaN(this.colSpan)||this.colSpan<=1)&&(null==this.rowSpan||isNaN(this.rowSpan)||this.rowSpan<=1)&&(null==this.link||""===this.link)};return WorkbookCell}();exports.WorkbookCell=WorkbookCell;var WorkbookFrozenPane=function(){function WorkbookFrozenPane(){}WorkbookFrozenPane.prototype._serialize=function(){return null!=this.columns&&!isNaN(this.columns)&&0!==this.columns||null!=this.rows&&!isNaN(this.rows)&&0!==this.rows?{columns:this.columns,rows:this.rows}:null};WorkbookFrozenPane.prototype._deserialize=function(e){this.columns=e.columns;this.rows=e.rows};return WorkbookFrozenPane}();exports.WorkbookFrozenPane=WorkbookFrozenPane;var WorkbookStyle=function(){function WorkbookStyle(){}WorkbookStyle.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookStyle())return null;e={};this.basedOn&&(e.basedOn=this.basedOn._serialize());this.fill&&(e.fill=this.fill._serialize());this.font&&(e.font=this.font._serialize());this.borders&&(e.borders=this.borders._serialize());this.format&&(e.format=this.format);null!=this.hAlign&&(e.hAlign=wijmo_1.asEnum(this.hAlign,HAlign,!1));null!=this.vAlign&&(e.vAlign=wijmo_1.asEnum(this.vAlign,VAlign,!1));null==this.indent||isNaN(this.indent)||(e.indent=this.indent);this.wordWrap&&(e.wordWrap=this.wordWrap);return e};WorkbookStyle.prototype._deserialize=function(e){var t,o,r,l;if(e.basedOn){(t=new WorkbookStyle)._deserialize(e.basedOn);this.basedOn=t}if(e.fill){(o=new WorkbookFill)._deserialize(e.fill);this.fill=o}if(e.font){(r=new WorkbookFont)._deserialize(e.font);this.font=r}if(e.borders){(l=new WorkbookBorder)._deserialize(e.borders);this.borders=l}this.format=e.format;null!=e.hAlign&&(this.hAlign=wijmo_1.asEnum(e.hAlign,HAlign,!1));null!=e.vAlign&&(this.vAlign=wijmo_1.asEnum(e.vAlign,VAlign,!1));null==e.indent||isNaN(e.indent)||(this.indent=e.indent);e.wordWrap&&(this.wordWrap=e.wordWrap)};WorkbookStyle.prototype._checkEmptyWorkbookStyle=function(){return null==this.basedOn&&null==this.fill&&null==this.font&&null==this.borders&&(null==this.format||""===this.format)&&null==this.hAlign&&null==this.vAlign&&null==this.wordWrap};return WorkbookStyle}();exports.WorkbookStyle=WorkbookStyle;var WorkbookFont=function(){function WorkbookFont(){}WorkbookFont.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookFont())return null;e={};null!=this.bold&&(e.bold=this.bold);null!=this.italic&&(e.italic=this.italic);null!=this.underline&&(e.underline=this.underline);this.color&&(e.color=this.color);this.family&&(e.family=this.family);null==this.size||isNaN(this.size)||(e.size=this.size);return e};WorkbookFont.prototype._deserialize=function(e){this.bold=e.bold;null!=e.color&&(this.color=e.color);this.family=e.family;this.italic=e.italic;this.size=e.size;this.underline=e.underline};WorkbookFont.prototype._checkEmptyWorkbookFont=function(){return null==this.bold&&null==this.italic&&null==this.underline&&(null==this.color||""===this.color)&&(null==this.family||""===this.family)&&(null==this.size||isNaN(this.size))};return WorkbookFont}();exports.WorkbookFont=WorkbookFont;var WorkbookFill=function(){function WorkbookFill(){}WorkbookFill.prototype._serialize=function(){return this.color?{color:this.color}:null};WorkbookFill.prototype._deserialize=function(e){null!=e.color&&(this.color=e.color)};return WorkbookFill}();exports.WorkbookFill=WorkbookFill;var WorkbookBorder=function(){function WorkbookBorder(){}WorkbookBorder.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookBorder())return null;e={};this.top&&(e.top=this.top._serialize());this.bottom&&(e.bottom=this.bottom._serialize());this.left&&(e.left=this.left._serialize());this.right&&(e.right=this.right._serialize());this.diagonal&&(e.diagonal=this.diagonal._serialize());return e};WorkbookBorder.prototype._deserialize=function(e){var t,o,r,l,i;if(e.top){(t=new WorkbookBorderSetting)._deserialize(e.top);this.top=t}if(e.bottom){(o=new WorkbookBorderSetting)._deserialize(e.bottom);this.bottom=o}if(e.left){(r=new WorkbookBorderSetting)._deserialize(e.left);this.left=r}if(e.right){(l=new WorkbookBorderSetting)._deserialize(e.right);this.right=l}if(e.diagonal){(i=new WorkbookBorderSetting)._deserialize(e.diagonal);this.diagonal=i}};WorkbookBorder.prototype._checkEmptyWorkbookBorder=function(){return null==this.top&&null==this.bottom&&null==this.left&&null==this.right&&null==this.diagonal};return WorkbookBorder}();exports.WorkbookBorder=WorkbookBorder;var WorkbookBorderSetting=function(){function WorkbookBorderSetting(){}WorkbookBorderSetting.prototype._serialize=function(){var e;if((null==this.color||""===this.color)&&null==this.style)return null;e={};this.color&&(e.color=this.color);null!=this.style&&(e.style=wijmo_1.asEnum(this.style,BorderStyle,!1));return e};WorkbookBorderSetting.prototype._deserialize=function(e){if(null!=e.color||null!=e.style){this.color=e.color;null!=e.style&&(this.style=wijmo_1.asEnum(e.style,BorderStyle,!1))}};return WorkbookBorderSetting}();exports.WorkbookBorderSetting=WorkbookBorderSetting;var DefinedName=function(){function DefinedName(){}DefinedName.prototype._serialize=function(){var e;if(null==this.name)return null;e={name:this.name,value:this.value};null!=this.sheetName&&(e.sheetName=this.sheetName);return e};DefinedName.prototype._deserialize=function(e){this.name=e.name;this.value=e.value;this.sheetName=e.sheetName};return DefinedName}();exports.DefinedName=DefinedName;var WorkbookTable=function(){function WorkbookTable(){}Object.defineProperty(WorkbookTable.prototype,"columns",{get:function(){null==this._columns&&(this._columns=[]);return this._columns},enumerable:!0,configurable:!0});WorkbookTable.prototype._serialize=function(){var e,t;if(null==this.name||null==this.range||null==this._columns)return null;null!=this.style&&(t=this.style._serialize());(e={name:this.name,range:this.range,showHeaderRow:this.showHeaderRow,showTotalRow:this.showTotalRow,style:t,showBandedColumns:this.showBandedColumns,showBandedRows:this.showBandedRows,alterFirstColumn:this.alterFirstColumn,alterLastColumn:this.alterLastColumn,columns:[]}).columns=this._serializeTableColumns();return e};WorkbookTable.prototype._deserialize=function(e){var t;this.name=e.name;this.range=e.range;this.showHeaderRow=e.showHeaderRow;this.showTotalRow=e.showTotalRow;if(null!=e.style){(t=new WorkbookTableStyle)._deserialize(e.style);this.style=t}this.showBandedColumns=e.showBandedColumns;this.showBandedRows=e.showBandedRows;this.alterFirstColumn=e.alterFirstColumn;this.alterLastColumn=e.alterLastColumn;this._deserializeTableColumns(e.columns)};WorkbookTable.prototype._serializeTableColumns=function(){var e,t,o=[];for(t=0;t<this._columns.length;t++)(e=this._columns[t])&&(o[t]=e._serialize());return o};WorkbookTable.prototype._deserializeTableColumns=function(e){var t,o,r;wijmo_1.assert(null!=e,"table Columns should not be null.");this._columns=[];for(r=0;r<e.length;r++)if(o=e[r]){(t=new WorkbookTableColumn)._deserialize(o);this._columns[r]=t}};return WorkbookTable}();exports.WorkbookTable=WorkbookTable;var WorkbookTableColumn=function(){function WorkbookTableColumn(){}WorkbookTableColumn.prototype._serialize=function(){return null==this.name?null:{name:this.name,totalRowLabel:this.totalRowLabel,totalRowFunction:this.totalRowFunction,showFilterButton:this.showFilterButton}};WorkbookTableColumn.prototype._deserialize=function(e){this.name=e.name;this.totalRowLabel=e.totalRowLabel;this.totalRowFunction=e.totalRowFunction;this.showFilterButton=e.showFilterButton};return WorkbookTableColumn}();exports.WorkbookTableColumn=WorkbookTableColumn;var WorkbookTableStyle=function(){function WorkbookTableStyle(){}WorkbookTableStyle.prototype._serialize=function(){var e;if(this._checkEmptyWorkbookTableStyle())return null;e={name:this.name};this.wholeTableStyle&&(e.wholeTableStyle=this.wholeTableStyle._serialize());this.firstBandedColumnStyle&&(e.firstBandedColumnStyle=this.firstBandedColumnStyle._serialize());this.firstBandedRowStyle&&(e.firstBandedRowStyle=this.firstBandedRowStyle._serialize());this.secondBandedColumnStyle&&(e.secondBandedColumnStyle=this.secondBandedColumnStyle._serialize());this.secondBandedRowStyle&&(e.secondBandedRowStyle=this.secondBandedRowStyle._serialize());this.headerRowStyle&&(e.headerRowStyle=this.headerRowStyle._serialize());this.totalRowStyle&&(e.totalRowStyle=this.totalRowStyle._serialize());this.firstColumnStyle&&(e.firstColumnStyle=this.firstColumnStyle._serialize());this.lastColumnStyle&&(e.lastColumnStyle=this.lastColumnStyle._serialize());this.firstHeaderCellStyle&&(e.firstHeaderCellStyle=this.firstHeaderCellStyle._serialize());this.lastHeaderCellStyle&&(e.lastHeaderCellStyle=this.lastHeaderCellStyle._serialize());this.firstTotalCellStyle&&(e.firstTotalCellStyle=this.firstTotalCellStyle._serialize());this.lastTotalCellStyle&&(e.lastTotalCellStyle=this.lastTotalCellStyle._serialize());return e};WorkbookTableStyle.prototype._deserialize=function(e){this.name=e.name;if(e.wholeTableStyle){this.wholeTableStyle=new WorkbookTableCommonStyle;this.wholeTableStyle._deserialize(e.wholeTableStyle)}if(e.firstBandedColumnStyle){this.firstBandedColumnStyle=new WorkbookTableBandedStyle;this.firstBandedColumnStyle._deserialize(e.firstBandedColumnStyle)}if(e.firstBandedRowStyle){this.firstBandedRowStyle=new WorkbookTableBandedStyle;this.firstBandedRowStyle._deserialize(e.firstBandedRowStyle)}if(e.secondBandedColumnStyle){this.secondBandedColumnStyle=new WorkbookTableBandedStyle;this.secondBandedColumnStyle._deserialize(e.secondBandedColumnStyle)}if(e.secondBandedRowStyle){this.secondBandedRowStyle=new WorkbookTableBandedStyle;this.secondBandedRowStyle._deserialize(e.secondBandedRowStyle)}if(e.headerRowStyle){this.headerRowStyle=new WorkbookTableCommonStyle;this.headerRowStyle._deserialize(e.headerRowStyle)}if(e.totalRowStyle){this.totalRowStyle=new WorkbookTableCommonStyle;this.totalRowStyle._deserialize(e.totalRowStyle)}if(e.firstColumnStyle){this.firstColumnStyle=new WorkbookTableCommonStyle;this.firstColumnStyle._deserialize(e.firstColumnStyle)}if(e.lastColumnStyle){this.lastColumnStyle=new WorkbookTableCommonStyle;this.lastColumnStyle._deserialize(e.lastColumnStyle)}if(e.firstHeaderCellStyle){this.firstHeaderCellStyle=new WorkbookTableCommonStyle;this.firstHeaderCellStyle._deserialize(e.firstHeaderCellStyle)}if(e.lastHeaderCellStyle){this.lastHeaderCellStyle=new WorkbookTableCommonStyle;this.lastHeaderCellStyle._deserialize(e.lastHeaderCellStyle)}if(e.firstTotalCellStyle){this.firstTotalCellStyle=new WorkbookTableCommonStyle;this.firstTotalCellStyle._deserialize(e.firstTotalCellStyle)}if(e.lastTotalCellStyle){this.lastTotalCellStyle=new WorkbookTableCommonStyle;this.lastTotalCellStyle._deserialize(e.lastTotalCellStyle)}};WorkbookTableStyle.prototype._checkEmptyWorkbookTableStyle=function(){return null==this.name||null==this.wholeTableStyle&&null==this.firstBandedColumnStyle&&null==this.firstBandedRowStyle&&null==this.secondBandedColumnStyle&&null==this.secondBandedRowStyle&&null==this.headerRowStyle&&null==this.totalRowStyle&&null==this.firstColumnStyle&&null==this.lastColumnStyle&&null==this.firstHeaderCellStyle&&null==this.lastHeaderCellStyle&&null==this.firstTotalCellStyle&&null==this.lastTotalCellStyle};return WorkbookTableStyle}();exports.WorkbookTableStyle=WorkbookTableStyle;var WorkbookTableCommonStyle=function(e){__extends(WorkbookTableCommonStyle,e);function WorkbookTableCommonStyle(){return e.call(this)||this}WorkbookTableCommonStyle.prototype._deserialize=function(t){var o;e.prototype._deserialize.call(this,t);if(t.borders){(o=new WorkbookTableBorder)._deserialize(t.borders);this.borders=o}};return WorkbookTableCommonStyle}(WorkbookStyle);exports.WorkbookTableCommonStyle=WorkbookTableCommonStyle;var WorkbookTableBandedStyle=function(e){__extends(WorkbookTableBandedStyle,e);function WorkbookTableBandedStyle(){return e.call(this)||this}WorkbookTableBandedStyle.prototype._serialize=function(){var t;(t=e.prototype._serialize.call(this)).size=this.size;return t};WorkbookTableBandedStyle.prototype._deserialize=function(t){e.prototype._deserialize.call(this,t);null!=t.size&&(this.size=t.size)};return WorkbookTableBandedStyle}(WorkbookTableCommonStyle);exports.WorkbookTableBandedStyle=WorkbookTableBandedStyle;var WorkbookTableBorder=function(e){__extends(WorkbookTableBorder,e);function WorkbookTableBorder(){return e.call(this)||this}WorkbookTableBorder.prototype._serialize=function(){var t;null!=(t=e.prototype._serialize.call(this))||this.vertical&&this.horizontal||(t={});this.vertical&&(t.vertical=this.vertical._serialize());this.horizontal&&(t.horizontal=this.horizontal._serialize());return t};WorkbookTableBorder.prototype._deserialize=function(t){var o,r;e.prototype._deserialize.call(this,t);if(t.vertical){(o=new WorkbookBorderSetting)._deserialize(t.vertical);this.vertical=o}if(t.horizontal){(r=new WorkbookBorderSetting)._deserialize(t.horizontal);this.horizontal=r}};return WorkbookTableBorder}(WorkbookBorder);exports.WorkbookTableBorder=WorkbookTableBorder;var HAlign,VAlign,BorderStyle,WorkbookTextRun=function(){function WorkbookTextRun(){}WorkbookTextRun.prototype._serialize=function(){var e={text:this.text};this.font&&(e.font=this.font._serialize());return e};WorkbookTextRun.prototype._deserialize=function(e){if(e.font){this.font=new WorkbookFont;this.font._deserialize(e.font)}this.text=e.text};return WorkbookTextRun}();exports.WorkbookTextRun=WorkbookTextRun;!function(e){e[e.General=0]="General";e[e.Left=1]="Left";e[e.Center=2]="Center";e[e.Right=3]="Right";e[e.Fill=4]="Fill";e[e.Justify=5]="Justify"}(HAlign=exports.HAlign||(exports.HAlign={}));!function(e){e[e.Top=0]="Top";e[e.Center=1]="Center";e[e.Bottom=2]="Bottom";e[e.Justify=3]="Justify"}(VAlign=exports.VAlign||(exports.VAlign={}));!function(e){e[e.None=0]="None";e[e.Thin=1]="Thin";e[e.Medium=2]="Medium";e[e.Dashed=3]="Dashed";e[e.Dotted=4]="Dotted";e[e.Thick=5]="Thick";e[e.Double=6]="Double";e[e.Hair=7]="Hair";e[e.MediumDashed=8]="MediumDashed";e[e.ThinDashDotted=9]="ThinDashDotted";e[e.MediumDashDotted=10]="MediumDashDotted";e[e.ThinDashDotDotted=11]="ThinDashDotDotted";e[e.MediumDashDotDotted=12]="MediumDashDotDotted";e[e.SlantedMediumDashDotted=13]="SlantedMediumDashDotted"}(BorderStyle=exports.BorderStyle||(exports.BorderStyle={}));var JSZip=JSZipRef;function useJSZip(e){JSZip=e}exports.useJSZip=useJSZip;var _xlsx=function(){function _xlsx(){}_xlsx.load=function(e){var t=new JSZip;wijmo_1.assert(null==t.loadAsync,"Please use JSZip 2.5 to load excel files synchronously.");var o,r=new _JsZipWrapper(t);this._loadImpl(r,e).then((function(e){return o=e}));return o};_xlsx.loadAsync=function(e){var t=new JSZip;wijmo_1.assert(null!=t.loadAsync,"Please use JSZip 3.0 to load excel files asynchrounously.");return this._loadImpl(t,e)};_xlsx.save=function(e){var t,o=Date.now();this._saveWorkbookToZip(e,null,!1).then((function(e){return t=e}));o=Date.now()-o;var r="";r=this._macroEnabled?"application/vnd.ms-excel.sheet.macroEnabled.12;":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;";var l=Date.now(),i=t.generate({compression:"DEFLATE"});return{base64:i,zipTime:Date.now()-l,processTime:o,href:function(){return"data:"+r+"base64,"+i}}};_xlsx.saveAsync=function(e,t,o,r){var l=new _SyncPromise(t);wijmo_1.isFunction(r)&&r(0);this._saveWorkbookToZip(e,t,!0,(function(e){wijmo_1.isFunction(r)&&r(Math.round(_map(e,0,100,0,90)))})).then((function(e){wijmo_1.isFunction(r)&&r(91);var i=e.generateAsync({type:"base64",compression:"DEFLATE"});i.catch((function(e){o&&o(e);l.reject(e)}));i.then((function(e){if(t&&t.cancelled)l.cancel();else{wijmo_1.isFunction(r)&&r(100);l.resolve(e)}}))}),(function(e){l.reject(e)}));return l};_xlsx._loadImpl=function(e,t){var o,r=this,l=Date.now(),i={sheets:[]},s=e.loadAsync(t,{base64:!0}).then((function(e){return o=e}));t=null;var n=s.constructor;return(s=(s=(s=(s=(s=(s=s.then((function(){var e=o.file("xl/theme/theme1.xml");if(e)return e.async("string").then((function(e){r._getTheme(e);i.colorThemes=r._colorThemes})).then((function(){var e=n.resolve();e=r._getZipStyle(o,e,i);return e=r._getZipSharedString(o,e,i)}));var t=n.resolve();t=r._getZipStyle(o,t,i);return t=r._getZipSharedString(o,t,i)}))).then((function(){var e=o.file("xl/workbook.xml");if(e)return e.async("string").then((function(e){r._getWorkbook(e,i)}))}))).then((function(){r._tables=null;var e=n.resolve();o.folder("xl/tables").forEach((function(t,o){null==r._tables&&(r._tables=[]);e=e.then((function(){return o.async("string").then((function(e){var t=r._getTable(e);t.fileName=o.name.substring(o.name.lastIndexOf("/")+1);r._tables.push(t)}))}))}));return e}))).then((function(){var e=o.file("docProps/core.xml");if(e)return e.async("string").then((function(e){r._getCoreSetting(e,i)}))}))).then((function(){var e=o.file("xl/vbaProject.bin");if(e)return e.async("uint8array").then((function(e){null==i.reservedContent&&(i.reservedContent={});i.reservedContent.macros=e}))}))).then((function(){var e=n.resolve();o.folder("xl/worksheets").forEach((function(t,l){if(t&&-1===t.indexOf("/")){var s=r._getSheetIndex(l.name);isNaN(s)||(e=e.then((function(){return l.async("string").then((function(e){r._getSheet(e,s-1,i);if(null!=i.sheets[s-1].tableRIds||null!=i.sheets[s-1].hyperlinkRIds){var t=o.file("xl/worksheets/_rels/sheet"+s+".xml.rels");if(t)return t.async("string").then((function(e){for(var t=e.split("<Relationship "),o=t.length;--o;){var l=t[o],n=r._getAttr(l,"Id");if(i.sheets[s-1].tableRIds&&-1!==i.sheets[s-1].tableRIds.indexOf(n)){null==i.sheets[s-1].tables&&(i.sheets[s-1].tables=[]);i.sheets[s-1].tables.push(r._getSheetRelatedTable(l))}else i.sheets[s-1].hyperlinkRIds&&r._getSheetRelatedHyperlink(l,n,i.sheets[s-1])}}))}}))})))}}));return e}))).then((function(){i.processTime=Date.now()-l;o=null;return i}))};_xlsx._getZipStyle=function(e,t,o){var r=this,l=e.file("xl/styles.xml");l&&(t=t.then((function(){return l.async("string").then((function(e){r._getStyle(e);o.styles=r._styles;null!=r._tableStyles&&(o.tableStyles=r._tableStyles)}))})));return t};_xlsx._getZipSharedString=function(e,t,o){var r=this,l=e.file("xl/sharedStrings.xml");l&&t.then((function(){return l.async("string").then((function(e){r._getSharedString(e)}))}));return t};_xlsx._saveWorkbookToZip=function(e,t,o,r){var l=this,i=new JSZip;o?wijmo_1.assert(null!=i.generateAsync,"Please use JSZip 3.0 to save excel files asynchrounously."):wijmo_1.assert(null==i.generateAsync,"Please use JSZip 2.5 to save excel files synchronously.");wijmo_1.isFunction(r)&&r(0);i.folder("_rels").file(".rels",this._xmlDescription+this._generateRelsDoc());var s=i.folder("docProps"),n=i.folder("xl");this._colorThemes=e.colorThemes;n.folder("theme").file("theme1.xml",this._xmlDescription+this._generateThemeDoc());this._macroEnabled=!(!e.reservedContent||!e.reservedContent.macros);this._macroEnabled&&n.file("vbaProject.bin",e.reservedContent.macros);s.file("core.xml",this._xmlDescription+this._generateCoreDoc(e));this._sharedStrings=[[],0];this._styles=new Array(1);this._borders=new Array(1);this._fonts=new Array(1);this._fills=new Array(2);this._tableStyles=new Array;this._dxfs=new Array;this._contentTypes=[];this._props=[];this._xlRels=[];this._worksheets=[];this._tables=[];this._tableStyles=[];var a=new _SyncPromise(t);this._generateWorksheets(e,n,t,o,r).then((function(){n.file("styles.xml",l._xmlDescription+l._generateStyleDoc());i.file("[Content_Types].xml",l._xmlDescription+l._generateContentTypesDoc());s.file("app.xml",l._xmlDescription+l._generateAppDoc(e));n.folder("_rels").file("workbook.xml.rels",l._xmlDescription+l._generateWorkbookRels());var t=l._xmlDescription+l._generateSharedStringsDoc();l._sharedStrings=[[],0];n.file("sharedStrings.xml",t);t=null;n.file("workbook.xml",l._xmlDescription+l._generateWorkbook(e));wijmo_1.isFunction(r)&&r(100);a.resolve(i)}));return a};_xlsx._generateWorksheets=function(e,t,o,r,l){for(var i,s=this,n=t.folder("worksheets"),a=e.sheets.length,h=[],u=e.sheets.map((function(e){return e.rows.length})).reduce((function(e,t){return e+t})),f=e.sheets.map((function(e){return e.rows.length/u})),c=a-1,d=0,m=0,_loop_1=function(){var u=a;h.push((function(){var a=new _SyncPromise(o);s._generateWorkSheet(u,e,n,o,r,(function(e){if(wijmo_1.isFunction(l)){e=Math.round(e*f[u]);if(c!==u){c=u;m+=d}d=e;l(m+e)}})).then((function(){var o=e.sheets[u];if(o&&(o.tables&&o.tables.length>0||o.externalLinks&&o.externalLinks.length>0)){var r=0,l='<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';if(o.externalLinks&&o.externalLinks.length>0){l+=s._generateHyperlinkRel(o.externalLinks);r=o.externalLinks.length}if(o.tables&&o.tables.length>0){null==i&&(i=t.folder("tables"));for(var h=0;h<o.tables.length;h++){var f=o.tables[h];s._generateTable(f,i);l+='<Relationship Target="../tables/'+f.fileName+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Id="rId'+(h+1+r)+'"/>'}}l+="</Relationships>";n.folder("_rels").file("sheet"+(u+1)+".xml.rels",s._xmlDescription+l)}a.resolve()}));return a}))};a--;)_loop_1();return _SyncPromise.serial(o,h).then((function(){wijmo_1.isFunction(l)&&l(100)}))};_xlsx._getSharedString=function(e){var t,o,r,l,i,s,n,a,h=e.split(/<si.*?>/g),u=h.length;this._sharedStrings=[];for(;--u;){t=1;l=!1;if(h[u].search(/<r>/gi)>-1){l=!0;o=h[u].split(/<r>/g)}else if(h[u].indexOf("<t/>")>=0)o=["",""];else{h[u]=h[u].substring(0,h[u].indexOf("</t>"));o=h[u].split(/<t.*?>/g)}for(;t<o.length;){s=null;if(l){-1!==o[t].indexOf("<rPr>")&&(s=this._getTextRunFont(o[t]));(r=o[t].match(/(<t.*?>)(.*)/))&&3===r.length&&null!=r[2]&&-1!==(a=(n=r[2]).indexOf("</t>"))&&(n=n.substring(0,a));i={font:s,text:Workbook._unescapeXML(n)};null==this._sharedStrings[u-1]?this._sharedStrings[u-1]=[i]:this._sharedStrings[u-1].push(i)}else this._sharedStrings[u-1]=Workbook._unescapeXML(o[t]);t++}}};_xlsx._getInlineString=function(e){for(var t=e.split("<t>"),o=t.length,r="";--o;)r+=t[o].substring(0,t[o].indexOf("</t>"));return r};_xlsx._getCoreSetting=function(e,t){var o,r;if((r=e.indexOf("<dc:creator>"))>=0){o=e.substr(r+12);t.creator=o.substring(0,o.indexOf("</dc:creator>"))}if((r=e.indexOf("<cp:lastModifiedBy>"))>=0){o=e.substr(r+19);t.lastModifiedBy=o.substring(0,o.indexOf("</cp:lastModifiedBy>"))}if((r=e.indexOf('<dcterms:created xsi:type="dcterms:W3CDTF">'))>=0){o=e.substr(r+43);t.created=new Date(o.substring(0,o.indexOf("</dcterms:created>")))}if((r=e.indexOf('<dcterms:modified xsi:type="dcterms:W3CDTF">'))>=0){o=e.substr(r+44);t.modified=new Date(o.substring(0,o.indexOf("</dcterms:modified>")))}};_xlsx._getWorkbook=function(e,t){var o,r,l,i,s,n,a,h,u=e.substring(e.indexOf("<bookViews>"),e.indexOf("</bookViews>")),f="",c=e.indexOf("<definedNames>");u&&(f=this._getAttr(u,"activeTab"));t.activeWorksheet=+f;n=(s=e.split("<sheet ")).length;for(;--n;){a=this._getAttr(s[n],"name");h="hidden"!==this._getAttr(s[n],"state");t.sheets.unshift({name:a,visible:h,columns:[],rows:[]})}if(c>-1){t.definedNames=[];n=(s=e.substring(c,e.indexOf("</definedNames>")).split("<definedName ")).length;for(;--n;){a=this._getAttr(s[n],"name");if(r=s[n].match(/.*>.+(?=<\/definedName>)/)){r=r[0].replace(/(.*>)(.+)/,"$2");r=isNaN(+r)?r:+r}o={name:a,value:r};""!==(l=this._getAttr(s[n],"localSheetId"))&&(i=t.sheets[+l])&&(o.sheetName=i.name);t.definedNames.unshift(o)}}};_xlsx._getTheme=function(e){e=e.substring(e.indexOf("<a:clrScheme"),e.indexOf("</a:clrScheme>"));this._colorThemes=this._defaultColorThemes.slice();this._colorThemes[0]=this._getAttr(e.substring(e.indexOf("a:lt1"),e.indexOf("</a:lt1>")),"lastClr")||this._getAttr(e.substring(e.indexOf("a:lt1"),e.indexOf("</a:lt1>")),"val");this._colorThemes[1]=this._getAttr(e.substring(e.indexOf("a:dk1"),e.indexOf("</a:dk1>")),"lastClr")||this._getAttr(e.substring(e.indexOf("a:dk1"),e.indexOf("</a:dk1>")),"val");this._colorThemes[2]=this._getAttr(e.substring(e.indexOf("a:lt2"),e.indexOf("</a:lt2>")),"val");this._colorThemes[3]=this._getAttr(e.substring(e.indexOf("a:dk2"),e.indexOf("</a:dk2>")),"val");for(var t=e.substring(e.indexOf("<a:accent1"),e.indexOf("</a:accent6>")).split("<a:accent"),o=t.length;--o;)this._colorThemes[o+3]=this._getAttr(t[o],"val")};_xlsx._getStyle=function(e){var t,o,r,l,i,s=[],n=[],a=[],h=this._numFmts.slice();this._styles=[];if((r=e.indexOf("<numFmts"))>=0){var u=e.substring(r+8,e.indexOf("</numFmts>")).split("<numFmt");t=u.length;for(;--t;){o=u[t];h[+this._getAttr(o,"numFmtId")]=this._getAttr(o,"formatCode")}}if((r=e.indexOf("<fonts"))>=0){var f,c=e.substring(r,e.indexOf("</fonts>")).split("<font>");t=c.length;for(;--t;){o=c[t];l=this._getChildNodeValue(o,"sz");s[t-1]={bold:o.indexOf("<b/>")>=0||"true"===this._getChildNodeValue(o,"b"),italic:o.indexOf("<i/>")>=0||"true"===this._getChildNodeValue(o,"i"),underline:o.indexOf("<u/>")>=0||(f=this._getChildNodeValue(o,"u"))&&"none"!==f,size:Math.round(l?96*+l/72:14),family:this._getChildNodeValue(o,"name"),color:this._getColor(o,!1)};l=null}}if((r=e.indexOf("<fills"))>=0){var d=e.substring(r,e.indexOf("</fills>")).split("<fill>");t=d.length;for(;--t;)n[t-1]=this._getColor(d[t],!0)}if((r=e.indexOf("<borders"))>=0){var m=e.substring(r+8,e.indexOf("</borders>")).split("<border");t=m.length;for(;--t;){o=m[t];a[t-1]={left:this._getEdgeBorder(o,"left"),right:this._getEdgeBorder(o,"right"),top:this._getEdgeBorder(o,"top"),bottom:this._getEdgeBorder(o,"bottom")}}}if((r=e.indexOf("<cellXfs"))>=0){var p,_,g,b,y,k,x=e.substring(r,e.indexOf("</cellXfs>")).split("<xf");t=x.length;for(;--t;){o=x[t];_=(p=h[g=+this._getAttr(o,"numFmtId")])?/[hsmy\:]/i.test(p)?"date":p.indexOf("0")>-1?"number":"@"===p?"string":"unknown":"unknown";b=(g=+this._getAttr(o,"fontId"))>0?s[g]:null;y=(g=+this._getAttr(o,"fillId"))>1?n[g]:null;k=(g=+this._getAttr(o,"borderId"))>0?a[g]:null;r=o.indexOf("<alignment");i=+this._getAttr(o,"quotePrefix");this._styles.unshift({formatCode:p,type:_,font:b,fillColor:y,borders:k,hAlign:r>=0?Workbook._parseStringToHAlign(this._getAttr(o,"horizontal")):null,vAlign:r>=0?Workbook._parseStringToVAlign(this._getAttr(o,"vertical")):null,wordWrap:r>=0?"1"===this._getAttr(o,"wrapText"):null,quotePrefix:1===i})}}if(e.indexOf("<tableStyle ")>-1){this._tableStyles=[];var S=e.substring(e.indexOf("<tableStyles "),e.indexOf("</tableStyles>")),v=e.substring(e.indexOf("<dxfs "),e.indexOf("</dxfs>"));this._getTableStyles(S,v.split("<dxf>"))}};_xlsx._getEdgeBorder=function(e,t){var o,r,l,i,s=e.indexOf("<"+t),n=e.indexOf("</"+t+">");if(s>=0){r=e.substring(s);r=n>=0?r.substring(0,n):r.substring(0,r.indexOf("/>"));var a=this._getAttr(r,"style");if(a){l=Workbook._parseStringToBorderType(a);i=this._getColor(r,!1);if(l!==BorderStyle.Thin||!i||"#c6c6c6"!==i.toLowerCase()){(o={}).style=l;o.color=i}}}return o};_xlsx._getSheet=function(e,t,o){var r,l=[];if(e.indexOf("<mergeCells")>-1)for(var i=e.substring(e.indexOf("<mergeCells"),e.indexOf("</mergeCells>")).split("<mergeCell "),s=i.length;--s;)2===(r=this._getAttr(i[s],"ref").split(":")).length&&l.unshift({topRow:+r[0].match(/\d*/g).join("")-1,leftCol:this._alphaNum(r[0].match(/[a-zA-Z]*/g)[0]),bottomRow:+r[1].match(/\d*/g).join("")-1,rightCol:this._alphaNum(r[1].match(/[a-zA-Z]*/g)[0])});this._getsBaseSharedFormulas(e);var n=e.split("<row "),a=o.sheets[t];if(n[0].indexOf("<dimension")>=0){var h=this._getAttr(n[0].substr(n[0].indexOf("<dimension")),"ref");if(h){h=h.substr(h.indexOf(":")+1);a.maxCol=this._alphaNum(h.match(/[a-zA-Z]*/g)[0])+1;a.maxRow=+h.match(/\d*/g).join("")}}var u=e.indexOf("<tableParts");if(u>-1){var f=e.substring(u,e.indexOf("</tableParts>")).split("<tablePart "),c=f.length;a.tableRIds=[];for(;--c;)a.tableRIds.unshift(this._getAttr(f[c],"r:id"))}if(n.length>0&&n[0].indexOf("<pane")>-1&&"frozen"===this._getAttr(n[0].substr(n[0].indexOf("<pane")),"state")){var d=this._getAttr(n[0].substr(n[0].indexOf("<pane")),"ySplit"),m=this._getAttr(n[0].substr(n[0].indexOf("<pane")),"xSplit");a.frozenPane={rows:d?+d:NaN,columns:m?+m:NaN}}a.summaryBelow="0"!==this._getAttr(n[0],"summaryBelow");s=n.length;if(n.length<=1){a.maxCol=20;a.maxRow=200}else a.maxRow<s-1&&(a.maxRow=s-1);for(var p,_=null,g=null;--s;){var b=a.rows[+this._getAttr(n[s],"r")-1]={visible:!0,groupLevel:NaN,cells:[]};n[s].substring(0,n[s].indexOf(">")).indexOf("hidden")>-1&&"1"===this._getAttr(n[s],"hidden")&&(b.visible=!1);if("1"===this._getAttr(n[s],"customHeight")){var y=+this._getAttr(n[s].substring(0,n[s].indexOf(">")).replace("customHeight",""),"ht");b.height=96*y/72}_=null;g=null;"1"===this._getAttr(n[s],"customFormat")&&(_=(g=this._styles[+this._getAttr(n[s].substring(n[s].indexOf(" s=")),"s")]||{type:"General",formatCode:null}).font||g.fillColor||g.hAlign||g.vAlign||g.wordWrap||g.borders||g.formatCode&&"General"!==g.formatCode?{format:g.formatCode&&"General"!==g.formatCode?g.formatCode:null,font:g.font,fill:{color:g.fillColor},borders:g.borders,hAlign:g.hAlign,vAlign:g.vAlign,wordWrap:g.wordWrap}:null);b.style=_;var k=this._getAttr(n[s],"outlineLevel");b.groupLevel=k&&""!==k?+k:NaN;b.collapsed="1"===this._getAttr(n[s],"collapsed");var x=n[s].split("<c "),S=x.length;(null==a.maxCol||a.maxCol<S-1)&&(a.maxCol=S-1);for(;--S;){var v=x[S];_=(g=this._styles[+this._getAttr(v,"s")]||{type:"General",formatCode:null}).font||g.fillColor||g.hAlign||g.vAlign||g.wordWrap||g.borders||g.formatCode&&"General"!==g.formatCode?{format:g.formatCode&&"General"!==g.formatCode?g.formatCode:null,font:g.font,fill:{color:g.fillColor},borders:g.borders,hAlign:g.hAlign,vAlign:g.vAlign,wordWrap:g.wordWrap}:null;var w=this._getAttr(v.substring(0,v.indexOf(">")),"t")||g.type,C=null,W="inlineStr"===w||v.indexOf("<is>")>=0;W?C=this._getInlineString(v):v.indexOf("<v>")>-1&&(C=v.substring(v.indexOf("<v>")+3,v.indexOf("</v>")));var T=null,F=null,A=null;if(v.indexOf("<f")>-1)if(v.indexOf("</f>")>-1)(T=v.match(/<f.*>.+(?=<\/f>)/))&&(T=T[0].replace(/(\<f.*>)(.+)/,"$2"));else if(F=this._getAttr(v,"si")){A=this._getAttr(v,"r");T=this._getSharedFormula(F,A)}null!=T&&(T=T.replace(/\[\#This Row\]\s*,\s*/gi,"@"));"str"===w||"e"===w||W||(C=C?+C:C);p=this._alphaNum(this._getAttr(v,"r").match(/[a-zA-Z]*/g)[0]);var z=null;switch(w){case"s":if(null!=(C=this._sharedStrings[C]))if(wijmo_1.isString(C))g&&g.quotePrefix&&(C="'"+C);else{z=C.slice();C=this._getTextOfTextRuns(z)}break;case"b":C=1===C;break;case"date":C=C?this._convertDate(C):""}if(wijmo_1.isNumber(C)){null==_&&(_={format:""});wijmo_1.isInt(C)?_.format=_.format||"#,##0":_.format=_.format||"#,##0.00"}b.cells[p]={value:C,textRuns:z,isDate:"date"===w,isNumber:"number"===w,formula:Workbook._unescapeXML(T),style:_}}}var R=[],O=[];_=null;g=null;if(n.length>0&&n[0].indexOf("<cols>")>-1)for(var D=(R=n[0].substring(n[0].indexOf("<cols>")+6,n[0].indexOf("</cols>")).split("<col ")).length-1;D>0;D--){var B=this._parseCharWidthToPixel(+this._getAttr(R[D],"width"));g=null;R[D].indexOf("style")>-1&&(g=this._styles[+this._getAttr(R[D],"style")]||{type:"General",formatCode:null});_=null;g&&(g.font||g.fillColor||g.hAlign||g.vAlign||g.wordWrap||g.borders||g.formatCode&&"General"!==g.formatCode)&&(_={format:g.formatCode&&"General"!==g.formatCode?g.formatCode:null,font:g.font,fill:{color:g.fillColor},borders:g.borders,hAlign:g.hAlign,vAlign:g.vAlign,wordWrap:g.wordWrap});for(p=+this._getAttr(R[D],"min")-1;p<+this._getAttr(R[D],"max")&&p<a.maxCol;p++)O[p]={visible:"1"!==this._getAttr(R[D],"hidden"),autoWidth:"1"===this._getAttr(R[D],"bestFit"),width:B,style:_}}a.columns=O;var N,P=e.indexOf("<hyperlinks");if(P>-1)for(var j=e.substring(P,e.indexOf("</hyperlinks>")).split("<hyperlink "),M=j.length;--M;)this._getHyperlink(a,j[M]);if(a.frozenPane){if(!isNaN(a.frozenPane.rows))for(s=0;s<a.rows.length&&s<a.frozenPane.rows;s++)a.rows[s]&&!a.rows[s].visible&&a.frozenPane.rows++;if(!isNaN(a.frozenPane.columns))for(s=0;s<O.length&&s<a.frozenPane.columns;s++)O[s]&&!O[s].visible&&a.frozenPane.columns++}for(S=0;S<l.length;S++){N=l[S];a.rows[N.topRow]||(a.rows[N.topRow]={cells:[]});a.rows[N.topRow].cells||(a.rows[N.topRow].cells=[]);a.rows[N.topRow].cells[N.leftCol]||(a.rows[N.topRow].cells[N.leftCol]={});a.rows[N.topRow].cells[N.leftCol].rowSpan=N.bottomRow<a.maxRow?N.bottomRow-N.topRow+1:200;a.rows[N.topRow].cells[N.leftCol].colSpan=N.rightCol<a.maxCol?N.rightCol-N.leftCol+1:20}};_xlsx._getTable=function(e){var t={};t.name=this._getAttr(e,"name");t.range=this._getAttr(e,"ref");var o=this._getAttr(e,"headerRowCount");t.showHeaderRow=""==o||"1"===o;var r=this._getAttr(e,"totalsRowCount");t.showTotalRow="1"===r;var l=e.substring(e.indexOf("<tableStyleInfo")),i=this._getAttr(l,"name");this._isBuiltInStyleName(i)?t.style={name:i}:t.style=this._getTableStyleByName(i);t.showBandedColumns="1"===this._getAttr(l,"showColumnStripes");t.showBandedRows="1"===this._getAttr(l,"showRowStripes");t.alterFirstColumn="1"===this._getAttr(l,"showFirstColumn");t.alterLastColumn="1"===this._getAttr(l,"showLastColumn");var s=e.split("<tableColumn ");t.columns=[];for(var n=1;n<s.length;n++){var a=s[n];t.columns.push(this._getTableColumn(a))}if(e.indexOf("filterColumn")>-1)for(var h=e.substring(e.indexOf("<autoFilter"),e.indexOf("</autoFilter>")).split("<filterColumn"),u=1;u<h.length;u++){var f=h[u],c=+this._getAttr(f,"colId");t.columns[c].showFilterButton="1"!==this._getAttr(f,"hiddenButton")}return t};_xlsx._getTableColumn=function(e){var t={};t.name=this._getAttr(e,"name");var o=this._getAttr(e,"totalsRowLabel");if(o)t.totalRowLabel=o;else{var r=this._getAttr(e,"totalsRowFunction");"custom"===r&&(r=e.substring(e.indexOf("<totalsRowFormula>")+2+"totalsRowFormula".length,e.indexOf("</totalsRowFormula>")));t.totalRowFunction=r}return t};_xlsx._getSheetRelatedTable=function(e){var t=this._getAttr(e,"Target");t=t.substring(t.lastIndexOf("/")+1);for(var o=0;o<this._tables.length;o++){var r=this._tables[o];if(t===r.fileName)return r}return null};_xlsx._getSheetRelatedHyperlink=function(e,t,o){for(var r=0;r<o.hyperlinkRIds.length;r++){var l=o.hyperlinkRIds[r];if(l.rId===t){var i=this._getAttr(e,"Target");o.rows[l.ref.row]&&o.rows[l.ref.row].cells[l.ref.col]&&(o.rows[l.ref.row].cells[l.ref.col].link=i)}}};_xlsx._getTableStyles=function(e,t){for(var o=e.split("<tableStyle "),r=o.length;--r;){var l={},i=o[r];l.name=this._getAttr(i,"name");for(var s=i.split("<tableStyleElement "),n=s.length;--n;){var a=s[n],h=this._getAttr(a,"type");switch(h){case"firstRowStripe":h="firstBandedRowStyle";break;case"secondRowStripe":h="secondBandedRowStyle";break;case"firstColumnStripe":h="firstBandedColumnStyle";break;case"secondColumnStripe":h="secondBandedColumnStyle";break;default:h+="Style"}var u=this._getAttr(a,"dxfId");""!==u&&(l[h]=this._getTableStyleElement(t[+u+1]));var f=this._getAttr(a,"size");if(f){null==l[h]&&(l[h]={});l[h].size=+f}}this._tableStyles.push(l)}};_xlsx._getTableStyleElement=function(e){var t=null,o=null,r=null,l=null,i=e.indexOf("<font>");if(i>=0){t=e.substring(i,e.indexOf("</font>"));var s=this._getChildNodeValue(t,"sz");o={bold:"1"===this._getChildNodeValue(t,"b"),italic:"1"===this._getChildNodeValue(t,"i"),underline:"1"===this._getChildNodeValue(t,"u"),size:Math.round(s?96*+s/72:14),family:this._getChildNodeValue(t,"name"),color:this._getColor(t,!1)}}t=null;if((i=e.indexOf("<fill>"))>=0){t=e.substring(i,e.indexOf("</fill>"));r={color:this._getColor(t,!0)}}t=null;if((i=e.indexOf("<border>"))>=0){t=e.substring(i,e.indexOf("</border>"));l={left:this._getEdgeBorder(t,"left"),right:this._getEdgeBorder(t,"right"),top:this._getEdgeBorder(t,"top"),bottom:this._getEdgeBorder(t,"bottom"),vertical:this._getEdgeBorder(t,"vertical"),horizontal:this._getEdgeBorder(t,"horizontal")}}return{font:o,fill:r,borders:l}};_xlsx._getTableStyleByName=function(e){var t,o;if(null==this._tableStyles||0===this._tableStyles.length)return null;for(t=0;t<this._tableStyles.length;t++)if((o=this._tableStyles[t])&&o.name.toLowerCase()===e.toLowerCase())return o;return null};_xlsx._getHyperlink=function(e,t){var o,r,l,i,s,n;if(null!=(o=this._getAttr(t,"ref"))){l=o.split(":");null==(s=this._getAttr(t,"r:id"))&&(n=this._getAttr(t,"location"));for(var a=0;a<l.length;a++){r=l[a];i=Workbook.tableAddress(r);if(s){null==e.hyperlinkRIds&&(e.hyperlinkRIds=[]);e.hyperlinkRIds.push({ref:i,rId:s})}else n&&e.rows[i.row]&&e.rows[i.row].cells[i.col]&&(e.rows[i.row].cells[i.col].link=n)}}};_xlsx._getTextRunFont=function(e){var t,o=this._getChildNodeValue(e,"sz");return{bold:e.indexOf("<b/>")>=0||"true"===this._getChildNodeValue(e,"b"),italic:e.indexOf("<i/>")>=0||"true"===this._getChildNodeValue(e,"i"),underline:e.indexOf("<u/>")>=0||(t=this._getChildNodeValue(e,"u"))&&"none"!==t,size:Math.round(o?96*+o/72:14),family:this._getChildNodeValue(e,"name"),color:this._getColor(e,!1)}};_xlsx._getTextOfTextRuns=function(e){var t,o,r="";for(t=0;t<e.length;t++)(o=e[t])&&(r+=o.text);return r};_xlsx._isBuiltInStyleName=function(e){var t;if(0===e.search(/TableStyleLight/i)){t=+e.substring(15);if(!isNaN(t)&&t>=1&&t<=21)return!0}else if(0===e.search(/TableStyleMedium/i)){t=+e.substring(16);if(!isNaN(t)&&t>=1&&t<=28)return!0}else if(0===e.search(/TableStyleDark/i)){t=+e.substring(14);if(!isNaN(t)&&t>=1&&t<=11)return!0}return!1};_xlsx._generateRelsDoc=function(){return'<Relationships xmlns="'+this._relationshipsNS+'"><Relationship Target="docProps/app.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Id="rId3"/><Relationship Target="docProps/core.xml" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Id="rId2"/><Relationship Target="xl/workbook.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Id="rId1"/></Relationships>'};_xlsx._generateThemeDoc=function(){return'<a:theme name="Office Theme" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"><a:themeElements>'+this._generateClrScheme()+this._generateFontScheme()+this._generateFmtScheme()+"</a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>"};_xlsx._generateClrScheme=function(){null===this._colorThemes&&(this._colorThemes=[]);return'<a:clrScheme name="Office"><a:dk1><a:sysClr lastClr="'+(this._colorThemes[1]||"000000")+'" val="windowText"/></a:dk1><a:lt1><a:sysClr lastClr="'+(this._colorThemes[0]||"FFFFFF")+'" val="window"/></a:lt1><a:dk2><a:srgbClr val="'+(this._colorThemes[3]||"1F497D")+'"/></a:dk2><a:lt2><a:srgbClr val="'+(this._colorThemes[2]||"EEECE1")+'"/></a:lt2><a:accent1><a:srgbClr val="'+(this._colorThemes[4]||"4F81BD")+'"/></a:accent1><a:accent2><a:srgbClr val="'+(this._colorThemes[5]||"C0504D")+'"/></a:accent2><a:accent3><a:srgbClr val="'+(this._colorThemes[6]||"9BBB59")+'"/></a:accent3><a:accent4><a:srgbClr val="'+(this._colorThemes[7]||"8064A2")+'"/></a:accent4><a:accent5><a:srgbClr val="'+(this._colorThemes[8]||"4BACC6")+'"/></a:accent5><a:accent6><a:srgbClr val="'+(this._colorThemes[9]||"F79646")+'"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme>'};_xlsx._generateFontScheme=function(){return'<a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font typeface="ＭＳ Ｐゴシック" script="Jpan"/><a:font typeface="맑은 고딕" script="Hang"/><a:font typeface="宋体" script="Hans"/><a:font typeface="新細明體" script="Hant"/><a:font typeface="Times New Roman" script="Arab"/><a:font typeface="Times New Roman" script="Hebr"/><a:font typeface="Tahoma" script="Thai"/><a:font typeface="Nyala" script="Ethi"/><a:font typeface="Vrinda" script="Beng"/><a:font typeface="Shruti" script="Gujr"/><a:font typeface="MoolBoran" script="Khmr"/><a:font typeface="Tunga" script="Knda"/><a:font typeface="Raavi" script="Guru"/><a:font typeface="Euphemia" script="Cans"/><a:font typeface="Plantagenet Cherokee" script="Cher"/><a:font typeface="Microsoft Yi Baiti" script="Yiii"/><a:font typeface="Microsoft Himalaya" script="Tibt"/><a:font typeface="MV Boli" script="Thaa"/><a:font typeface="Mangal" script="Deva"/><a:font typeface="Gautami" script="Telu"/><a:font typeface="Latha" script="Taml"/><a:font typeface="Estrangelo Edessa" script="Syrc"/><a:font typeface="Kalinga" script="Orya"/><a:font typeface="Kartika" script="Mlym"/><a:font typeface="DokChampa" script="Laoo"/><a:font typeface="Iskoola Pota" script="Sinh"/><a:font typeface="Mongolian Baiti" script="Mong"/><a:font typeface="Times New Roman" script="Viet"/><a:font typeface="Microsoft Uighur" script="Uigh"/><a:font typeface="Sylfaen" script="Geor"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font typeface="ＭＳ Ｐゴシック" script="Jpan"/><a:font typeface="맑은 고딕" script="Hang"/><a:font typeface="宋体" script="Hans"/><a:font typeface="新細明體" script="Hant"/><a:font typeface="Arial" script="Arab"/><a:font typeface="Arial" script="Hebr"/><a:font typeface="Tahoma" script="Thai"/><a:font typeface="Nyala" script="Ethi"/><a:font typeface="Vrinda" script="Beng"/><a:font typeface="Shruti" script="Gujr"/><a:font typeface="DaunPenh" script="Khmr"/><a:font typeface="Tunga" script="Knda"/><a:font typeface="Raavi" script="Guru"/><a:font typeface="Euphemia" script="Cans"/><a:font typeface="Plantagenet Cherokee" script="Cher"/><a:font typeface="Microsoft Yi Baiti" script="Yiii"/><a:font typeface="Microsoft Himalaya" script="Tibt"/><a:font typeface="MV Boli" script="Thaa"/><a:font typeface="Mangal" script="Deva"/><a:font typeface="Gautami" script="Telu"/><a:font typeface="Latha" script="Taml"/><a:font typeface="Estrangelo Edessa" script="Syrc"/><a:font typeface="Kalinga" script="Orya"/><a:font typeface="Kartika" script="Mlym"/><a:font typeface="DokChampa" script="Laoo"/><a:font typeface="Iskoola Pota" script="Sinh"/><a:font typeface="Mongolian Baiti" script="Mong"/><a:font typeface="Arial" script="Viet"/><a:font typeface="Microsoft Uighur" script="Uigh"/><a:font typeface="Sylfaen" script="Geor"/></a:minorFont></a:fontScheme>'};_xlsx._generateFmtScheme=function(){return'<a:fmtScheme name="Office">'+this._generateFillScheme()+this._generateLineStyles()+this._generateEffectScheme()+this._generateBgFillScheme()+"</a:fmtScheme>"};_xlsx._generateFillScheme=function(){return'<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled="1" ang="16200000"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled="1" ang="16200000"/></a:gradFill></a:fillStyleLst>'};_xlsx._generateLineStyles=function(){return'<a:lnStyleLst><a:ln algn="ctr" cmpd="sng" cap="flat" w="9525"><a:solidFill><a:schemeClr val="phClr"><a:shade val="9500"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln algn="ctr" cmpd="sng" cap="flat" w="25400"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln algn="ctr" cmpd="sng" cap="flat" w="38100"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst>'};_xlsx._generateEffectScheme=function(){return'<a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot rev="0" lon="0" lat="0"/></a:camera><a:lightRig dir="t" rig="threePt"><a:rot rev="1200000" lon="0" lat="0"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst>'};_xlsx._generateBgFillScheme=function(){return'<a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst>'};_xlsx._generateCoreDoc=function(e){var t='<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">';e.creator?t+="<dc:creator>"+e.creator+"</dc:creator>":t+="<dc:creator/>";e.lastModifiedBy?t+="<cp:lastModifiedBy>"+e.lastModifiedBy+"</cp:lastModifiedBy>":t+="<cp:lastModifiedBy/>";return t+='<dcterms:created xsi:type="dcterms:W3CDTF">'+(e.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(e.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>"};_xlsx._generateSheetGlobalSetting=function(e,t,o){var r=t.rows&&t.rows[0]&&t.rows[0].cells?t.rows[0].cells.length:0,l=' xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">';l+='<sheetPr><outlinePr summaryBelow="0"/></sheetPr>';l+='<dimension ref="A1'+(r>0?":"+this._numAlpha(r-1)+t.rows.length:"")+'"/>';l+='<sheetViews><sheetView workbookViewId="0"';e===o.activeWorksheet&&(l+=' tabSelected="1"');if(!t.frozenPane||0===t.frozenPane.rows&&0===t.frozenPane.columns)l+="/>";else{l+=">";l+='<pane state="frozen" activePane="'+(0!==t.frozenPane.rows&&0!==t.frozenPane.columns?"bottomRight":0!==t.frozenPane.rows?"bottomLeft":"topRight")+'" topLeftCell="'+(this._numAlpha(t.frozenPane.columns)+(t.frozenPane.rows+1))+'" ySplit="'+t.frozenPane.rows.toString()+'" xSplit="'+t.frozenPane.columns.toString()+'"/>';l+="</sheetView>"}l+="</sheetViews>";return l+='<sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'};_xlsx._generateCell=function(e,t,o,r,l,i){var s='<c r="'+this._numAlpha(t)+(e+1)+'" s="'+o.toString()+'"';r&&(s+=' t="'+r+'"');var n="";if(i){"="===i[0]&&(i=i.substring(1));i=i.replace(/\@\s*/gi,"[#This Row], ");n+="<f>"+Workbook._escapeXML(i)+"</f>"}null!=l&&""!==l&&(n+="<v>"+l+"</v>");return s+(n?">"+n+"</c>":"/>")};_xlsx._generateMergeSetting=function(e){for(var t='<mergeCells count="'+e.length.toString()+'">',o=0;o<e.length;o++)t+='<mergeCell ref="'+e[o].join(":")+'"/>';return t+"</mergeCells>"};_xlsx._generateStyleDoc=function(){var e='<styleSheet xmlns="'+this._workbookNS+'" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac">',t="",o="",r=[],l=0,i=0,s="",n="";n=this._generateFontStyle({},!0);var a="",h="";h+=this._generateFillStyle("none",null);h+=this._generateFillStyle("gray125",null);var u="",f="";f+=this._generateBorderStyle({});var c="",d="";d+=this._generateCellXfs(0,0,0,0,{});for(;l<this._styles.length;){var m=this._styles[l];if(m){var p=0;if((m=JSON.parse(m)).format&&"General"!==m.format&&(p=this._numFmts.indexOf(m.format))<0){var _=r.indexOf(m.format);if(-1===_){r.push(m.format);o+='<numFmt numFmtId="'+(p=164+i).toString()+'" formatCode="'+m.format+'"/>';i++}else p=164+_}var g=0;if(m.borders){var b=JSON.stringify(m.borders);if((g=this._borders.indexOf(b))<0){g=this._borders.push(b)-1;f+=this._generateBorderStyle(m.borders)}}var y=0;if(m.font){var k=JSON.stringify(m.font);if((y=this._fonts.indexOf(k))<0){y=this._fonts.push(k)-1;n+=this._generateFontStyle(m.font)}}var x=0;if(m.fill&&m.fill.color){var S=JSON.stringify(m.fill);if((x=this._fills.indexOf(S))<0){x=this._fills.push(S)-1;h+=this._generateFillStyle("solid",m.fill.color)}}d+=this._generateCellXfs(p,g,y,x,m)}l++}r=null;if(i>0){t='<numFmts count="'+i+'">';t+=o;t+="</numFmts>"}else t='<numFmts count="0"/>';e+=t;s='<fonts count="'+this._fonts.length+'" x14ac:knownFonts="1">';s+=n;e+=s+="</fonts>";a='<fills count="'+this._fills.length+'">';a+=h;e+=a+="</fills>";u='<borders count="'+this._borders.length+'">';u+=f;e+=u+="</borders>";e+='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>';c='<cellXfs count="'+this._styles.length+'">';c+=d;c+="</cellXfs>";var v="",w="";if(this._tableStyles.length>0){this._getDxfs();this._dxfs.length>0&&(v=this._generateDxfs());w=this._generateTableStyles()}return e+=c+'<cellStyles count="1"><cellStyle xfId="0" builtinId="0" name="Normal"/></cellStyles>'+(""===v?'<dxfs count="0"/>':v)+(""===w?'<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16"/>':w)+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}"><x14ac:slicerStyles defaultSlicerStyle="SlicerStyleLight1" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"/></ext></extLst></styleSheet>'};_xlsx._generateBorderStyle=function(e,t){void 0===t&&(t=!1);var o,r,l="<border>";for(var i in{left:0,right:0,top:0,bottom:0,diagonal:0,vertical:0,horizontal:0})if(t||"vertical"!==i&&"horizontal"!==i){if(e[i]){o="<"+i+' style="'+e[i].style+'">';"";6===(r=(r=e[i].color)?"#"===r[0]?r.substring(1):r:"").length&&(r="FF"+r);r||(r="FF000000");o+='<color rgb="'+r+'"/>';o+="</"+i+">"}else o="<"+i+"/>";l+=o}return l+="</border>"};_xlsx._generateFontStyle=function(e,t){void 0===t&&(t=!1);var o="<font>";e.bold&&(o+="<b/>");e.italic&&(o+="<i/>");e.underline&&(o+="<u/>");o+='<sz val="'+(e.size?Math.round(72*e.size/96):this._defaultFontSize)+'"/>';e.color?o+='<color rgb="FF'+("#"===e.color[0]?e.color.substring(1):e.color)+'"/>':o+='<color theme="1"/>';o+='<name val="'+(e.family||this._defaultFontName)+'"/>';o+='<family val="2"/>';t&&(o+='<scheme val="minor"/>');return o+="</font>"};_xlsx._generateFillStyle=function(e,t,o){void 0===o&&(o=!1);var r,l='<fill><patternFill patternType="'+e+'">';if(t){r=o?"<bgColor ":"<fgColor ";l+=r+='rgb="FF'+("#"===t[0]?t.substring(1):t)+'"/>'}return l+="</patternFill></fill>"};_xlsx._generateCellXfs=function(e,t,o,r,l){var i='<xf xfId="0" ';i+='numFmtId="'+e.toString()+'" ';e>0&&(i+='applyNumberFormat="1" ');i+='borderId="'+t.toString()+'" ';t>0&&(i+='applyBorder="1" ');i+='fontId="'+o.toString()+'" ';o>0&&(i+='applyFont="1" ');i+='fillId="'+r.toString()+'" ';r>0&&(i+='applyFill="1" ');l.quotePrefix&&(i+='quotePrefix="1" ');if(l.hAlign||l.vAlign||l.indent||l.wordWrap){i+='applyAlignment="1">';var s="<alignment ";l.hAlign&&(s+='horizontal="'+l.hAlign+'" ');l.vAlign&&(s+='vertical="'+l.vAlign+'" ');l.indent&&(s+='indent="'+l.indent+'" ');l.wordWrap&&(s+='wrapText="1"');i+=s+="/>";i+="</xf>"}else i+="/>";return i};_xlsx._generateContentTypesDoc=function(){var e,t='<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';this._macroEnabled&&(t+='<Default ContentType="application/vnd.ms-office.vbaProject" Extension="bin"/>');t+='<Default ContentType="application/vnd.openxmlformats-package.relationships+xml" Extension="rels"/><Default ContentType="application/xml" Extension="xml"/><Override ContentType="'+(this._macroEnabled?"application/vnd.ms-excel.sheet.macroEnabled.main+xml":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml")+'" PartName="/xl/workbook.xml"/>';for(e=0;e<this._contentTypes.length;e++)t+=this._contentTypes[e];t+='<Override ContentType="application/vnd.openxmlformats-officedocument.theme+xml" PartName="/xl/theme/theme1.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" PartName="/xl/styles.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" PartName="/xl/sharedStrings.xml"/><Override ContentType="application/vnd.openxmlformats-package.core-properties+xml" PartName="/docProps/core.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" PartName="/docProps/app.xml"/>';for(e=0;e<this._tables.length;e++)t+='<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml" PartName="/xl/tables/'+this._tables[e]+'"/>';return t+="</Types>"};_xlsx._generateAppDoc=function(e){for(var t='<Properties xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes" xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>'+(e.application||"wijmo.xlsx")+'</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector baseType="variant" size="2"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+this._props.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector baseType="lpstr" size="'+this._props.length+'">',o=0;o<this._props.length;o++)t+="<vt:lpstr>"+this._props[o]+"</vt:lpstr>";return t+="</vt:vector></TitlesOfParts><Manager/><Company>"+(e.company||"GrapeCity, Inc.")+"</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>"};_xlsx._generateWorkbookRels=function(){for(var e='<Relationships xmlns="'+this._relationshipsNS+'">',t=0;t<this._xlRels.length;t++)e+=this._xlRels[t];e+='<Relationship Target="sharedStrings.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Id="rId'+(this._xlRels.length+1)+'"/><Relationship Target="styles.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Id="rId'+(this._xlRels.length+2)+'"/><Relationship Target="theme/theme1.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Id="rId'+(this._xlRels.length+3)+'"/>';this._macroEnabled&&(e+='<Relationship Target="vbaProject.bin" Type="http://schemas.microsoft.com/office/2006/relationships/vbaProject" Id="rId'+(this._xlRels.length+4)+'"/>');return e+="</Relationships>"};_xlsx._generateWorkbook=function(e){for(var t='<workbook xmlns="'+this._workbookNS+'" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion rupBuild="9303" lowestEdited="5" lastEdited="5" appName="xl"/><workbookPr/><bookViews><workbookView xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"'+(null!=e.activeWorksheet?' activeTab="'+e.activeWorksheet.toString()+'"':"")+"/></bookViews><sheets>",o=0;o<this._worksheets.length;o++)t+=this._worksheets[o];t+="</sheets>";if(e.definedNames&&e.definedNames.length>0){t+="<definedNames>";for(o=0;o<e.definedNames.length;o++){var r=-1;e.definedNames[o].sheetName&&(r=this._getSheetIndexBySheetName(e,e.definedNames[o].sheetName));t+='<definedName name="'+e.definedNames[o].name+'" '+(r>-1?'localSheetId="'+r+'"':"")+">"+e.definedNames[o].value+"</definedName>"}t+="</definedNames>"}return t+='<calcPr fullCalcOnLoad="1"/></workbook>'};_xlsx._generateWorksheetRows=function(e,t,o,r,l,i,s,n,a,h){for(var u,f=this,_loop_2=function(d,m){if(s&&s.cancelled)return{value:void 0};if(n&&d-t>100&&Date.now()-e>100){setTimeout((function(){if(!s||!s.cancelled){a(Math.round((d+1)/o.length*100));f._generateWorksheetRows(Date.now(),d,o,r,l,i,s,n,a,h)}}),0);return{value:void 0}}var p=-1,_=o[d]&&o[d].cells?o[d].cells.length:0,g=null;i.sheetData+='<row x14ac:dyDescent="0.25" r="'+(d+1).toString()+'"';if(o[d]){o[d].height&&(i.sheetData+=' customHeight="1" ht="'+(72*+o[d].height/96).toString()+'"');o[d].groupLevel&&(i.sheetData+=' outlineLevel="'+o[d].groupLevel.toString()+'"');if(g=o[d].style?c._cloneStyle(o[d].style):null){(g=c._resolveStyleInheritance(g)).font&&g.font.color&&(g.font.color=c._parseColor(g.font.color));g.fill&&g.fill.color&&(g.fill.color=c._parseColor(g.fill.color));null==g.hAlign||wijmo_1.isString(g.hAlign)||(g.hAlign=Workbook._parseHAlignToString(wijmo_1.asEnum(g.hAlign,HAlign)));null==g.vAlign||wijmo_1.isString(g.vAlign)||(g.vAlign=Workbook._parseVAlignToString(wijmo_1.asEnum(g.vAlign,VAlign)));var b=JSON.stringify(g);(W=c._styles.indexOf(b))<0&&(W=c._styles.push(b)-1);i.sheetData+=' customFormat="1" s="'+W.toString()+'"'}}o[d]&&!1===o[d].visible&&(i.sheetData+=' hidden="1"');o[d]&&!0===o[d].collapsed&&(i.sheetData+=' collapsed="1"');i.sheetData+=">";for(;++p<_;){var y=o[d].cells[p],k="",x=-1,S=y?y.textRuns:null,v=y&&y.hasOwnProperty("value")?y.value:y,w=y&&y.style?c._cloneStyle(y.style):{};w=c._resolveStyleInheritance(w);var C=l[p];if(C){C=c._resolveStyleInheritance(C);w=c._extend(w,C)}g&&(w=c._extend(w,g));if(r){r=c._resolveStyleInheritance(r);w=c._extend(w,r)}null==w.hAlign||wijmo_1.isString(w.hAlign)||(w.hAlign=Workbook._parseHAlignToString(wijmo_1.asEnum(w.hAlign,HAlign)));null==w.vAlign||wijmo_1.isString(w.vAlign)||(w.vAlign=Workbook._parseVAlignToString(wijmo_1.asEnum(w.vAlign,VAlign)));w.font&&w.font.color&&(w.font.color=c._parseColor(w.font.color));w.fill&&w.fill.color&&(w.fill.color=c._parseColor(w.fill.color));c._applyDefaultBorder(w);if(w.borders){w.borders=c._extend({},w.borders);c._parseBorder(w.borders,!!w.fill&&!!w.fill.color)}if(y&&y.isDate&&!wijmo_1.isDate(v)){u=new Date(v);wijmo_1.isDate(u)&&(v=u)}!wijmo_1.isNumber(v)||!isNaN(v)&&isFinite(v)||(v=v.toString());if(S||v&&wijmo_1.isString(v)&&("@"===w.format||"General"===w.format||(+v).toString()!==v||!isFinite(+v))){c._sharedStrings[1]++;if("'"===(v=S?"{RichTextMark}"+JSON.stringify(S):Workbook._unescapeXML(v))[0]){w.quotePrefix=!0;v=v.substring(1)}(x=c._sharedStrings[0].indexOf(v))<0&&(x=c._sharedStrings[0].push(v)-1);v=x;k="s"}else if(wijmo_1.isBoolean(v)){v=v?1:0;k="b"}else if(wijmo_1.isDate(v)){v=c._convertDate(v);w.format=w.format||"mm-dd-yy"}else wijmo_1.isObject(v)&&(v=null);var W;b=JSON.stringify(w);(W=c._styles.indexOf(b))<0&&(W=c._styles.push(b)-1);if(y&&(null!=y.colSpan&&y.colSpan>1||null!=y.rowSpan&&y.rowSpan>1)){y.colSpan=y.colSpan||1;y.rowSpan=y.rowSpan||1;c._checkValidMergeCell(i.merges,d,y.rowSpan,p,y.colSpan)&&i.merges.push([c._numAlpha(p)+(d+1),c._numAlpha(p+y.colSpan-1)+(d+y.rowSpan)])}if(y&&y.link){null==i.hyperlinks&&(i.hyperlinks=[]);i.hyperlinks.push({ref:Workbook.xlsxAddress(d,p),value:v,href:y.link})}w=null;i.sheetData+=c._generateCell(d,p,W,k,v,y&&y.formula?y.formula:null)}i.sheetData+="</row>"},c=this,d=t,m=o.length;d<m;d++){var p=_loop_2(d);if("object"==typeof p)return p.value}wijmo_1.isFunction(h)&&h()};_xlsx._generateWorkSheet=function(e,t,o,r,l,i){var s=this,n=t.sheets[e];if(!n)throw"Worksheet should not be empty!";i(0);var a=new _SyncPromise(r),h=n.columns,u=this._cloneColumnsStyle(h),f=n.style?this._cloneStyle(n.style):null,c='<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"'+this._generateSheetGlobalSetting(e,n,t),d={hyperlinks:[],merges:[],sheetData:"<sheetData>"};this._generateWorksheetRows(Date.now(),0,n.rows,f,u,d,r,l,i,(function(){var t=e+1,r=1;d.sheetData+="</sheetData>";if(h&&h.length>0){c+="<cols>";for(var l=0;l<h.length;l++){var f=-1;if(!s._isEmpty(u[l])){var m=u[l];if(m){(m=s._resolveStyleInheritance(m)).font&&m.font.color&&(m.font.color=s._parseColor(m.font.color));m.fill&&m.fill.color&&(m.fill.color=s._parseColor(m.fill.color));null==m.hAlign||wijmo_1.isString(m.hAlign)||(m.hAlign=Workbook._parseHAlignToString(wijmo_1.asEnum(m.hAlign,HAlign)));null==m.vAlign||wijmo_1.isString(m.vAlign)||(m.vAlign=Workbook._parseVAlignToString(wijmo_1.asEnum(m.vAlign,VAlign)));var p=JSON.stringify(m);(f=s._styles.indexOf(p))<0&&(f=s._styles.push(p)-1)}}if(!s._isEmpty(h[l])){var _=h[l].width;_=null!=_?"string"==typeof _&&_.indexOf("ch")>-1?s._parseCharCountToCharWidth(_.substring(0,_.indexOf("ch"))):s._parsePixelToCharWidth(_):8.43;var g=(l+1).toString();c+='<col min="'+g+'" max="'+g+'"';f>=0&&(c+=' style="'+f.toString()+'"');_&&(c+=' width="'+_+'" customWidth="1"');!1!==h[l].autoWidth&&(c+=' bestFit="1"');!1===h[l].visible&&(c+=' hidden="1"');c+="/>"}}c+="</cols>"}d.sheetData=c+d.sheetData;c=d.sheetData;d.sheetData=null;d.merges.length>0&&(c+=s._generateMergeSetting(d.merges));var b=d.hyperlinks;if(b&&b.length>0){c+="<hyperlinks>";for(l=0;l<b.length;l++)if(/\'?(\w+)\'?\!\$?[A-Za-z]{1,2}\$?\d+(:\$?[A-Za-z]{1,2}\$?\d+)?/.test(b[l].href)||/^\$?[A-Za-z]{1,2}\$?\d+(:\$?[A-Za-z]{1,2}\$?\d+)?$/.test(b[l].href))c+='<hyperlink ref="'+b[l].ref+'" display="'+b[l].value+'" location="'+b[l].href+'"/>';else{null==n.externalLinks&&(n.externalLinks=[]);n.externalLinks.push(b[l].href);c+='<hyperlink ref="'+b[l].ref+'" r:id="rId'+r+'"/>';r++}c+="</hyperlinks>"}c+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';if(n.tables&&n.tables.length>0){c+='<tableParts count="'+n.tables.length+'">';for(l=0;l<n.tables.length;l++){c+='<tablePart r:id="rId'+r+'"/>';r++}c+="</tableParts>"}c+="</worksheet>";o.file("sheet"+t+".xml",s._xmlDescription+c);c=null;var y='<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" PartName="/xl/worksheets/sheet'+t+'.xml"/>';s._contentTypes.unshift(y);s._props.unshift(Workbook._escapeXML(n.name)||"Sheet"+t);var k='<Relationship Target="worksheets/sheet'+t+'.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Id="rId'+t+'"/>';s._xlRels.unshift(k);var x='<sheet r:id="rId'+t+'" sheetId="'+t+'" name="'+(Workbook._escapeXML(n.name)||"Sheet"+t)+'"'+(!1===n.visible?' state="hidden"':"")+"/>";s._worksheets.unshift(x);i(100);a.resolve()}));return a};_xlsx._generateSharedStringsDoc=function(){var e,t='<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+this._sharedStrings[1]+'" uniqueCount="'+this._sharedStrings[0].length+'">';for(e=0;e<this._sharedStrings[0].length;e++){t+="<si>";var o=this._sharedStrings[0][e];if(o&&0===o.indexOf("{RichTextMark}"))try{var r=JSON.parse(o.substring(14));if(r&&r.length>0){for(var l=0;l<r.length;l++){t+="<r>";var i=r[l];i.font&&(t+=this._generateFontStyle(i.font,!0).replace(/font/g,"rPr"));t+=this._generatePlainText(i.text);t+="</r>"}t+="</si>"}}catch(e){t+=this._generatePlainText(o)+"</si>"}else t+=this._generatePlainText(o)+"</si>"}return t+"</sst>"};_xlsx._generatePlainText=function(e){if(""===e)return"<t/>";var t="<t";(wijmo_1.isNullOrWhiteSpace(e)||/^\s+\w*|\w*\s+$/.test(e))&&(t+=' xml:space="preserve"');return t+=">"+Workbook._escapeXML(e)+"</t>"};_xlsx._generateTable=function(e,t){var o=this._tables.length+1,r="table"+o+".xml";e.fileName=r;this._tables.push(r);var l='<table ref="'+e.range+'" displayName="'+e.name+'" name="'+e.name+'" id="'+o+'" '+(!1===e.showHeaderRow?'headerRowCount="0" ':"")+(!0===e.showTotalRow?'totalsRowCount="1" ':'totalsRowShown="0" ')+' xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';!1!==e.showHeaderRow&&(l+=this._generateTableFilterSetting(e.range,e.showTotalRow,e.columns));l+='<tableColumns count="'+e.columns.length+'">';for(var i="",s=0;s<e.columns.length;s++){var n=e.columns[s];i+='<tableColumn name="'+n.name+'" id="'+(s+1)+'" ';n.totalRowFunction?this._tableColumnFunctions.indexOf(n.totalRowFunction)>-1?i+='totalsRowFunction="'+n.totalRowFunction+'"/>':i+='totalsRowFunction="custom"><totalsRowFormula>'+n.totalRowFunction+"</totalsRowFormula></tableColumn>":i+=(n.totalRowLabel?'totalsRowLabel="'+n.totalRowLabel+'"':"")+"/>"}l+=i+"</tableColumns>";l+='<tableStyleInfo name="'+e.style.name+'" showColumnStripes="'+(e.showBandedColumns?"1":"0")+'" showRowStripes="'+(e.showBandedRows?"1":"0")+'" showLastColumn="'+(e.alterLastColumn?"1":"0")+'" showFirstColumn="'+(e.alterFirstColumn?"1":"0")+'"/></table>';if(!this._isBuiltInStyleName(e.style.name)){var a=JSON.stringify(e.style);-1===this._tableStyles.indexOf(a)&&this._tableStyles.push(a)}t.file(r,this._xmlDescription+l);l=null};_xlsx._generateTableFilterSetting=function(e,t,o){var r=e;if(t){var l=r.indexOf(":")+1,i=Workbook.tableAddress(r.substring(r.indexOf(":")+1));i.row-=1;r=r.substring(0,l)+Workbook.xlsxAddress(i.row,i.col)}for(var s='<autoFilter ref="'+r+'"',n="",a=0;a<o.length;a++)!1===o[a].showFilterButton&&(n+='<filterColumn hiddenButton="1" colId="'+a+'"/>');return s+=""===n?"/>":">"+n+"</autoFilter>"};_xlsx._generateHyperlinkRel=function(e){for(var t="",o=0;o<e.length;o++)t+='<Relationship TargetMode="External" Target="'+e[o]+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Id="rId'+(o+1)+'"/>';return t};_xlsx._getDxfs=function(){for(var e,t=this,o=0;o<this._tableStyles.length;o++){e=JSON.parse(this._tableStyles[o]);Object.keys(e).forEach((function(o){var r,l,i=e[o];if(i&&!wijmo_1.isString(i)&&!t._isEmptyStyleEle(i)){r=JSON.stringify(i);if(-1===(l=t._dxfs.indexOf(r))){l=t._dxfs.push(r)-1;i.styleIndex=l}}}));this._tableStyles[o]=e}};_xlsx._generateDxfs=function(){for(var e,t='<dxfs count="'+this._dxfs.length+'">',o=0;o<this._dxfs.length;o++){t+="<dxf>";(e=JSON.parse(this._dxfs[o])).font&&(t+=this._generateFontStyle(e.font));e.fill&&e.fill.color&&(t+=this._generateFillStyle("solid",e.fill.color,!0));if(e.borders&&!this._isEmpty(e.borders)){e.borders=this._extend({},e.borders);this._parseBorder(e.borders,!1);t+=this._generateBorderStyle(e.borders,!0)}t+="</dxf>"}return t+="</dxfs>"};_xlsx._generateTableStyles=function(){for(var e,t,o,r,l,i,s='<tableStyles count="'+this._tableStyles.length+'" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16">',n=0;n<this._tableStyles.length;n++){e=this._tableStyles[n];t=Object.keys(e);l="";i=0;for(var a=0;a<t.length;a++){r=e[o=t[a]];if(!wijmo_1.isString(r)){i++;l+="<tableStyleElement";null!=r.styleIndex&&(l+=' dxfId="'+r.styleIndex+'"');switch(o){case"firstBandedColumnStyle":l+=' type="firstColumnStripe"';null!=r.size&&(l+=' size="'+r.size+'"');break;case"secondBandedColumnStyle":l+=' type="secondColumnStripe"';null!=r.size&&(l+=' size="'+r.size+'"');break;case"firstBandedRowStyle":l+=' type="firstRowStripe"';null!=r.size&&(l+=' size="'+r.size+'"');break;case"secondBandedRowStyle":l+=' type="secondRowStripe"';null!=r.size&&(l+=' size="'+r.size+'"');break;default:l+=' type="'+o.substring(0,o.length-5)+'"'}l+="/>"}}if(i>0){s+='<tableStyle count="'+i+'" name="'+e.name+'" pivot="0">';s+=l+"</tableStyle>"}}return s+="</tableStyles>"};_xlsx._isEmptyStyleEle=function(e){return this._isEmpty(e.borders)&&(this._isEmpty(e.fill)||wijmo_1.isNullOrWhiteSpace(e.fill.color))&&(this._isEmpty(e.font)||!0!==e.font.bold&&wijmo_1.isNullOrWhiteSpace(e.font.color)&&wijmo_1.isNullOrWhiteSpace(e.font.family)&&!0!==e.font.italic&&null==e.font.size&&!0!==e.font.underline)};_xlsx._getTableFileName=function(e,t){for(var o="",r=0;r<e.length;r++){var l=e[r];if(l.name===t){o=l.fileName;break}}return o};_xlsx._getColor=function(e,t){var o,r,l,i,s;if(-1===e.search(/fgcolor/i)&&-1===e.search(/bgcolor/i)&&t||-1===e.search(/color/i)&&!t)return null;-1===(o=e.indexOf("<fgColor"))&&(o=e.indexOf("<bgColor"));if(-1!==(e=t?e.substring(o,e.indexOf("/>")):e.substring(e.indexOf("<color"))).indexOf("rgb="))(i=this._getAttr(e,"rgb"))&&8===i.length&&(i=i.substring(2));else if(-1!==e.indexOf("indexed")){l=+this._getAttr(e,"indexed");i=this._indexedColors[l]||""}else if(-1!==e.indexOf("auto")&&"1"===this._getAttr(e,"auto"))i="#000000";else{r=+this._getAttr(e,"theme");-1!==e.indexOf("tint")&&(s=+this._getAttr(e,"tint"));i=this._getThemeColor(r,s)}return i&&"#"===i[0]?i:"#"+i};_xlsx._getThemeColor=function(e,t){var o,r=this._colorThemes[e];if(null!=t){(o=new wijmo_1.Color("#"+r).getHsl())[2]=t<0?o[2]*(1+t):o[2]*(1-t)+(1-1*(1-t));return wijmo_1.Color.fromHsl(o[0],o[1],o[2]).toString().substring(1)}return r};_xlsx._parseColor=function(e){var t=new wijmo_1.Color(e);t.a<1&&(t=wijmo_1.Color.toOpaque(t));return t.toString()};_xlsx._getsBaseSharedFormulas=function(e){var t,o,r,l=e.match(/\<f[^<]*ref[^<]*>[^<]+(?=\<\/f>)/g);this._sharedFormulas=[];if(l&&l.length>0)for(var i=0;i<l.length;i++){t=l[i];o=this._getAttr(t,"si");r=(r=this._getAttr(t,"ref"))?r.substring(0,r.indexOf(":")):"";t=t.replace(/(\<f.*>)(.+)/,"$2");this._sharedFormulas[+o]=this._parseSharedFormulaInfo(r,t)}};_xlsx._parseSharedFormulaInfo=function(e,t){var o,r,l,i,s,n=t.match(/(\'?\w+\'?\!)?(\$?[A-Za-z]+)(\$?\d+)/g);i=Workbook.tableAddress(e);if(n&&n.length>0){s=[];for(var a=0;a<n.length;a++){o=n[a];t=t.replace(o,"{"+a+"}");if((r=o.indexOf("!"))>0){l=o.substring(0,r);o=o.substring(r+1)}s[a]={cellAddress:Workbook.tableAddress(o),sheetRef:l}}}return{cellRef:i,formula:t,formulaRefs:s}};_xlsx._getSharedFormula=function(e,t){var o,r,l,i,s,n,a,h,u,f,c,d;if(this._sharedFormulas&&this._sharedFormulas.length>0&&(o=this._sharedFormulas[+e])){u=o.formula;if((f=o.formulaRefs)&&f.length>0){r=Workbook.tableAddress(t);a=o.cellRef?o.cellRef.row:0;h=o.cellRef?o.cellRef.col:0;l=r.row-a;i=r.col-h;for(var m=0;m<f.length;m++){s=(c=f[m]).cellAddress.row+(c.cellAddress.absRow?0:l);n=c.cellAddress.col+(c.cellAddress.absCol?0:i);d=Workbook.xlsxAddress(s,n,c.cellAddress.absRow,c.cellAddress.absCol);null!=c.sheetRef&&""!==c.sheetRef&&(d=c.sheetRef+"!"+d);u=u.replace("{"+m+"}",d)}}return u}return""};_xlsx._convertDate=function(e){var t,o,r=new Date(1900,0,0),l=Date.UTC(1900,0,0),i="[object Date]"===Object.prototype.toString.call(e),s=6e4*((i?e.getTimezoneOffset():(new Date).getTimezoneOffset())-r.getTimezoneOffset()),n=r.getTime()-l-6e4*r.getTimezoneOffset();if(i)return(e.getTime()-r.getTime()-s+n)/864e5+1;if(wijmo_1.isNumber(e)){t=e>59?1:0;return 0!==(s=6e4*((o=new Date(1e3*Math.round((+r+864e5*(e-t))/1e3))).getTimezoneOffset()-r.getTimezoneOffset()))?new Date(1e3*Math.round((+r+s-n+864e5*(e-t))/1e3)):o}return null};_xlsx._parseBorder=function(e,t){for(var o in{left:0,right:0,top:0,bottom:0,diagonal:0}){var r=e[o];if(r){wijmo_1.isString(r.color)&&(r.color=this._parseColor(r.color));null==r.style||wijmo_1.isString(r.style)||(r.style=Workbook._parseBorderTypeToString(wijmo_1.asEnum(r.style,BorderStyle,!1)));!t&&r.color&&"#c6c6c6"===r.color.toLowerCase()&&"thin"===r.style&&(e[o]=null)}}};_xlsx._applyDefaultBorder=function(e){if(e.fill&&e.fill.color){null==e.borders&&(e.borders={});for(var t in{left:0,right:0,top:0,bottom:0})null==e.borders[t]&&(e.borders[t]={style:BorderStyle.Thin,color:"#C6C6C6"})}};_xlsx._resolveStyleInheritance=function(e){var t;if(!e.basedOn)return e;for(var o in e.basedOn)if("basedOn"===o){t=this._resolveStyleInheritance(e.basedOn);for(o in t){var r=t[o];e[o]=null==e[o]?r:this._extend(e[o],r)}}else{r=e.basedOn[o];e[o]=null==e[o]?r:this._extend(e[o],r)}delete e.basedOn;return e};_xlsx._parsePixelToCharWidth=function(e){return null==e||isNaN(+e)?null:((+e-5)/7*100+.5)/100};_xlsx._parseCharWidthToPixel=function(e){return null==e||isNaN(+e)?null:Math.floor((256*+e+128/7)/256*7)+5};_xlsx._parseCharCountToCharWidth=function(e){return null==e||isNaN(+e)?null:(7*+e+5)/7*256/256};_xlsx._numAlpha=function(e){var t=Math.floor(e/26)-1;return(t>-1?this._numAlpha(t):"")+this._alphabet.charAt(e%26)};_xlsx._alphaNum=function(e){return e.length>1?(this._alphabet.indexOf(e[0])+1)*Math.pow(26,e.length-1)+this._alphaNum(e.substring(1)):this._alphabet.indexOf(e)};_xlsx._typeOf=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};_xlsx._extend=function(e,t){if(wijmo_1.isObject(e)&&wijmo_1.isObject(t)){for(var o in t){var r=t[o];wijmo_1.isObject(r)&&null!=e[o]?this._extend(e[o],r):null!=r&&null==e[o]&&(e[o]=r)}return e}return t};_xlsx._isEmpty=function(e){var t=Object.prototype.hasOwnProperty;if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var o in e)if(t.call(e,o))return!1;return!0};_xlsx._cloneStyle=function(e){var t;if(null==e||"object"!=typeof e)return e;t={};for(var o in e)e.hasOwnProperty(o)&&(t[o]=this._cloneStyle(e[o]));return t};_xlsx._cloneColumnsStyle=function(e){for(var t,o=[],r=0;r<e.length;r++)(t=e[r])&&t.style&&(o[r]=this._cloneStyle(t.style));return o};_xlsx._getSheetIndex=function(e){return+(e=e.substring(0,e.lastIndexOf(".xml"))).substring(e.lastIndexOf("sheet")+5)};_xlsx._checkValidMergeCell=function(e,t,o,r,l){for(var i=0;i<e.length;i++){var s=e[i],n=+s[0].match(/\d*/g).join("")-1,a=this._alphaNum(s[0].match(/[a-zA-Z]*/g)[0]),h=+s[1].match(/\d*/g).join("")-1,u=this._alphaNum(s[1].match(/[a-zA-Z]*/g)[0]);if(!(t>h||t+o-1<n||r>u||r+l-1<a))return!1}return!0};_xlsx._getAttr=function(e,t){var o=e.indexOf(t+'="');return o>=0?(e=e.substr(o+t.length+2)).substring(0,e.indexOf('"')):""};_xlsx._getChildNodeValue=function(e,t){var o=e.indexOf(t+' val="');return o>=0?(e=e.substr(o+t.length+6)).substring(0,e.indexOf('"')):""};_xlsx._getSheetIndexBySheetName=function(e,t){for(var o=0;o<e.sheets.length;o++)if(e.sheets[o].name===t)return o;return-1};_xlsx._alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";_xlsx._indexedColors=["000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","800000","008000","000080","808000","800080","008080","C0C0C0","808080","9999FF","993366","FFFFCC","CCFFFF","660066","FF8080","0066CC","CCCCFF","000080","FF00FF","FFFF00","00FFFF","800080","800000","008080","0000FF","00CCFF","CCFFFF","CCFFCC","FFFF99","99CCFF","FF99CC","CC99FF","FFCC99","3366FF","33CCCC","99CC00","FFCC00","FF9900","FF6600","666699","969696","003366","339966","003300","333300","993300","993366","333399","333333","000000","FFFFFF"];_xlsx._numFmts=["General","0","0.00","#,##0","#,##0.00",,,"$#,##0.00_);($#,##0.00)",,"0%","0.00%","0.00E+00","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"];_xlsx._tableColumnFunctions="average, count, countNums, max, min, stdDev, sum, var";_xlsx._xmlDescription='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';_xlsx._workbookNS="http://schemas.openxmlformats.org/spreadsheetml/2006/main";_xlsx._relationshipsNS="http://schemas.openxmlformats.org/package/2006/relationships";_xlsx._defaultFontName="Calibri";_xlsx._defaultFontSize=11;_xlsx._macroEnabled=!1;_xlsx._defaultColorThemes=["FFFFFF","000000","EEECE1","1F497D","4F818D","C0504D","9BBB59","8064A2","4BACC6","F79646"];return _xlsx}();exports._xlsx=_xlsx;var _JSZipSyncPromise=function(){function _JSZipSyncPromise(e){this.value=e}_JSZipSyncPromise.prototype.then=function(e,t){return new _JSZipSyncPromise(e?e(this.value):null)};_JSZipSyncPromise.prototype.catch=function(e){return this.then(null,e)};_JSZipSyncPromise.resolve=function(){return new _JSZipSyncPromise};return _JSZipSyncPromise}(),_JsZipWrapper=function(){function _JsZipWrapper(e){this._obj=e}_JsZipWrapper.prototype.loadAsync=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=(e=this._obj).load.apply(e,t);return new _JSZipSyncPromise(this._wrapOrNull(r))};_JsZipWrapper.prototype.file=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=(e=this._obj).file.apply(e,t);return this._wrapOrNull(r)};Object.defineProperty(_JsZipWrapper.prototype,"name",{get:function(){return this._obj.name},enumerable:!0,configurable:!0});_JsZipWrapper.prototype.async=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e=t&&t.length>0&&"uint8array"===t[0].toLowerCase()?this._obj.asUint8Array():this._obj.asText();return new _JSZipSyncPromise(e)};_JsZipWrapper.prototype.folder=function(e){var t=this._obj.folder(e);return this._wrapOrNull(t)};_JsZipWrapper.prototype.forEach=function(e){var t=this._obj.root,o=t.length,r=this._obj.files;for(var l in r)l.length>o&&l.substr(0,o).toLowerCase()===t&&e(l.substr(o),new _JsZipWrapper(r[l]))};_JsZipWrapper.prototype._wrapOrNull=function(e){return null!=e?new _JsZipWrapper(e):null};return _JsZipWrapper}(),_SyncPromise=function(){function _SyncPromise(e,t){this._callbacks=[];this._cs=e;this._onCancel=t}_SyncPromise.serial=function(e,t){t=t.slice();var o=new _SyncPromise(e),r=[],drain=function(){o.cancelled?t=[]:t.length?t.shift()().then((function(e){r.push(e);drain()}),(function(e){t=[];o.reject(e)})):o.resolve(r)};drain();return o};_SyncPromise.prototype.cancel=function(e){void 0===e&&(e=!0);this._cancelled=!0;e&&this._onCancel&&this._onCancel()};Object.defineProperty(_SyncPromise.prototype,"cancelled",{get:function(){return this._cancelled||this._cs&&this._cs.cancelled},enumerable:!0,configurable:!0});_SyncPromise.prototype.then=function(e,t){this._callbacks.push({onFulfilled:e,onRejected:t});this._resolved&&this.resolve(this._resolved.value);return this};_SyncPromise.prototype.catch=function(e){return this.then(null,e)};_SyncPromise.prototype.resolve=function(e){if(this.cancelled)return this;this._resolved={value:e};try{this.onFulfilled(e)}catch(e){this.onRejected(e)}return this};_SyncPromise.prototype.reject=function(e){if(this.cancelled)return this;this.onRejected(e);return this};_SyncPromise.prototype.onFulfilled=function(e){for(;this._callbacks.length;){var t=this._callbacks[0];t.onFulfilled&&t.onFulfilled(e);this._callbacks.shift()}};_SyncPromise.prototype.onRejected=function(e){for(var t;t=this._callbacks.shift();)t.onRejected&&t.onRejected(e)};return _SyncPromise}();exports._SyncPromise=_SyncPromise;function _map(e,t,o,r,l){var i=o-t;0==i&&(i=1);return(e-t)*((l-r)/i)+r}exports._map=_map;wijmo_1._registerModule("wijmo.xlsx",selfModule);