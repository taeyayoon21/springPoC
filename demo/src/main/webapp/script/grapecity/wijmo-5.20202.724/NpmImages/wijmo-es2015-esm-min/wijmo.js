/*!
    *
    * Wijmo Library 5.20202.724
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

import*as selfModule from"wijmo/wijmo";const _agent="undefined"!=typeof navigator?navigator.userAgent:"",_isMobile=null!=_agent.match(/iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone/i);export function isMobile(){return _isMobile}const _isiOS=null!=_agent.match(/iPad|iPhone|iPod/i);export function isiOS(){return _isiOS}const _isFF=null!=_agent.match(/Firefox\//);export function isFirefox(){return _isFF}const _isSafari=null!=_agent.match(/^((?!Chrome|Android).)*safari/i);export function isSafari(){return _isSafari}const _isEdge=null!=_agent.match(/Edge\//);export function isEdge(){return _isEdge}const _isIE=null!=_agent.match(/MSIE |Trident\/|Edge\//);export function isIE(){return _isIE}let _isIE9=!1;export function isIE9(){return _isIE9}let _isIE10=!1;export function isIE10(){return _isIE10}let _supportsPassive=!1;"undefined"!=typeof document&&document.addEventListener("test",t=>{},{get passive(){_supportsPassive=!0;return!0}});export function getEventOptions(t,e){return _supportsPassive?{capture:t,passive:e}:t}var _supportsFocusOptions=!1;"undefined"!=typeof document&&document.createElement("div").focus({get preventScroll(){_supportsFocusOptions=!0;return!0}});export function supportsFocusOptions(){return _supportsFocusOptions}export function _startDrag(t,e){t.effectAllowed=e;isFirefox()&&t.setData("text","")}if("undefined"!=typeof document&&document.doctype){navigator.appVersion.indexOf("MSIE 10")>-1&&(_isIE10=!0);if(navigator.appVersion.indexOf("MSIE 9")>-1){_isIE9=!0;document.addEventListener("mousemove",t=>{if(1==t.which){let e=closest(t.target,".wj-control");if(e&&!e.style.cursor)for(let e=t.target;e;e=e.parentElement)if(e.attributes&&e.attributes.draggable){e.dragDrop();return!1}}})}}if("undefined"!=typeof window){let t="requestAnimationFrame",e="cancelAnimationFrame";if(!window[t]){let i=0;window[t]=t=>{let e=Date.now(),s=16-(e-i),r=s>0?s:0;i=e+r;return setTimeout(()=>{t(i)},r)};window[e]=clearTimeout}if(!window.atob){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e=new RegExp("[^"+t+"]");window.atob=i=>{let s,r,n,o,a=[],l=0,h=i.length;if(e.test(i)||/=/.test(i)&&(/=[^=]/.test(i)||/={3}/.test(i)))throw new Error("Invalid base64 data");h%4>0&&(h=(i+=Array(4-h%4+1).join("=")).length);for(;l<h;){for(r=[],o=l;l<o+4;)r.push(t.indexOf(i.charAt(l++)));n=[((s=(r[0]<<18)+(r[1]<<12)+((63&r[2])<<6)+(63&r[3]))&255<<16)>>16,64===r[2]?-1:(65280&s)>>8,64===r[3]?-1:255&s];for(o=0;o<3;++o)(n[o]>=0||0===o)&&a.push(String.fromCharCode(n[o]))}return a.join("")};window.btoa=e=>{let i,s,r=[],n=0,o=e.length;for(;n<o;){i=((s=[e.charCodeAt(n++),e.charCodeAt(n++),e.charCodeAt(n++)])[0]<<16)+((s[1]||0)<<8)+(s[2]||0);r.push(t.charAt((i&63<<18)>>18),t.charAt((258048&i)>>12),t.charAt(isNaN(s[1])?64:(4032&i)>>6),t.charAt(isNaN(s[2])?64:63&i))}return r.join("")}}}const _getProxyTarget="undefined"!=typeof window&&window.Symbol?Symbol("_getProxyTarget"):"\t_get\tProxy\tTarget\t";export function _getCalculatedArray(t,e,i){let s=new WeakMap;if(!i){let e={};if(t.length){let s=t[0];for(let t in s){let i=typeof s[t];e[t]="string"==i?"":"number"==i?0:null}i=e}}return new Proxy(t,{get(t,r){if(r===_getProxyTarget)return t;if("string"==typeof r||"number"==typeof r){let n=parseInt(r);if(!isNaN(n)){let r=t[n];if(r&&!r[_getProxyTarget]){let t=s.get(r);if(!t){t=_createItemProxy(r,e,i);s.set(r,t)}r=t}return r}}return Reflect.get(t,r)}})}function _createItemProxy(t,e,i){if(!t[_getProxyTarget]){if(isIE())for(let i in e)t[i]=null;let s={get:(t,s,r)=>{if(s===_getProxyTarget)return t;if("constructor"===s)return()=>Object.assign({},i||{});let n=e[s];if(n)switch(typeof n){case"function":return n(r);case"string":return _eval(n,r)}return t[s]}};if(!isIE()){s.ownKeys=t=>Object.keys(t).concat(Object.keys(e));s.getOwnPropertyDescriptor=(t,i)=>i in e?{enumerable:!0,configurable:!0,writable:!1}:Reflect.getOwnPropertyDescriptor(t,i)}t=new Proxy(t,s)}return t}function _eval(t,e){let i=[e];return new Function(...["$"],"return "+t)(...i)}export class Binding{constructor(t){this.path=t}get path(){return this._path}set path(t){this._path=t;this._parts=t?t.split("."):[];for(let t=0;t<this._parts.length;t++){let e=this._parts[t],i=e.indexOf("[");if(i>-1){this._parts[t]=e.substr(0,i);this._parts.splice(++t,0,parseInt(e.substr(i+1)))}}this._key=1==this._parts.length?this._parts[0]:null}getValue(t){if(t){if(this._key)return t[this._key];if(this._path&&this._path in t)return t[this._path];for(let e=0;e<this._parts.length&&t;e++)t=t[this._parts[e]]}return t}setValue(t,e){if(t){if(this._path in t){t[this._path]=e;return}for(let e=0;e<this._parts.length-1;e++)if(null==(t=t[this._parts[e]]))return;t[this._parts[this._parts.length-1]]=e}}}class EventHandler{constructor(t,e){this.handler=t;this.self=e}}export class Event{constructor(t){this._handlers=[];this._handlersChanged=t}addHandler(t,e){t=asFunction(t);this._handlers.push(new EventHandler(t,e));isFunction(this._handlersChanged)&&this._handlersChanged()}removeHandler(t,e){let i=!1;t=asFunction(t);for(let s=0;s<this._handlers.length;s++){let r=this._handlers[s];if(!(r.handler!=t&&null!=t||r.self!=e&&null!=e)){this._handlers.splice(s,1);i=!0;if(t&&e)break}}i&&isFunction(this._handlersChanged)&&this._handlersChanged()}removeAllHandlers(){let t=this._handlers.length>0;this._handlers.length=0;t&&isFunction(this._handlersChanged)&&this._handlersChanged()}raise(t,e=EventArgs.empty){let i=this._handlers;for(let s=0;s<i.length;s++){let r=i[s];r.handler.call(r.self,t,e);i[s]!==r&&s--}}get hasHandlers(){return this._handlers.length>0}get handlerCount(){return this._handlers.length}}export class EventArgs{}EventArgs.empty=new EventArgs;export class CancelEventArgs extends EventArgs{constructor(){super(...arguments);this.cancel=!1}}export class PropertyChangedEventArgs extends EventArgs{constructor(t,e,i){super();this._name=t;this._oldVal=e;this._newVal=i}get propertyName(){return this._name}get oldValue(){return this._oldVal}get newValue(){return this._newVal}}export class RequestErrorEventArgs extends CancelEventArgs{constructor(t,e){super();this._xhr=t;this._msg=e}get request(){return this._xhr}get message(){return this._msg}set message(t){this._msg=t}}export var NotifyCollectionChangedAction;!function(t){t[t.Add=0]="Add";t[t.Remove=1]="Remove";t[t.Change=2]="Change";t[t.Reset=3]="Reset"}(NotifyCollectionChangedAction||(NotifyCollectionChangedAction={}));export class NotifyCollectionChangedEventArgs extends EventArgs{constructor(t=NotifyCollectionChangedAction.Reset,e=null,i=-1){super();this.action=t;this.item=e;this.index=i}}NotifyCollectionChangedEventArgs.reset=new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset);export class SortDescription{constructor(t,e){this._bnd=new Binding(t);this._asc=e}get property(){return this._bnd.path}get ascending(){return this._asc}}export class PageChangingEventArgs extends CancelEventArgs{constructor(t){super();this.newPageIndex=t}}export class GroupDescription{groupNameFromItem(t,e){return""}namesMatch(t,e){return t===e}}export class PropertyGroupDescription extends GroupDescription{constructor(t,e){super();this._bnd=new Binding(t);this._converter=e}get propertyName(){return this._bnd.path}groupNameFromItem(t,e){return this._converter?this._converter(t,this.propertyName):this._bnd.getValue(t)}namesMatch(t,e){return t===e}}var _VERSION="5.20202.724";export function getVersion(){return _VERSION}export function setLicenseKey(t){Control._licKey=t}export var Key;!function(t){t[t.Back=8]="Back";t[t.Tab=9]="Tab";t[t.Enter=13]="Enter";t[t.Escape=27]="Escape";t[t.Space=32]="Space";t[t.PageUp=33]="PageUp";t[t.PageDown=34]="PageDown";t[t.End=35]="End";t[t.Home=36]="Home";t[t.Left=37]="Left";t[t.Up=38]="Up";t[t.Right=39]="Right";t[t.Down=40]="Down";t[t.Delete=46]="Delete";t[t.F1=112]="F1";t[t.F2=113]="F2";t[t.F3=114]="F3";t[t.F4=115]="F4";t[t.F5=116]="F5";t[t.F6=117]="F6";t[t.F7=118]="F7";t[t.F8=119]="F8";t[t.F9=120]="F9";t[t.F10=121]="F10";t[t.F11=122]="F11";t[t.F12=123]="F12"}(Key||(Key={}));export var DataType;!function(t){t[t.Object=0]="Object";t[t.String=1]="String";t[t.Number=2]="Number";t[t.Boolean=3]="Boolean";t[t.Date=4]="Date";t[t.Array=5]="Array"}(DataType||(DataType={}));export function tryCast(t,e){return null==t?null:isString(e)?isFunction(t.implementsInterface)&&t.implementsInterface(e)?t:null:t instanceof e?t:null}export function isPrimitive(t){return isString(t)||isNumber(t)||isBoolean(t)||isDate(t)}export function isString(t){return"string"==typeof t}export function isNullOrWhiteSpace(t){return!t||!/\S/.test(t)}export function isNumber(t){return"number"==typeof t}export function isInt(t){return isNumber(t)&&t==Math.round(t)}export function isBoolean(t){return"boolean"==typeof t}export function isFunction(t){return"function"==typeof t}export function isUndefined(t){return void 0===t}export function isDate(t){return(t instanceof Date||"[object Date]"===Object.prototype.toString.call(t))&&!isNaN(t.getTime())}export function isArray(t){return t instanceof Array||Array.isArray(t)||"[object Array]"===Object.prototype.toString.call(t)}export function isObject(t){return null!=t&&"object"==typeof t&&!isDate(t)&&!isArray(t)}export function isEmpty(t){for(var e in t)return!1;return!0}export function getUniqueId(t){let e=t;for(let i=0;null!=document.getElementById(e);i++)e=t+i;return e}export function mouseToPage(t){if(t instanceof Point)return t;t&&t.touches&&t.touches.length>0&&(t=t.touches[0]);if(isNumber(t.clientX)&&isNumber(t.clientY))return new Point(t.clientX+pageXOffset,t.clientY+pageYOffset);throw"Mouse or touch event expected."}export function getType(t){return isNumber(t)?DataType.Number:isBoolean(t)?DataType.Boolean:isDate(t)?DataType.Date:isString(t)?DataType.String:isArray(t)?DataType.Array:DataType.Object}export function getTypes(t){let e=[];if(t&&t.length>0){let i=t[0];for(let s in i){let i=null;for(let r=0;r<t.length&&r<1e3&&null==i;r++)if(isPrimitive(i=t[r][s])){let n=Object.getOwnPropertyDescriptor(t[r],s);e.push({binding:s,dataType:getType(i),isReadOnly:n&&!n.writable&&!n.set})}}}return e}export function changeType(t,e,i){if(null!=t){if(isString(t))switch(e){case DataType.Number:let e=Globalize.parseFloat(t,i);return isNaN(e)?t:e;case DataType.Date:let s=Globalize.parseDate(t,i);s||i||!t||(s=new Date(t));return s&&isFinite(s.getTime())?s:t;case DataType.Boolean:switch(t.toLowerCase()){case"true":return!0;case"false":return!1}return t}if(e==DataType.String)return Globalize.format(t,i)}return t}export function toFixed(t,e,i){if(i){let i=t.toString(),s=i.indexOf(".");if(i.indexOf("e")<0&&s>-1){i=i.substr(0,s+1+e);t=parseFloat(i)}}else{let i=t.toFixed(e);t=parseFloat(i)}return t}export function format(t,e,i){if((t=asString(t)).match(/\{.*"count".*:.*"when".*:.*\}/))try{let i=JSON.parse(t);if(isString(i.count)){let s=e[i.count],r=i.when;if(isNumber(s)&&isObject(r)){let e=r[s]||r.other;isString(e)&&(t=e)}}}catch(t){}return t.replace(/\{(.*?)(:(.*?))?\}/g,(t,s,r,n)=>{let o=t;if(s&&"{"!=s[0]&&e){o=new Binding(s).getValue(e);n&&(o=Globalize.format(o,n));i&&(o=i(e,s,n,o))}return null==o?"":o})}export function glbz(...t){let e=[],i=-1;t[0].forEach((s,r)=>{if(r>0&&r!=i){let n=t[r],o=s.match(/^:([a-z][0-9]*\b)/i)||s.match(/^:'(.+?)'/)||s.match(/^:"(.+?)"/);if(o){n=Globalize.format(n,o[1]);s=s.substr(o[0].length)}else if(":"==s&&r<t.length-1&&(isNumber(n)||isDate(n))){n=Globalize.format(n,t[r+1]);s="";i=r+1}e.push(n)}s&&e.push(s)});return e.join("")}export function evalTemplate(t,e){if(isIE()){let i=/:\${([^}]*)}/g,s=/\${([^}]*)}(:(([A-Za-z]\d*)|"([^"]+)"|'([^']+)'))?/g;return(t=t.replace(i,(t,i)=>":"+_evalExpression(i,e))).replace(s,(t,i,s,r,n,o,a)=>{let l=_evalExpression(i,e);return r?Globalize.format(l,n||o||a):l})}return _evalExpression(t,e)}function _evalExpression(t,e){(e=e||{}).glbz=glbz;let i=Object.keys(e),s=i.map(t=>e[t]);return(isIE()?new Function(...i,"return "+t):new Function(...i,"return glbz`"+t+"`"))(...s)}export function clamp(t,e,i){if(null!=t){null!=i&&t>i&&(t=i);null!=e&&t<e&&(t=e)}return t}export function copy(t,e){if(e)for(let i in e)if("_"!=i[0]){assert(i in t,'Unknown property "'+i+'".');let s=e[i];t._copy&&t._copy(i,s)||(t[i]instanceof Event?isFunction(s)&&t[i].addHandler(s):!isObject(s)||"undefined"!=typeof Element&&s instanceof Element||!t[i]||"itemsSource"==i?t[i]=s:copy(t[i],s))}return t}export function assert(t,e){if(!t){e="** Assertion failed in Wijmo: "+e;let t=new Error;isString(t.stack)&&(e+=" "+t.stack);throw e}}export function _deprecated(t,e){console.error('** WARNING: "'+t+'" has been deprecated; please use "'+e+'" instead.')}export function asString(t,e=!0){isUndefined(t)&&(t=null);assert(e&&null==t||isString(t),"String expected.");return t}export function asNumber(t,e=!1,i=!1){assert(e&&null==t||isNumber(t),"Number expected.");if(i&&t&&t<0)throw"Positive number expected.";return t}export function asInt(t,e=!1,i=!1){assert(e&&null==t||isInt(t),"Integer expected.");if(i&&t&&t<0)throw"Positive integer expected.";return t}export function asBoolean(t,e=!1){assert(e&&null==t||isBoolean(t),"Boolean expected.");return t}export function asDate(t,e=!1){if(isString(t)){let e=changeType(t,DataType.Date,"r");isDate(e)&&(t=e)}assert(e&&null==t||isDate(t),"Date expected.");return t}export function asFunction(t,e=!0){assert(e&&null==t||isFunction(t),"Function expected.");return t}export function asArray(t,e=!0){assert(e&&null==t||isArray(t),"Array expected.");return t}export function asType(t,e,i=!1){t=tryCast(t,e);assert(i||null!=t,e+" expected.");return t}export function asEnum(t,e,i=!1){if(null==t&&i)return null;let s=isString(t)?e[t]:t;assert(null!=s,'Invalid enum value: "'+t+'"');return isNumber(s)?s:t}export function asCollectionView(t,e=!0){if(null==t&&e)return null;let i=tryCast(t,"ICollectionView");if(null!=i)return i;isArray(t)||assert(!1,"Array or ICollectionView expected.");return new CollectionView(t)}export function hasItems(t){return null!=t&&null!=t.items&&t.items.length>0}export function toHeaderCase(t){return t&&t.length?t[0].toUpperCase()+t.substr(1).replace(/([a-z])([A-Z])/g,"$1 $2"):""}export function escapeHtml(t){t&&isString(t)&&(t=t.replace(/[&<>"'\/]/g,t=>_ENTITYMAP[t]));return null!=t?t.toString():""}const _ENTITYMAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};export function escapeRegExp(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}export function toPlainText(t){let e=asString(t);if(e&&e.indexOf("<")>-1){_plainText||(_plainText=document.createElement("div"));_plainText.innerHTML=e;e=_plainText.textContent}return e}var _plainText;export function hasClass(t,e){if(t&&e){if(t instanceof HTMLElement&&t.classList&&!isIE9())return t.classList.contains(e);if(t.getAttribute){let i=new RegExp("(\\s|^)"+e+"(\\s|$)");return t&&i.test(t.getAttribute("class"))}}return!1}export function addClass(t,e){if(t&&e){if(t instanceof HTMLElement&&t.classList&&!isIE9()){e.indexOf(" ")<0?t.classList.add(e):e.split(" ").forEach(e=>{t.classList.add(e)});return}t.setAttribute&&e.split(" ").forEach(e=>{if(!hasClass(t,e)){let i=t.getAttribute("class");t.setAttribute("class",i?i+" "+e:e)}})}}export function removeClass(t,e){if(t&&e){if(t instanceof HTMLElement&&t.classList&&!isIE9()){e.indexOf(" ")<0?t.classList.remove(e):e.split(" ").forEach(e=>{t.classList.remove(e)});return}t.setAttribute&&e.split(" ").forEach(e=>{if(hasClass(t,e)){let i=new RegExp("((\\s|^)"+e+"(\\s|$))","g"),s=t.getAttribute("class");(s=s.replace(i," ").replace(/ +/g," ").trim())?t.setAttribute("class",s):t.removeAttribute("class")}})}}export function toggleClass(t,e,i){null==i&&(i=!hasClass(t,e));i?addClass(t,e):removeClass(t,e)}export function setAttribute(t,e,i,s){t&&(null!=i?s&&t.getAttribute(e)||t.setAttribute(e,i.toString()):t.removeAttribute(e))}export function setChecked(t,e){let i=null==e;t.checked=isIE()?e||i:e;t.indeterminate=i}export function setAriaLabel(t,e){setAttribute(t,"aria-label",e)}export function setSelectionRange(t,e,i=e){assert(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement,"INPUT or TEXTAREA element expected");if(contains(document.body,t)&&!t.disabled&&t.offsetHeight){try{t.setSelectionRange(e,i,"backward")}catch(t){}try{t.focus();return!0}catch(t){}}return!1}export function disableAutoComplete(t){let e="autocomplete",i=t.getAttribute(e);i&&"on"!=i||t.setAttribute(e,"off");"autocorrect,autocapitalize,spellcheck".split(",").forEach(e=>{t.setAttribute(e,"spellcheck"==e?"false":"off")})}export function removeChild(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}export function getActiveElement(){let t=document.activeElement;if(t){let e=t.shadowRoot;e&&e.activeElement&&(t=e.activeElement)}return t}export function moveFocus(t,e){let i=_getFocusableElements(t),s=0;if(e){let t=i.indexOf(getActiveElement());t>-1&&(s=(t+e+i.length)%i.length)}if(s<i.length){let t=i[s];t.focus();t instanceof HTMLInputElement&&t.select();return!0}return!1}function _getFocusableElements(t){let e=[],i=t.querySelectorAll("input,select,textarea,button,a,div");for(let t=0;t<i.length;t++){let s=i[t];if(s.offsetHeight>0&&s.tabIndex>-1&&!s.disabled&&!closest(s,"[disabled],.wj-state-disabled")){if(s instanceof HTMLAnchorElement&&!s.hasAttribute("href"))continue;if(isIE()&&!s.hasAttribute("tabindex")){if(s instanceof HTMLDivElement)continue;let t=Control.getControl(closest(s,".wj-flexgrid"));if(t&&0==t.keyActionTab)continue}!Control.getControl(s)&&_getFocusableElements(s).length||e.push(s)}}return e}export function saveFile(t,e,i="text/plain"){(i.match(/\bcsv\b/i)||e.match(/\.csv$/i))&&(t="\ufeff"+t);let s=new Blob([t],{type:i});if(isFunction(navigator.msSaveBlob))navigator.msSaveBlob(s,e);else{let t=URL.createObjectURL(s),i=createElement('<a href="'+t+'" download="'+e+'"></a>',document.body,{display:"none"});i.click();i.remove();URL.revokeObjectURL(t)}}export function getElement(t){if(t instanceof Element)return t;if(isString(t))try{return document.querySelector(t)}catch(t){}return t&&t.jquery?t[0]:null}export function createElement(t,e,i){t=t.replace(/\bstyle\s*=\s*"/g,'_wj-style="');let s=document.createElement("div");s.innerHTML=t;if(t.indexOf("_wj-style")>-1){let t=s.querySelectorAll("[_wj-style]");for(let e=0;e<t.length;e++){let i=t[e];i.getAttribute("_wj-style").split(";").forEach(t=>{let e=t.split(":");2==e.length&&(i.style[e[0].trim()]=e[1].trim())});i.removeAttribute("_wj-style")}}1==s.children.length&&(s=s.children[0]);i&&setCss(s,i);e&&(e=getElement(e)).appendChild(s);return s}export function setText(t,e){t.textContent=e||""}export function contains(t,e,i){for(let s=e;s&&t;){if(s===t)return!0;s=(i?s[Control._OWNR_KEY]:null)||s.parentNode||s.host}return!1}export function closest(t,e){if(t){if(isFunction(t.closest))return t.closest(e);let i=t.matches||t.webkitMatchesSelector||t.msMatchesSelector||t.mozMatchesSelector;if(i)for(;t&&1===t.nodeType;t=t.parentElement||t.parentNode)if(i.call(t,e))return t}return null}export function closestClass(t,e){return closest(t,"."+e)}export function enable(t,e){let i=!e,s="disabled";toggleClass(t,"wj-state-disabled",i);setAttribute(t,s,i?s:null);let r=t.querySelectorAll("input,button");for(let t=0;t<r.length;t++)setAttribute(r[t],s,i?s:null)}export function getElementRect(t){let e=t.getBoundingClientRect();return new Rect(e.left+pageXOffset,e.top+pageYOffset,e.width,e.height)}export function setCss(t,e){assert(isObject(e),"css parameter should be an object");if(t instanceof Array)for(let i=0;i<t.length;i++)setCss(t[i],e);else if(t&&t.style){let i=t.style;for(let t in e){let s=e[t];"number"==typeof s&&t.match(/width|height|left|top|right|bottom|size|padding|margin'/i)&&(s+="px");i[t]!==s&&(i[t]=s)}}}export function animate(t,e,i){null==e&&(e=Control._ANIM_DEF_DURATION);null==i&&(i=Control._ANIM_DEF_STEP);t=asFunction(t);e=asNumber(e,!1,!0);i=asNumber(i,!1,!0);let s,r=Date.now(),n=setInterval(()=>{let i=Math.min(1,(Date.now()-r)/e);i=Math.sin(i*Math.PI/2);i*=i;s&&cancelAnimationFrame(s);s=requestAnimationFrame(()=>{s=null;t(i)});i>=1&&clearInterval(n)},i);return n}export class Point{constructor(t=0,e=0){this.x=asNumber(t);this.y=asNumber(e)}equals(t){return t instanceof Point&&this.x==t.x&&this.y==t.y}clone(){return new Point(this.x,this.y)}}export class Size{constructor(t=0,e=0){this.width=asNumber(t);this.height=asNumber(e)}equals(t){return t instanceof Size&&this.width==t.width&&this.height==t.height}clone(){return new Size(this.width,this.height)}}export class Rect{constructor(t,e,i,s){this.left=asNumber(t);this.top=asNumber(e);this.width=asNumber(i);this.height=asNumber(s)}get right(){return this.left+this.width}get bottom(){return this.top+this.height}equals(t){return t instanceof Rect&&this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height}clone(){return new Rect(this.left,this.top,this.width,this.height)}static fromBoundingRect(t){if(null!=t.left)return new Rect(t.left,t.top,t.width,t.height);if(null!=t.x)return new Rect(t.x,t.y,t.width,t.height);assert(!1,"Invalid source rectangle.")}static union(t,e){let i=Math.min(t.left,e.left),s=Math.min(t.top,e.top),r=Math.max(t.right,e.right),n=Math.max(t.bottom,e.bottom);return new Rect(i,s,r-i,n-s)}static intersection(t,e){let i=Math.max(t.left,e.left),s=Math.max(t.top,e.top),r=Math.min(t.right,e.right),n=Math.min(t.bottom,e.bottom);return new Rect(i,s,r-i,n-s)}contains(t){if(t instanceof Point)return t.x>=this.left&&t.x<=this.right&&t.y>=this.top&&t.y<=this.bottom;if(t instanceof Rect){let e=t;return e.left>=this.left&&e.right<=this.right&&e.top>=this.top&&e.bottom<=this.bottom}assert(!1,"Point or Rect expected.")}inflate(t,e){return new Rect(this.left-t,this.top-e,this.width+2*t,this.height+2*e)}}export class DateTime{static addDays(t,e){(t=new Date(t.getTime())).setDate(t.getDate()+e);return t}static addMonths(t,e){(t=new Date(t.getTime())).setMonth(t.getMonth()+e);return t}static addYears(t,e){(t=new Date(t.getTime())).setFullYear(t.getFullYear()+e);return t}static addHours(t,e){(t=new Date(t.getTime())).setHours(t.getHours()+e);return t}static addMinutes(t,e){(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e);return t}static addSeconds(t,e){(t=new Date(t.getTime())).setSeconds(t.getSeconds()+e);return t}static weekFirst(t,e=Globalize.getFirstDayOfWeek()){return DateTime.addDays(t,-(t.getDay()-e))}static weekLast(t,e=Globalize.getFirstDayOfWeek()){t=DateTime.weekFirst(t,e);return DateTime.addDays(t,6)}static monthFirst(t){return DateTime.addDays(t,1-t.getDate())}static monthLast(t){t=DateTime.monthFirst(t);t=DateTime.addMonths(t,1);return DateTime.addDays(t,-1)}static yearFirst(t){return new Date(t.getFullYear(),0,1)}static yearLast(t){return new Date(t.getFullYear(),11,31)}static sameDate(t,e){return isDate(t)&&isDate(e)&&t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()}static sameTime(t,e){return isDate(t)&&isDate(e)&&t.getHours()==e.getHours()&&t.getMinutes()==e.getMinutes()&&t.getSeconds()==e.getSeconds()&&t.getMilliseconds()==e.getMilliseconds()}static equals(t,e){return isDate(t)&&isDate(e)&&t.getTime()==e.getTime()}static fromDateTime(t,e){if(!t&&!e)return null;t||(t=e);e||(e=t);return DateTime.newDate(t.getFullYear(),t.getMonth(),t.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static toFiscal(t,e){let i=culture.Globalize.calendar;return isArray(i.fiscalYearOffsets)?DateTime.addMonths(t,-i.fiscalYearOffsets[e?0:1]):t}static fromFiscal(t,e){let i=culture.Globalize.calendar;return isArray(i.fiscalYearOffsets)?DateTime.addMonths(t,+i.fiscalYearOffsets[e?0:1]):t}static newDate(t,e,i,s,r,n,o){if(null==t||null==e||null==i){let s=new Date;null==t&&(t=s.getFullYear());null==e&&(e=s.getMonth());null==i&&(i=s.getDate())}null==s&&(s=0);null==r&&(r=0);null==n&&(n=0);null==o&&(o=0);let a=new Date(t,e,i,s,r,n,o),l=a.getFullYear();t<100&&l>=1900&&a.setFullYear(a.getFullYear()-1900);return a}static clone(t){return DateTime.fromDateTime(t,t)}}export function httpRequest(t,e){let i=e||{},s=i.method?asString(i.method).toUpperCase():"GET",r=null==i.async||asBoolean(i.async),n=i.data;if(null!=n&&"GET"==s){let e=[];for(let t in n){let i=n[t];isDate(i)&&(i=i.toJSON());e.push(t+"="+encodeURI(i))}if(e.length){let i=t.indexOf("?")<0?"?":"&";t+=i+e.join("&")}n=null}let o=new XMLHttpRequest;o.URL_DEBUG=t;let a=!1;if(null!=n&&!isString(n)){a=isObject(n);n=JSON.stringify(n)}o.onload=function(){if(4==o.readyState){o.status<300?i.success&&asFunction(i.success)(o):i.error&&asFunction(i.error)(o);i.complete&&asFunction(i.complete)(o)}};o.onerror=function(){if(!isFunction(i.error))throw"HttpRequest Error: "+o.status+" "+o.statusText;i.error(o)};o.open(s,t,r,i.user,i.password);i.user&&i.password&&o.setRequestHeader("Authorization","Basic "+btoa(i.user+":"+i.password));a&&o.setRequestHeader("Content-Type","application/json");if(i.requestHeaders)for(let t in i.requestHeaders)o.setRequestHeader(t,i.requestHeaders[t]);isNumber(i.timeout)&&(o.timeout=i.timeout);isFunction(i.beforeSend)&&i.beforeSend(o);o.send(n);return o}let _modules={};export function _registerModule(t,e){_modules[t]=e;if("wijmo"===t){let t="undefined"!=typeof window?window:"undefined"!=typeof self?self:null;t&&(t.wijmo=e)}}export function _getModule(t){return _modules[t]}export class PrintDocument{constructor(t){this._copyCss=!0;null!=t&&copy(this,t)}get title(){return this._title}set title(t){this._title=asString(t)}get copyCss(){return this._copyCss}set copyCss(t){this._copyCss=asBoolean(t)}addCSS(t){this._css||(this._css=[]);this._css.push(t)}append(t){let e=this._getDocument();isString(t)?e.write(t):t instanceof HTMLElement?e.write(t.outerHTML):assert(!1,"child should be an HTML element or a string.")}print(t){if(this._iframe){this._close();setTimeout(()=>{let e=this._iframe.contentWindow,i="onafterprint"in e&&!isFirefox();i&&(e.onafterprint=()=>{this._afterPrint(t)});if(!(isIE()&&null==e.document.body)&&document.queryCommandSupported("print"))e.document.execCommand("print",!0,null);else{e.focus();e.print()}i||this._afterPrint(t)},100)}}_afterPrint(t){document.body.removeChild(this._iframe);this._iframe=null;isFunction(t)&&t()}_getDocument(){if(!this._iframe){let t=this._iframe=document.createElement("iframe");addClass(t,"wj-printdocument");setCss(t,{position:"fixed",left:32e3,top:32e3});document.body.appendChild(t)}return this._iframe.contentDocument}_close(){let t=this._getDocument();t.close();t.title=null!=this.title?this.title:document.title;t.title&&t.title.trim()||(t.title=" ");if(this._copyCss){let t=document.head.querySelectorAll("LINK");for(let e=0;e<t.length;e++){let i=t[e];if(i.href.match(/\.css$/i)&&i.rel.match(/stylesheet/i)){let t=httpRequest(i.href,{async:!1});this._addStyle(t.responseText)}}let e=document.head.querySelectorAll("STYLE");for(let t=0;t<e.length;t++)this._addStyle(e[t].textContent)}if(this._css)for(let e=0;e<this._css.length;e++){let i=t.createElement("style"),s=httpRequest(this._css[e],{async:!1});i.textContent=s.responseText;t.head.appendChild(i)}}_addStyle(t){let e=this._getDocument(),i=e.createElement("style");i.textContent=t;e.head.appendChild(i)}}export class Color{constructor(t){this._r=0;this._g=0;this._b=0;this._a=1;t&&this._parse(t)}get r(){return this._r}set r(t){this._r=clamp(asNumber(t),0,255)}get g(){return this._g}set g(t){this._g=clamp(asNumber(t),0,255)}get b(){return this._b}set b(t){this._b=clamp(asNumber(t),0,255)}get a(){return this._a}set a(t){this._a=clamp(asNumber(t),0,1)}equals(t){return t instanceof Color&&this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}toString(){let t=Math.round(100*this.a);return t>99?"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1):"rgba("+this.r+","+this.g+","+this.b+","+t/100+")"}static fromRgba(t,e,i,s=1){let r=new Color(null);r.r=Math.round(clamp(asNumber(t),0,255));r.g=Math.round(clamp(asNumber(e),0,255));r.b=Math.round(clamp(asNumber(i),0,255));r.a=clamp(asNumber(s),0,1);return r}static fromHsb(t,e,i,s=1){let r=Color._hsbToRgb(clamp(asNumber(t),0,1),clamp(asNumber(e),0,1),clamp(asNumber(i),0,1));return Color.fromRgba(r[0],r[1],r[2],s)}static fromHsl(t,e,i,s=1){let r=Color._hslToRgb(clamp(asNumber(t),0,1),clamp(asNumber(e),0,1),clamp(asNumber(i),0,1));return Color.fromRgba(r[0],r[1],r[2],s)}static fromString(t){let e=new Color(null);return e._parse(asString(t))?e:null}getHsb(){return Color._rgbToHsb(this.r,this.g,this.b)}getHsl(){return Color._rgbToHsl(this.r,this.g,this.b)}static interpolate(t,e,i){i=clamp(asNumber(i),0,1);let s=Color._rgbToHsl(t.r,t.g,t.b),r=Color._rgbToHsl(e.r,e.g,e.b),n=1-i,o=t.a*n+e.a*i,a=[s[0]*n+r[0]*i,s[1]*n+r[1]*i,s[2]*n+r[2]*i],l=Color._hslToRgb(a[0],a[1],a[2]);return Color.fromRgba(l[0],l[1],l[2],o)}static toOpaque(t,e){if(1==(t=isString(t)?Color.fromString(t):asType(t,Color)).a)return t;e=null==e?Color.fromRgba(255,255,255,1):isString(e)?Color.fromString(e):asType(e,Color);let i=t.a,s=1-i;return Color.fromRgba(t.r*i+e.r*s,t.g*i+e.g*s,t.b*i+e.b*s)}_parse(t){if("transparent"==(t=t.toLowerCase())){this._r=this._g=this._b=this._a=0;return!0}if(t&&0!=t.indexOf("#")&&0!=t.indexOf("rgb")&&0!=t.indexOf("hsl")){let e=document.createElement("div");e.style.color=t;let i=e.style.color;if(i==t&&!(i=window.getComputedStyle(e).color)){document.body.appendChild(e);i=window.getComputedStyle(e).color;removeChild(e)}t=i.toLowerCase()}if(0==t.indexOf("#")){if(4==t.length){this.r=parseInt(t[1]+t[1],16);this.g=parseInt(t[2]+t[2],16);this.b=parseInt(t[3]+t[3],16);this.a=1;return!0}if(7==t.length){this.r=parseInt(t.substr(1,2),16);this.g=parseInt(t.substr(3,2),16);this.b=parseInt(t.substr(5,2),16);this.a=1;return!0}return!1}if(0==t.indexOf("rgb")){let e=t.indexOf("("),i=t.indexOf(")");if(e>-1&&i>-1){let s=t.substr(e+1,i-(e+1)).split(",");if(s.length>2){this.r=parseInt(s[0]);this.g=parseInt(s[1]);this.b=parseInt(s[2]);this.a=s.length>3?parseFloat(s[3]):1;return!0}}}if(0==t.indexOf("hsl")){let e=t.indexOf("("),i=t.indexOf(")");if(e>-1&&i>-1){let s=t.substr(e+1,i-(e+1)).split(",");if(s.length>2){let t=parseInt(s[0])/360,e=parseInt(s[1]),i=parseInt(s[2]);s[1].indexOf("%")>-1&&(e/=100);s[2].indexOf("%")>-1&&(i/=100);let r=Color._hslToRgb(t,e,i);this.r=r[0];this.g=r[1];this.b=r[2];this.a=s.length>3?parseFloat(s[3]):1;return!0}}}return!1}static _hslToRgb(t,e,i){assert(t>=0&&t<=1&&e>=0&&e<=1&&i>=0&&i<=1,"bad HSL values");let s,r,n;if(0==e)s=r=n=i;else{let o=i<.5?i*(1+e):i+e-i*e,a=2*i-o;s=Color._hue2rgb(a,o,t+1/3);r=Color._hue2rgb(a,o,t);n=Color._hue2rgb(a,o,t-1/3)}return[Math.round(255*s),Math.round(255*r),Math.round(255*n)]}static _hue2rgb(t,e,i){i<0&&(i+=1);i>1&&(i-=1);return i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static _rgbToHsl(t,e,i){assert(t>=0&&t<=255&&e>=0&&e<=255&&i>=0&&i<=255,"bad RGB values");t/=255,e/=255,i/=255;let s,r,n=Math.max(t,e,i),o=Math.min(t,e,i),a=(n+o)/2;if(n==o)s=r=0;else{let l=n-o;r=a>.5?l/(2-n-o):l/(n+o);switch(n){case t:s=(e-i)/l+(e<i?6:0);break;case e:s=(i-t)/l+2;break;case i:s=(t-e)/l+4}s/=6}return[s,r,a]}static _rgbToHsb(t,e,i){assert(t>=0&&t<=255&&e>=0&&e<=255&&i>=0&&i<=255,"bad RGB values");let s=Color._rgbToHsl(t,e,i);return Color._hslToHsb(s[0],s[1],s[2])}static _hsbToRgb(t,e,i){let s=Color._hsbToHsl(t,e,i);return Color._hslToRgb(s[0],s[1],s[2])}static _hsbToHsl(t,e,i){assert(t>=0&&t<=1&&e>=0&&e<=1&&i>=0&&i<=1,"bad HSB values");let s=clamp(i*(2-e)/2,0,1),r=1-Math.abs(2*s-1),n=clamp(r>0?i*e/r:e,0,1);assert(!isNaN(s)&&!isNaN(n),"bad conversion to HSL");return[t,n,s]}static _hslToHsb(t,e,i){assert(t>=0&&t<=1&&e>=0&&e<=1&&i>=0&&i<=1,"bad HSL values");let s=clamp(1==i?1:(2*i+e*(1-Math.abs(2*i-1)))/2,0,1),r=clamp(s>0?2*(s-i)/s:e,0,1);assert(!isNaN(s)&&!isNaN(r),"bad conversion to HSB");return[t,r,s]}}export var culture="undefined"!=typeof window&&window.wijmo&&window.wijmo.culture||{Globalize:{numberFormat:{".":".",",":",","-":"-","+":"+","%":"%",percent:{pattern:["-n %","n %"]},currency:{decimals:2,symbol:"$",pattern:["($n)","$n"]}},calendar:{"/":"/",":":":",firstDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],am:["AM","A"],pm:["PM","P"],eras:["A.D.","B.C."],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",t:"h:mm tt",T:"h:mm:ss tt",M:"MMMM d",m:"MMMM d",Y:"MMMM, yyyy",y:"MMMM, yyyy",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",s:'yyyy"-"MM"-"dd"T"HH":"mm":"ss',o:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',O:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',U:"dddd, MMMM dd, yyyy h:mm:ss tt"},fiscalYearOffsets:[-3,-3]}}};export class Globalize{static format(t,e,i,s){if(isString(t))return t;if(isNumber(t)){e=e||(t==Math.round(t)?"n0":"n2");return Globalize.formatNumber(t,e,i,s)}if(isDate(t)){e=e||"d";return Globalize.formatDate(t,e)}return null!=t?t.toString():""}static formatNumber(t,e,i,s){t=asNumber(t);e=asString(e);let r,n=culture.Globalize.numberFormat,o=Globalize._parseNumericFormat(e),a=o.spec,l=o.prec,h=n["."]||".",c=n[","]||",",u=n["-"]||"-";null==l&&(l="c"==a?n.currency.decimals:"e"==a?6:"r"==a?12:t==Math.round(t)?0:2);o.scale&&(t/=Math.pow(10,o.scale));if("d"==a||"x"==a){r=Math.round(Math.abs(t)).toString("d"==a?10:16);for(;r.length<l;)r="0"+r;t<0&&(r=u+r);return"X"==o.specRaw?r.toUpperCase():r}"p"==a&&(t=toFixed(t=Globalize._shiftDecimal(t,2),l,s));s&&"p"!=a&&"e"!=a&&(t=toFixed(t,l,!0));switch(a){case"e":r=t.toExponential(l);"E"==o.specRaw&&(r=r.replace("e","E"));break;case"c":case"p":r=Globalize._toFixedStr(Math.abs(t),l);break;default:r=Globalize._toFixedStr(t,l)}(i||"g"==a||"r"==a)&&r.indexOf(".")>-1&&(r=r.replace(/(\.\d*?)0+$/g,"$1").replace(/\.$/,""));"."!=h&&(r=r.replace(".",h));"-"!=u&&(r=r.replace("-",u));if(c&&("n"==a||"c"==a||"p"==a||"F"==o.specRaw||"G"==o.specRaw)){let t=r.indexOf(h),e=/\B(?=(\d\d\d)+(?!\d))/g;r=t>-1?r.substr(0,t).replace(e,c)+r.substr(t):r.replace(e,c)}if("c"==a){let e=n.currency.pattern[t<0?0:1],i=o.curr||n.currency.symbol;"​"==i&&(i="");r=e.replace("n",r).replace("$",i)}if("p"==a){let e=n.percent.pattern[t<0?0:1],i=n["%"]||"%";r=e.replace("n",r);"%"!=i&&(r=r.replace("%",i));"-"!=u&&t<0&&(r=r.replace("-",u))}return o.prefix||o.suffix?o.prefix+r+o.suffix:r}static formatDate(t,e){t=asDate(t);switch(e){case"r":case"R":return t.toUTCString();case"u":return t.toISOString().replace(/\.\d{3}/,"")}e=Globalize._expandFormat(e);return Globalize._parseDateFormat(e).map(i=>Globalize._formatDatePart(t,e,i)).join("")}static parseInt(t,e){return Math.round(Globalize.parseFloat(t,e))}static parseFloat(t,e){let i=Globalize._parseNumericFormat(e),s=i.prefix;s&&0==t.indexOf(s)&&(t=t.substring(s.length));let r=i.suffix;r&&t.lastIndexOf(r)==t.length-r.length&&(t=t.substring(0,t.length-r.length));let n=culture.Globalize.numberFormat,o=n["."]||".",a=n[","]||",",l=n["-"]||"-",h=n["%"]||"%",c=i.curr||n.currency.symbol||"$",u=t.indexOf(h)>-1,d=t.indexOf("(")>-1&&t.indexOf(")")>-1,g=0;if("x"==i.spec)g=parseInt(t,16);else{[c,h,"(",")"].forEach(e=>{t=t.replace(e,"")});/\s/.test(a)&&(t=t.replace(/\s+/g,""));let e=(t=t.replace(new RegExp("\\"+a,"g"),"").replace(new RegExp("\\"+l,"g"),"-").replace(/(\+|\-)\s+/g,"$1").replace(o,".").trim()).length;if(!d&&e&&"-"==t[e-1]){d=!0;t=t.substring(0,e-1)}g=/^\s*(\+|\-)?\d*(\.\d*)?(\s*E(\+|\-)?\d+)?\s*$/i.test(t)?parseFloat(t):Number.NaN}if(!isNaN(g)){d=d||g<0;g=Math.abs(g);u&&(g=Globalize._shiftDecimal(g,-2));d&&(g=-g);i.scale&&(g*=Math.pow(10,i.scale))}return g}static parseDate(t,e,i){if(!(t=asString(t)))return null;if("u"==e)return new Date(t);let s;if("R"==e||"r"==e){let e=/((\d+)\-(\d+)\-(\d+))?\s?((\d+):(\d+)(:(\d+))?)?/,i=t.match(e);if(i[1]||i[5]){s=i[1]?new Date(parseInt(i[2]),parseInt(i[3])-1,parseInt(i[4])):new Date;if(i[5]){s.setHours(parseInt(i[6]));s.setMinutes(parseInt(i[7]));s.setSeconds(i[8]?parseInt(i[9]):0)}}else s=new Date(t);return isNaN(s.getTime())?null:s}e=Globalize._expandFormat(e||"d");let r,n,o,a,l,h=culture.Globalize.calendar,c=Globalize._CJK,u=new RegExp("(\\"+h["/"]+")|(\\"+h[":"]+")|(\\d+)|(["+c+"\\.]{2,})|(["+c+"]+)","gi"),d=t.match(u),g=Globalize._parseDateFormat(e),p=0,f=-1,_=0,m=1,b=0,C=0,y=0,w=0,v=-1,x=-1;if(!(d&&d.length&&g&&g.length))return null;for(let t=0;t<g.length&&d;t++){let e=t-p,i=e>-1&&e<d.length?d[e]:"",s=g[t].length;switch(g[t]){case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":l=g[t];case"yyyy":case"yyy":case"yy":case"y":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}f=parseInt(i);a=4==i.length;break;case"MMMM":case"MMM":o=!0;let c=i.toLowerCase();_=-1;for(let t=0;t<12;t++)if(0==h.months[t].toLowerCase().indexOf(c)){_=t;break}if(_>-1)break;case"MM":case"M":o=!0;if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}_=parseInt(i)-1;break;case"dddd":case"ddd":r=!0;break;case"dd":case"d":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}m=parseInt(i);n=!0;break;case"hh":case"h":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}b=12==(b=parseInt(i))?0:b;break;case"HH":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}b=parseInt(i);break;case"H":b=parseInt(i);break;case"mm":case"m":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}C=parseInt(i);break;case"ss":case"s":if(s>1&&i.length>s){d[e]=i.substr(s);i=i.substr(0,s);p++}y=parseInt(i);break;case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":w=parseInt(i)/Math.pow(10,s-3);break;case"tt":case"t":i=i.toUpperCase();b<12&&h.pm.indexOf(i)>-1&&(b+=12);break;case"q":case"Q":case"u":case"U":x=this.parseInt(i);break;case"ggg":case"gg":case"g":v=h.eras.length>1?Globalize._getEra(i,h):-1;break;case"/":case":":if(i&&i!=h[g[t]])return null;break;case h["/"]:case h[":"]:if(i&&i!=g[t])return null;break;case"K":break;default:Globalize._unquote(g[t]).trim()!=i.trim()&&p++}}if(o&&n){isNaN(b)&&(b=0);isNaN(C)&&(C=0);isNaN(y)&&(y=0)}if(_<0||_>11||isNaN(_)||m<1||m>31||isNaN(m)||b<0||b>=24||isNaN(b)||C<0||C>=60||isNaN(C)||y<0||y>=60||isNaN(y))return null;if(l){if(!o)return null;let t=culture.Globalize.calendar;if(isArray(t.fiscalYearOffsets)){let e="E"==l[0],i=_-t.fiscalYearOffsets[e?0:1];f+=i>11?-1:i<0?1:0}}if(r&&!n)return null;!o&&x>=1&&x<=4&&(_=3*(x-1));if(isNaN(f)||f<0)f=isDate(i)?i.getFullYear():(new Date).getFullYear();else if(v>-1)f=f+h.eras[v].start.getFullYear()-1;else if(f<100&&!a){let t=isNumber(h.twoDigitYearMax)?h.twoDigitYearMax:2029;t>99&&(f+=f+2e3<=t?2e3:1900)}return(s=DateTime.newDate(f,_,m,b,C+0,y,w)).getMonth()!=_||s.getDate()!=m?null:isNaN(s.getTime())?null:s}static getFirstDayOfWeek(){let t=culture.Globalize.calendar.firstDay;return t||0}static getNumberDecimalSeparator(){let t=culture.Globalize.numberFormat["."];return t||"."}static _toFixedStr(t,e){let i=t.toString(),s=i.indexOf("."),r=e-(i.length-s)+1,n=i.indexOf("e")>-1;if(!n&&s>-1&&r>=0)return i+Array(r+1).join("0");if(s>-1&&!n&&"5"==i[i.length-1]){t=+(Math.round(+(Math.abs(t)+"e"+e))+"e"+-e)*(t<0?-1:1)}return t.toFixed(e)}static _unquote(t){return t.length>1&&t[0]==t[t.length-1]&&("'"==t[0]||'"'==t[0])?t.substr(1,t.length-2):t}static _parseNumericFormat(t){let e=Globalize._numFormatInfo[t];if(!e){culture.Globalize.numberFormat;let i=t&&t.match(/(\"(.*?)\"\s*)?([a-z])\s*(\d*)\s*(,*)(\s*\"(.*?)\"\s*)?(.*)/i)||[],s=i[3]?i[3]:"n";e={prefix:i[2]||"",spec:s.toLowerCase(),specRaw:s,prec:i[4]?parseInt(i[4]):null,scale:i[5]?3*i[5].length:0,suffix:i[7]||"",curr:i[8]||null};Globalize._numFormatInfo[t]=e}return e}static _parseDateFormat(t){let e=Globalize._dateFormatParts[t];if(!e){e=[];if(t){let i,s;for(i=0;i>-1&&i<t.length;i++){let r=t[i];if(("'"==r||'"'==r)&&(s=t.indexOf(r,i+1))>-1){e.push(t.substring(i,s+1));i=s}else if("\\"==r&&i<t.length-1){i++;e.push('"'+t[i]+'"')}else{s=i+1;for(;s<t.length&&t[s]==r;s++);e.push(t.substring(i,s));i=s-1}}}Globalize._dateFormatParts[t]=e}return e}static _formatDatePart(t,e,i){let s,r=culture.Globalize.calendar,n=0,o=0,a=0,l=i.length;switch(i){case"yyyy":case"yyy":case"yy":case"y":case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":o=(s="E"==i[0]?DateTime.toFiscal(t,!0):"e"==i[0]?DateTime.toFiscal(t,!1):t).getFullYear();if(r.eras.length>1&&e.indexOf("g")>-1&&(n=Globalize._getEra(t,r))>-1){let t=r.eras[n];o=isDate(t.start)?o-t.start.getFullYear()+1:Math.abs(o)}let h=i.length<3?o%100:3==i.length?o%1e3:o;return Globalize._zeroPad(h,i.length);case"MMMMM":return r.monthsAbbr[t.getMonth()][0];case"MMMM":return r.months[t.getMonth()];case"MMM":return r.monthsAbbr[t.getMonth()];case"MM":case"M":return Globalize._zeroPad(t.getMonth()+1,l);case"dddd":return r.days[t.getDay()];case"ddd":return r.daysAbbr[t.getDay()];case"dd":return Globalize._zeroPad(t.getDate(),2);case"d":return t.getDate().toString();case"hh":case"h":return Globalize._zeroPad(Globalize._h12(t),l);case"HH":case"H":return Globalize._zeroPad(t.getHours(),l);case"mm":case"m":return Globalize._zeroPad(t.getMinutes(),l);case"ss":case"s":return Globalize._zeroPad(t.getSeconds(),l);case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":a=t.getMilliseconds()*Math.pow(10,l-3);return"f"==i[0]?Globalize._zeroPad(a,l):a.toFixed(0);case"tt":return t.getHours()<12?r.am[0]:r.pm[0];case"t":return t.getHours()<12?r.am[1]:r.pm[1];case"q":case"Q":return(Math.floor(t.getMonth()/3)+1).toString();case"u":case"U":s=DateTime.toFiscal(t,"U"==i);return(Math.floor(s.getMonth()/3)+1).toString();case"ggg":case"gg":case"g":if(r.eras.length>1&&(n=Globalize._getEra(t,r))>-1){let t=r.eras[n];if(isString(t))return t;switch(i){case"gg":return t.name[0];case"g":return t.symbol;default:return t.name}}return r.eras[0];case":":case"/":return r[i];case"K":let c=t.toString().match(/(\+|\-)(\d{2})(\d{2})/);return c?c[1]+c[2]+c[3]:"";case"zzz":case"zz":case"z":let u,d=-t.getTimezoneOffset();switch(i){case"zzz":u=Globalize.format(d/60,"d2",!1,!0)+r[":"]+Globalize.format(d%60,"d2",!1,!0);break;case"zz":u=Globalize.format(d/60,"d2",!1,!0);break;case"z":u=Globalize.format(d/60,"d1",!1,!0)}return d>=0?"+"+u:u}return l>1&&i[0]==i[l-1]&&('"'==i[0]||"'"==i[0])?i.substr(1,l-2):i}static _getEra(t,e){if(e.eras){let i=e.eras.length;if(isDate(t)){if(isString(e.eras[0]))return t.getFullYear()>=0?0:1;if(isDate(e.eras[0].start)){for(let s=0;s<i;s++)if(t>=e.eras[s].start)return s;return i-1}}else if(isString(t)&&t.length>0){t=t.toLowerCase();for(let s=0;s<i;s++){let i=e.eras[s],r=i.name,n=i.symbol;if(r&&0==r.toLowerCase().indexOf(t)||n&&0==n.toLowerCase().indexOf(t))return s}}}return-1}static _expandFormat(t){let e=culture.Globalize.calendar.patterns[t];return e||t}static _zeroPad(t,e){let i=t.toFixed(0),s=e-i.length+1;return s>0?Array(s).join("0")+i:i}static _h12(t){let e=culture.Globalize.calendar,i=t.getHours();e.am&&e.am[0]&&0==(i%=12)&&(i=12);return i}static _shiftDecimal(t,e){if(0==e||isNaN(t))return t;let i=t.toString();if(i.indexOf("e")>-1)return t*Math.pow(10,e);let s=Array(Math.abs(e)+1).join("0");e<0&&(i=s+i);var r=i.indexOf(".");r<0&&(r=(i+=".").indexOf("."));e>0&&(i+=s);r+=e;i=(i=i.replace(".","")).substr(0,r)+"."+i.substr(r);return parseFloat(i)}}Globalize._CJK="a-z"+"u00c0-u017fu3000-u30ffu4e00-u9faf".replace(/u/g,"\\u")+"u1100-u11ffu3130-u318fua960-ua97fuac00-ud7afud7b0-ud7ff".replace(/u/g,"\\u");Globalize._numFormatInfo={};Globalize._dateFormatParts={};export function _updateCulture(t){culture=t}export function _addCultureInfo(t,e){culture[t]="undefined"!=typeof window&&window.wijmo.culture[t]||e}export class _MaskProvider{constructor(t,e=null,i="_"){this._promptChar="_";this._mskArr=[];this._full=!0;this._inputBnd=this._input.bind(this);this._keydownBnd=this._keydown.bind(this);this._keypressBnd=this._keypress.bind(this);this._cmpstartBnd=this._cmpstart.bind(this);this._cmpendBnd=this._cmpend.bind(this);this.mask=asString(e);this.input=t;this.promptChar=asString(i,!1);this._connect(!0);this._evtInput=document.createEvent("HTMLEvents");this._evtInput.initEvent("input",!0,!1)}get input(){return this._tbx}set input(t){this._connect(!1);this._tbx=t;this._connect(!0)}get mask(){return this._msk}set mask(t){if(t!=this._msk){this._msk=asString(t,!0);this._parseMask();this._valueChanged()}}get promptChar(){return this._promptChar}set promptChar(t){if(t!=this._promptChar){this._promptChar=asString(t,!1);assert(1==this._promptChar.length,"promptChar must be a string with length 1.");this._valueChanged()}}get maskFull(){return this._full}getMaskRange(){return this._mskArr.length?[this._firstPos,this._lastPos]:[0,this._tbx.value.length-1]}getRawValue(){let t=this._tbx?this._tbx.value:"";if(!this.mask)return t;let e="";for(let i=0;i<this._mskArr.length&&i<t.length;i++)this._mskArr[i].literal||t[i]==this._promptChar||(e+=t[i]);return e}refresh(){this._parseMask();this._valueChanged()}_input(t){if(this._msk&&!this._composing&&t!=this._evtInput){t.preventDefault();t.stopImmediatePropagation();setTimeout(()=>{this._valueChanged();this._tbx&&this._tbx.dispatchEvent(this._evtInput)})}}_keydown(t){if(t.keyCode==Key.Back){let e=this._tbx.selectionStart,i=this._tbx.selectionEnd;if(e<=this._firstPos&&i==e){t.preventDefault();this._backSpace=!1;return}}this._backSpace=t.keyCode==Key.Back}_keypress(t){t.ctrlKey||t.metaKey||t.altKey||this._composing||!this._preventKey(t.charCode)||t.preventDefault()}_cmpstart(t){this._composing=!0}_cmpend(t){if(this._composing){this._composing=!1;setTimeout(()=>{let t=this._tbx;t&&this._valueChanged()&&t.dispatchEvent(this._evtInput)})}}_preventKey(t){if(t&&this._mskArr.length){let e=this._tbx,i=e.selectionStart,s=String.fromCharCode(t);i<this._firstPos&&setSelectionRange(e,i=this._firstPos);if(i>=this._mskArr.length)return!0;let r=this._mskArr[i];if(r.literal)this._validatePosition(i);else if(r.wildCard!=s&&!this._isCharValid(r.wildCard,s))return!0}return!1}_connect(t){let e=this._tbx;if(e){assert(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement,"INPUT or TEXTAREA element expected.");if(t){this._autoComplete=e.autocomplete;this._spellCheck=e.spellcheck;e.autocomplete="off";e.spellcheck=!1;e.addEventListener("input",this._inputBnd,!0);e.addEventListener("keydown",this._keydownBnd,!0);e.addEventListener("keypress",this._keypressBnd,!0);e.addEventListener("compositionstart",this._cmpstartBnd,!0);e.addEventListener("compositionend",this._cmpendBnd,!0);e.addEventListener("blur",this._cmpendBnd,!0);this._valueChanged()}else{e.autocomplete=this._autoComplete;e.spellcheck=this._spellCheck;e.removeEventListener("input",this._inputBnd,!0);e.removeEventListener("keydown",this._keydownBnd,!0);e.removeEventListener("keypress",this._keypressBnd,!0);e.removeEventListener("compositionstart",this._cmpstartBnd,!0);e.removeEventListener("compositionend",this._cmpendBnd,!0);e.removeEventListener("blur",this._cmpendBnd,!0)}}}_valueChanged(){if(!this._tbx||!this._msk)return!1;let t=this._tbx,e=t.value.length<2,i=t.selectionStart,s=i>0?t.value[i-1]:"",r=t.value;t.value=this._applyMask();e&&(i=this._firstPos+1);let n=i>0?t.value[i-1]:"";i>0&&n==this._promptChar&&s!=this.promptChar&&i--;i==r.length&&(i=this._matchEnd);this._validatePosition(i);return r!=t.value}_applyMask(){this._full=!0;this._matchEnd=0;let t=this._tbx.value;if(!this._msk)return t;if(!t&&!this._tbx.required)return t;let e="",i=0,s=this._promptChar;t=this._handleVagueLiterals(t);for(let r=0;r<this._mskArr.length;r++){let n=this._mskArr[r],o=n.literal;o&&o==t[i]&&i++;if(n.wildCard){o=s;if(t){let r=i;for(;r<t.length;r++)if(this._isCharValid(n.wildCard,t[r])){o=t[r];switch(n.charCase){case">":o=o.toUpperCase();break;case"<":o=o.toLowerCase()}o!=s&&(this._matchEnd=e.length+1);break}i=r+1}o==s&&(this._full=!1)}e+=o}return e}_handleVagueLiterals(t){if(t.length>this._mskArr.length+1)return t;let e=t.length-this._mskArr.length;if(0!=e&&t.length>1){let i=-1,s=this._tbx,r=s==getActiveElement()?s.selectionStart:s.value.length;for(let t=Math.max(0,r-e);t<this._mskArr.length;t++)if(this._mskArr[t].vague){i=t;break}if(i>-1)if(e<0){let s=Array(1-e).join(this._promptChar),r=i+e;r>-1&&(t=t.substr(0,r)+s+t.substr(r))}else{for(;i>0&&this._mskArr[i-1].literal;)i--;t=t.substr(0,i)+t.substr(i+e)}}return t}_isCharValid(t,e){if(e==this._promptChar)return!0;switch(t){case"0":return this._isDigit(e);case"9":return this._isDigit(e)||" "==e;case"#":return this._isDigit(e)||" "==e||"+"==e||"-"==e;case"L":return this._isLetter(e);case"l":return this._isLetter(e)||" "==e;case"A":return this._isDigit(e)||this._isLetter(e);case"a":return this._isDigit(e)||this._isLetter(e)||" "==e;case"９":return e>="０"&&e<="９";case"Ｊ":case"Ｇ":return!("Ｇ"==t&&_MaskProvider._X_DBCS_BIG_HIRA.indexOf(e)>-1)&&(e>="ぁ"&&e<="ゟ");case"Ｋ":case"Ｎ":return!("Ｎ"==t&&_MaskProvider._X_DBCS_BIG_KATA.indexOf(e)>-1)&&(e>="゠"&&e<="ヿ");case"Ｚ":return!(e>="ｦ"&&e<="ﾟ")&&(e<="!"||e>="ÿ");case"H":return e>="!"&&e<="ÿ"||e>="ｦ"&&e<="ﾟ";case"K":case"N":return!("N"==t&&_MaskProvider._X_SBCS_BIG_KATA.indexOf(e)>-1)&&(e>="ｦ"&&e<="ﾟ")}return!1}_isDigit(t){return t>="0"&&t<="9"}_isLetter(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}_validatePosition(t){let e=this._mskArr;if(this._backSpace)for(;t>0&&t<e.length&&e[t-1].literal;)t--;if(0==t||!this._backSpace)for(;t<e.length&&e[t].literal;)t++;getActiveElement()==this._tbx&&setSelectionRange(this._tbx,t);this._backSpace=!1}_parseMask(){this._mskArr=[];this._firstPos=-1;this._lastPos=-1;let t,e=this._msk,i="|";for(let s=0;e&&s<e.length;s++)switch(e[s]){case"0":case"9":case"#":case"A":case"a":case"L":case"l":case"９":case"Ｊ":case"Ｇ":case"Ｋ":case"Ｎ":case"Ｚ":case"K":case"N":case"H":this._firstPos<0&&(this._firstPos=this._mskArr.length);this._lastPos=this._mskArr.length;this._mskArr.push(new _MaskElement(e[s],i));break;case".":case",":case":":case"/":case"$":switch(e[s]){case".":case",":t=culture.Globalize.numberFormat[e[s]];break;case":":case"/":t=culture.Globalize.calendar[e[s]];break;case"$":t=culture.Globalize.numberFormat.currency.symbol}for(let e=0;e<t.length;e++)this._mskArr.push(new _MaskElement(t[e]));break;case"<":case">":case"|":i=e[s];break;case"\\":s<e.length-1&&s++;this._mskArr.push(new _MaskElement(e[s]));break;default:this._mskArr.push(new _MaskElement(e[s]))}for(let t=0;t<this._mskArr.length;t++){let e=this._mskArr[t];if(e.literal)for(let i=0;i<t;i++){let t=this._mskArr[i];if(t.wildCard&&this._isCharValid(t.wildCard,e.literal)){e.vague=!0;break}}}}}_MaskProvider._X_DBCS_BIG_HIRA="ぁぃぅぇぉっゃゅょゎゕゖ";_MaskProvider._X_DBCS_BIG_KATA="ァィゥェォッャュョヮヵヶ";_MaskProvider._X_SBCS_BIG_KATA="ｧｨｩｪｫｬｭｮｯ";export class _MaskElement{constructor(t,e){if(e){this.wildCard=t;this.charCase=e}else this.literal=t}}export var Aggregate;!function(t){t[t.None=0]="None";t[t.Sum=1]="Sum";t[t.Cnt=2]="Cnt";t[t.Avg=3]="Avg";t[t.Max=4]="Max";t[t.Min=5]="Min";t[t.Rng=6]="Rng";t[t.Std=7]="Std";t[t.Var=8]="Var";t[t.StdPop=9]="StdPop";t[t.VarPop=10]="VarPop";t[t.CntAll=11]="CntAll";t[t.First=12]="First";t[t.Last=13]="Last"}(Aggregate||(Aggregate={}));export function getAggregate(t,e,i){let s=0,r=0,n=0,o=0,a=null,l=null,h=null,c=i?new Binding(i):null;if((t=asEnum(t,Aggregate))==Aggregate.CntAll)return e.length;for(let i=0;i<e.length;i++){let u=e[i];c&&(u=c.getValue(u));if(t==Aggregate.First)return u;if(null!=u){s++;(null==a||u<a)&&(a=u);(null==l||u>l)&&(l=u);h=u;if(isNumber(u)&&!isNaN(u)){r++;n+=u;o+=u*u}else if(isBoolean(u)){r++;if(1==u){n++;o++}}}}let u=0==r?0:n/r;switch(t){case Aggregate.Avg:return u;case Aggregate.Cnt:return s;case Aggregate.Max:return l;case Aggregate.Min:return a;case Aggregate.Rng:return l-a;case Aggregate.Sum:return n;case Aggregate.VarPop:return r<=1?0:o/r-u*u;case Aggregate.StdPop:return r<=1?0:Math.sqrt(o/r-u*u);case Aggregate.Var:return r<=1?0:(o/r-u*u)*r/(r-1);case Aggregate.Std:return r<=1?0:Math.sqrt((o/r-u*u)*r/(r-1));case Aggregate.Last:return h}throw"Invalid aggregate type."}export class ArrayBase extends Array{constructor(){canChangePrototype?this.length=0:super()}}var canChangePrototype=!0;try{ArrayBase.prototype=Array.prototype;canChangePrototype=ArrayBase.prototype===Array.prototype}catch(t){canChangePrototype=!1}var symb="undefined"!=typeof window?window.Symbol:null;!canChangePrototype&&symb&&symb.species&&Object.defineProperty(ArrayBase,symb.species,{get:function(){return Array},enumerable:!1,configurable:!1});export class ObservableArray extends ArrayBase{constructor(t){super();this._updating=0;this.collectionChanged=new Event;if(t){t=asArray(t);this._updating++;for(let e=0;e<t.length;e++)this.push(t[e]);this._updating--}}push(...t){let e=this.length;for(let i=0;i<t.length;i++){e=super.push(t[i]);this._updating||this._raiseCollectionChanged(NotifyCollectionChangedAction.Add,t[i],e-1)}return e}pop(){let t=super.pop();this._raiseCollectionChanged(NotifyCollectionChangedAction.Remove,t,this.length);return t}splice(t,e,...i){let s,r=NotifyCollectionChangedAction,n=this._raiseCollectionChanged.bind(this);if(e&&i.length){s=super.splice(t,e,...i);1==e&&1==i.length?n(r.Change,i[0],t):n()}else if(i.length){s=super.splice(t,0,...i);1==i.length?n(r.Add,i[0],t):n()}else{s=super.splice(t,e);1==e?n(r.Remove,s[0],t):n()}return s}slice(t,e){return super.slice(t,e)}indexOf(t,e){return super.indexOf(t,e)}sort(t){let e=super.sort(t);this._raiseCollectionChanged();return e}insert(t,e){this.splice(t,0,e)}remove(t){let e=this.indexOf(t);e>-1&&this.removeAt(e);return e>-1}removeAt(t){this.splice(t,1)}setAt(t,e){t>=this.length&&(this.length=t+1);this.splice(t,1,e)}clear(){this.length&&this.splice(0,this.length)}beginUpdate(){this._updating++}endUpdate(){this._updating--;this._updating<=0&&this._raiseCollectionChanged()}get isUpdating(){return this._updating>0}deferUpdate(t){try{this.beginUpdate();t()}finally{this.endUpdate()}}implementsInterface(t){return"INotifyCollectionChanged"==t}onCollectionChanged(t=NotifyCollectionChangedEventArgs.reset){this.isUpdating||this.collectionChanged.raise(this,t)}_raiseCollectionChanged(t=NotifyCollectionChangedAction.Reset,e,i){if(!this.isUpdating){let s=new NotifyCollectionChangedEventArgs(t,e,i);this.onCollectionChanged(s)}}}export var SortNulls;!function(t){t[t.Natural=0]="Natural";t[t.First=1]="First";t[t.Last=2]="Last"}(SortNulls||(SortNulls={}));export class CollectionView{constructor(t,e){this._idx=-1;this._filters=new ObservableArray;this._srtDsc=new ObservableArray;this._grpDesc=new ObservableArray;this._newItem=null;this._edtItem=null;this._pgSz=0;this._pgIdx=0;this._updating=0;this._stableSort=!1;this._srtNulls=SortNulls.Last;this._canFilter=!0;this._canGroup=!0;this._canSort=!0;this._canAddNew=!0;this._canCancelEdit=!0;this._canRemove=!0;this._canChangePage=!0;this._refreshOnEdit=!0;this._trackChanges=!1;this._chgAdded=new ObservableArray;this._chgRemoved=new ObservableArray;this._chgEdited=new ObservableArray;this.collectionChanged=new Event;this.sourceCollectionChanging=new Event;this.sourceCollectionChanged=new Event;this.currentChanged=new Event;this.currentChanging=new Event;this.pageChanged=new Event;this.pageChanging=new Event;this._srtDsc.collectionChanged.addHandler(()=>{this._srtDsc.forEach(t=>{assert(t instanceof SortDescription,"sortDescriptions array must contain SortDescription objects.")});this.canSort&&this._commitAndRefresh()});this._grpDesc.collectionChanged.addHandler(()=>{this._grpDesc.forEach(t=>{assert(t instanceof GroupDescription,"groupDescriptions array must contain GroupDescription objects.")});this.canGroup&&this._commitAndRefresh()});this._filters.collectionChanged.addHandler(()=>{this._filters.forEach(t=>{assert(isFunction(t),"filters array must contain IPredicate functions.")});this.canFilter&&this._commitAndRefresh()});this.sourceCollection=t||new ObservableArray;e&&this.deferUpdate(()=>{copy(this,e)});null==this._keepCurrentItem&&(this._keepCurrentItem=!0)}_copy(t,e){switch(t){case"sortDescriptions":let t=this.sortDescriptions;t.deferUpdate(()=>{t.clear();asArray(e).forEach(e=>{isString(e)?e=new SortDescription(e,!0):e instanceof SortDescription||!e.property||(e=new SortDescription(e.property,e.ascending));t.push(e)})});return!0;case"groupDescriptions":let i=this.groupDescriptions;i.deferUpdate(()=>{i.clear();e.forEach(t=>{isString(t)&&(t=new PropertyGroupDescription(t));i.push(t)})});return!0;case"currentItem":this.currentItem=e;return!0}return!1}get calculatedFields(){return this._calcFields}set calculatedFields(t){if(t&&!window.Proxy){console.warn("** Calculated fields require Proxy (see https://www.npmjs.com/package/proxy-polyfill).");t=null}if(t!=this._calcFields){this._calcFields=t;let e=this._srcRaw;this._srcRaw=null;this.sourceCollection=e}}get newItemCreator(){return this._itemCreator}set newItemCreator(t){this._itemCreator=asFunction(t)}get sortConverter(){return this._srtCvt}set sortConverter(t){t!=this._srtCvt&&(this._srtCvt=asFunction(t,!0))}get sortComparer(){return this._srtCmp}set sortComparer(t){t!=this._srtCmp&&(this._srtCmp=asFunction(t,!0))}get useStableSort(){return this._stableSort}set useStableSort(t){if(t!=this._stableSort){this._stableSort=asBoolean(t);this.refresh()}}get sortNulls(){return this._srtNulls}set sortNulls(t){if((t=asEnum(t,SortNulls))!=this._srtNulls){this._srtNulls=t;this.refresh()}}get sortNullsFirst(){return this.sortNulls!=SortNulls.Last}set sortNullsFirst(t){_deprecated("sortNullsFirst","sortNulls");this.sortNulls=asBoolean(t)?SortNulls.First:SortNulls.Last}getAggregate(t,e,i){return getAggregate(t,i?this._pgView:this._view,e)}get trackChanges(){return this._trackChanges}set trackChanges(t){this._trackChanges=asBoolean(t)}get refreshOnEdit(){return this._refreshOnEdit}set refreshOnEdit(t){this._refreshOnEdit=asBoolean(t)}get itemsAdded(){return this._chgAdded}get itemsRemoved(){return this._chgRemoved}get itemsEdited(){return this._chgEdited}clearChanges(){this._chgAdded.clear();this._chgRemoved.clear();this._chgEdited.clear()}implementsInterface(t){switch(t){case"ICollectionView":case"IEditableCollectionView":case"IPagedCollectionView":case"INotifyCollectionChanged":return!0}return!1}get getError(){return this._getError}set getError(t){if(this._getError!=t){this._getError=asFunction(t);this._raiseCollectionChanged()}}onCollectionChanged(t=NotifyCollectionChangedEventArgs.reset){t.action!=NotifyCollectionChangedAction.Change||this._committing||this._canceling||t.item==this.currentEditItem||t.item==this.currentAddItem||this._trackItemChanged(t.item);this._updating||this.collectionChanged.raise(this,t)}_raiseCollectionChanged(t=NotifyCollectionChangedAction.Reset,e,i){let s=new NotifyCollectionChangedEventArgs(t,e,i);this.onCollectionChanged(s)}onSourceCollectionChanging(t){this.sourceCollectionChanging.raise(this,t);return!t.cancel}onSourceCollectionChanged(t){this.sourceCollectionChanged.raise(this,t)}get canFilter(){return this._canFilter}set canFilter(t){this._canFilter=asBoolean(t)}get canGroup(){return this._canGroup}set canGroup(t){this._canGroup=asBoolean(t)}get canSort(){return this._canSort}set canSort(t){this._canSort=asBoolean(t)}get currentItem(){return this._pgView&&this._idx>-1&&this._idx<this._pgView.length?this._pgView[this._idx]:null}set currentItem(t){this.moveCurrentTo(t)}get currentPosition(){return this._idx}set currentPosition(t){this.moveCurrentToPosition(asNumber(t))}get filter(){return this._filter}set filter(t){if(this._filter!=t){this._filter=asFunction(t);this.canFilter&&this.refresh()}}get filters(){return this._filters}get groupDescriptions(){return this._grpDesc}get groups(){return this._groups}get isEmpty(){return!this._pgView||!this._pgView.length}get sortDescriptions(){return this._srtDsc}get sourceCollection(){return this._src}set sourceCollection(t){if(t!=this._srcRaw){if(!this.onSourceCollectionChanging(new CancelEventArgs))return;let e=this.currentPosition;this.commitEdit();null!=this._ncc&&this._ncc.collectionChanged.removeHandler(this._sourceChanged);this._srcRaw=t;this._src=asArray(t,!1);this._calcFields&&(this._src=_getCalculatedArray(this._src,this._calcFields));this._ncc=tryCast(this._src,"INotifyCollectionChanged");this._ncc&&this._ncc.collectionChanged.addHandler(this._sourceChanged,this);this.clearChanges();this.refresh();this.moveCurrentToFirst();this.onSourceCollectionChanged();this.currentPosition<0&&e>-1&&this.onCurrentChanged()}}_sourceChanged(t,e){this._updating<=0&&this.refresh()}contains(t){return this._pgView.indexOf(t)>-1}moveCurrentTo(t){return this.moveCurrentToPosition(this._pgView.indexOf(t))}moveCurrentToFirst(){return this.moveCurrentToPosition(0)}moveCurrentToLast(){return this.moveCurrentToPosition(this._pgView.length-1)}moveCurrentToPrevious(){return this._idx>0&&this.moveCurrentToPosition(this._idx-1)}moveCurrentToNext(){return this.moveCurrentToPosition(this._idx+1)}moveCurrentToPosition(t){if(t>=-1&&t<this._pgView.length&&t!=this._idx){let e=new CancelEventArgs;if(this.onCurrentChanging(e)){let e=this._pgView[t];this._edtItem&&e!=this._edtItem?this.commitEdit():this._newItem&&e!=this._newItem&&this.commitNew();this._idx=t;this.onCurrentChanged()}}return this._idx==t}refresh(){if(this._newItem||this._edtItem||this._updating>0)this._pendingRefresh=!0;else{this._performRefresh();this.onCollectionChanged()}}_commitAndRefresh(){if(this.currentEditItem||this.currentAddItem){this._pendingRefresh=!0;this.commitEdit()}else this.refresh()}_performRefresh(){if(this._updating>0){this._pendingRefresh=!0;return}this._pendingRefresh=!1;let t=this.currentItem;this._view=this._src?this._performFilter(this._src):[];if(this.canSort&&this._srtDsc.length>0){this._view==this._src&&(this._view=this._src.slice());this._performSort(this._view)}this._groups=this.canGroup?this._createGroups(this._view):null;this._fullGroups=this._groups;this._groups&&(this._view=this._mergeGroupItems(this._groups));this._pgIdx=clamp(this._pgIdx,0,this.pageCount-1);this._pgView=this._getPageView();if(this._groups&&this.pageCount>1){this._groups=this._createGroups(this._pgView);this._mergeGroupItems(this._groups)}let e=this._keepCurrentItem?this._pgView.indexOf(t):-1;e<0&&(e=Math.min(this._idx,this._pgView.length-1));this._idx=e;this._digest=this._getGroupsDigest(this.groups)}_performSort(t){if(this._stableSort){let e=t.map((t,e)=>({item:t,index:e})),i=this._compareItems();e.sort((t,e)=>{let s=i(t.item,e.item);return 0==s?t.index-e.index:s});for(let i=0;i<t.length;i++)t[i]=e[i].item}else t.sort(this._compareItems())}_compareItems(){let t=this._srtDsc,e=this._srtCvt,i=this._srtCmp,s=CollectionView._collator,r=!0,n=0;return(o,a)=>{for(let l=0;l<t.length;l++){let h=t[l],c=h._bnd.getValue(o),u=h._bnd.getValue(a);if(e){c=e(h,o,c,r);u=e(h,a,u,!1);r=!1}if(i&&null!=(n=i(c,u))){if(0!=n)return h.ascending?+n:-n}else{c!=c&&(c=null);u!=u&&(u=null);if(c!==u&&(null==c||null==u))switch(this._srtNulls){case SortNulls.First:return null==c?-1:1;case SortNulls.Last:return null==c?1:-1;default:n=null==c?-1:1;return h.ascending?+n:-n}if("string"==typeof c&&"string"==typeof u){if(s){if(0!=(n=s.compare(c,u)))return h.ascending?+n:-n;continue}let t=c.toLowerCase(),e=u.toLowerCase();if(t!=e){c=t;u=e}}if(0!=(n=c<u?-1:c>u?1:0))return h.ascending?+n:-n}}return 0}}_performFilter(t){return this.canFilter&&(this._filter||this._filters.length)?t.filter(this._filterItem,this):t}_filterItem(t){var e=!this._filter||this._filter(t);for(let i=0;i<this._filters.length&&e;i++)e=this._filters[i](t);return e}onCurrentChanged(t){this.currentChanged.raise(this,t)}onCurrentChanging(t){this.currentChanging.raise(this,t);return!t.cancel}get items(){return this._pgView}beginUpdate(){this._updating++}endUpdate(t=!0){this._updating--;t&&(this._pendingRefresh=!0);this._updating<=0&&this._pendingRefresh&&this.refresh()}get isUpdating(){return this._updating>0}deferUpdate(t,e=!0){try{this.beginUpdate();t()}finally{this.endUpdate(e)}}get canAddNew(){return this._canAddNew}set canAddNew(t){if(t!=this._canAddNew){this._canAddNew=asBoolean(t);this._raiseCollectionChanged()}}get canCancelEdit(){return this._canCancelEdit}set canCancelEdit(t){this._canCancelEdit=asBoolean(t)}get canRemove(){return this._canRemove}set canRemove(t){this._canRemove=asBoolean(t)}get currentAddItem(){return this._newItem}get currentEditItem(){return this._edtItem}get isAddingNew(){return null!=this._newItem}get isEditingItem(){return null!=this._edtItem}editItem(t){if(t!=this._edtItem&&this.moveCurrentTo(t)){this.commitEdit();this._edtItem=t;this._edtClone={};this._extend(this._edtClone,this._edtItem)}}commitEdit(){let t=this._edtItem,e=this._edtClone;if(null!=t){this._committing=!0;let i=this._getChangedFields(t,e),s=this._pendingRefresh;this._edtItem=null;this._edtClone=null;let r=this._pgView.indexOf(t),n=this._digest;this._needRefresh(i)&&this._refreshOnEdit&&this._performRefresh();i&&this._trackItemChanged(t);this._pgView.indexOf(t)!=r||n!=this._digest||s?this._raiseCollectionChanged():this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,t,r);this.commitNew();this._committing=!1;if(this.sourceCollection instanceof ObservableArray){this._updating++;let e=new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Change,t);this.sourceCollection.onCollectionChanged(e);this._updating--}}}cancelEdit(){let t=this._edtItem;if(null!=t){this._edtItem=null;if(!this.canCancelEdit)return;let e=this._src.indexOf(t);if(e>=0&&this._edtClone){this._extend(this._src[e],this._edtClone);this._edtClone=null;this._canceling=!0;this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,t,e);this._canceling=!1;if(this._pendingRefresh&&this._refreshOnEdit){this._performRefresh();this._raiseCollectionChanged()}}}}addNew(t,e=!1){this.commitEdit();if(!this.canAddNew)return null;if(null==t){let e=this.sourceCollection;t=this.newItemCreator?this.newItemCreator():e&&e.length?new e[0].constructor:{}}if(null!=t){this._newItem=t;this._updating++;this._src.push(t);this._updating--;this._pgView!=this._src&&this._pgView.push(t);if(this.groups&&this.groups.length){let e=this.groups[this.groups.length-1];e.items.push(t);for(;e.groups&&e.groups.length;)(e=e.groups[e.groups.length-1]).items.push(t)}this._raiseCollectionChanged(NotifyCollectionChangedAction.Add,t,this._pgView.length-1);this.moveCurrentTo(t);e&&this.commitNew()}return this._newItem}commitNew(){let t=this._newItem;if(null!=t){this._newItem=null;let e=this._pgView.indexOf(t),i=this._digest;this._refreshOnEdit&&this._performRefresh();if(this._trackChanges){let e=this._chgEdited.indexOf(t);e>-1&&this._chgEdited.removeAt(e);this._chgAdded.indexOf(t)<0&&this._chgAdded.push(t)}this._pgView.indexOf(t)==e&&i==this._digest?this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,t,e):this._raiseCollectionChanged()}}cancelNew(){let t=this._newItem;null!=t&&this.remove(t)}remove(t){let e=t==this._newItem;e&&(this._newItem=null);t==this._edtItem&&this.cancelEdit();if(!this.canRemove)return;let i=this._src.indexOf(t);if(i>-1){let s=this.currentItem;this._updating++;this._src.splice(i,1);this._updating--;let r=this._digest;if(this._refreshOnEdit)this._performRefresh();else{let e=this._pgView.indexOf(t);e>=0&&this._pgView.splice(e,1)}if(this._trackChanges){let i=this._chgAdded.indexOf(t);i>-1&&this._chgAdded.removeAt(i);let s=this._chgEdited.indexOf(t);s>-1&&this._chgEdited.removeAt(s);this._chgRemoved.indexOf(t)<0&&!e&&i<0&&this._chgRemoved.push(t)}let n=this.sortDescriptions.length>0,o=this.pageSize>0&&this._pgIdx>-1;n||o||r!=this._getGroupsDigest(this.groups)?this._raiseCollectionChanged():this._raiseCollectionChanged(NotifyCollectionChangedAction.Remove,t,i);this.currentItem!==s&&this.onCurrentChanged()}}removeAt(t){t=asInt(t);this.remove(this._pgView[t])}_trackItemChanged(t){if(this._trackChanges){let e=this.sourceCollection;if(e&&e.indexOf(t)>-1){let e=this._chgEdited.indexOf(t),i=NotifyCollectionChangedAction.Change;if(e<0&&this._chgAdded.indexOf(t)<0)this._chgEdited.push(t);else if(e>-1){let s=new NotifyCollectionChangedEventArgs(i,t,e);this._chgEdited.onCollectionChanged(s)}else if((e=this._chgAdded.indexOf(t))>-1){let s=new NotifyCollectionChangedEventArgs(i,t,e);this._chgAdded.onCollectionChanged(s)}}}}_extend(t,e,i=2){for(let s in e)try{let r=e[s];if(i>0&&isObject(r)){t[s]={};this._extend(t[s],r,i--)}else t[s]=r}catch(t){}}_getChangedFields(t,e){assert(null!=e&&null!=t,"Two objects expected.");let i={};for(let s in e)try{this._sameValue(t[s],e[s])||(i[s]=!0)}catch(t){}for(let s in t)try{this._sameValue(t[s],e[s])||(i[s]=!0)}catch(t){}let s=Object.keys(i);return s.length?s:null}_needRefresh(t){if(this._pendingRefresh)return!0;if(!t)return!1;if(this._filter)return!0;for(let e=0;e<this._srtDsc.length;e++){let i=this._getBindingRoot(this._srtDsc[e].property);if(t.indexOf(i)>-1)return!0}for(let e=0;e<this._grpDesc.length;e++){let i=this._grpDesc[e];if(!(i instanceof PropertyGroupDescription))return!0;let s=this._getBindingRoot(i.propertyName);if(t.indexOf(s)>-1)return!0}return!1}_getBindingRoot(t){let e=t.indexOf(".");return e>-1?t.substr(0,e):t}_sameContent(t,e){return null==this._getChangedFields(t,e)}_sameValue(t,e){return!(t!==e&&!DateTime.equals(t,e))||!(!isObject(t)||!isObject(e))&&null==this._getChangedFields(t,e)}get canChangePage(){return this._canChangePage}set canChangePage(t){this._canChangePage=asBoolean(t)}get isPageChanging(){return!1}get itemCount(){return this._pgView.length}get pageIndex(){return this._pgIdx}get pageSize(){return this._pgSz}set pageSize(t){if(t!=this._pgSz){this._pgSz=asInt(t);this.refresh()}}get totalItemCount(){return this._view.length}get pageCount(){return this.pageSize?Math.ceil(this.totalItemCount/this.pageSize):1}moveToFirstPage(){return this.moveToPage(0)}moveToLastPage(){return this.moveToPage(this.pageCount-1)}moveToPreviousPage(){return this.moveToPage(this.pageIndex-1)}moveToNextPage(){return this.moveToPage(this.pageIndex+1)}moveToPage(t){let e=clamp(t,0,this.pageCount-1);if(e!=this._pgIdx){if(!this.canChangePage)return;let t=new PageChangingEventArgs(e);if(this.onPageChanging(t)){this._pgIdx=e;this._pgView=this._getPageView();this._idx=0;this.groupDescriptions&&0!=this.groupDescriptions.length?this.refresh():this.onCollectionChanged();this.onPageChanged()}}return this._pgIdx==t}onPageChanged(t){this.pageChanged.raise(this,t)}onPageChanging(t){this.pageChanging.raise(this,t);return!t.cancel}_getFullGroup(t){let e=this._getGroupByPath(this._fullGroups,t.level,t._path);null!=e&&(t=e);return t}_getGroupByPath(t,e,i){if(t)for(let s=0;s<t.length;s++){let r=t[s];if(r.level==e&&r._path==i)return r;if(r.level<e&&0==i.indexOf(r._path)&&null!=(r=this._getGroupByPath(r.groups,e,i)))return r}return null}_getPageView(){if(this.pageSize<=0||this._pgIdx<0)return this._view;let t=this._pgSz*this._pgIdx,e=Math.min(t+this._pgSz,this._view.length);return this._view.slice(t,e)}_createGroups(t){if(!this._grpDesc||!this._grpDesc.length)return null;let e=[],i={},s=null;t.forEach(t=>{let r=e,n=this._grpDesc.length,o="";for(let e=0;e<n;e++){let a=this._grpDesc[e],l=a.groupNameFromItem(t,e),h=e==n-1;if(!(s=i[o])&&isPrimitive(l)){s={};i[o]=s}let c=this._getGroup(a,r,s,l,e,h);o+="/"+l;c._path=o;h&&c.items.push(t);r=c.groups}});return e}_getGroupsDigest(t){let e="";for(let i=0;null!=t&&i<t.length;i++){let s=t[i];e+="{"+s.name+":"+(s.items?s.items.length:"*");if(s.groups.length>0){e+=",";e+=this._getGroupsDigest(s.groups)}e+="}"}return e}_mergeGroupItems(t){let e=[];for(let i=0;i<t.length;i++){let s=t[i];if(!s._isBottomLevel){let t=this._mergeGroupItems(s.groups);for(let e=0,i=t.length;e<i;e++)s._items.push(t[e])}for(let t=0,i=s._items.length;t<i;t++)e.push(s._items[t])}return e}_getGroup(t,e,i,s,r,n){let o;if(i&&isPrimitive(s)){if(o=i[s])return o}else for(let i=0;i<e.length;i++)if(t.namesMatch(e[i].name,s))return e[i];let a=new CollectionViewGroup(t,s,r,n);e.push(a);i&&(i[s]=a);return a}}CollectionView._collator="undefined"!=typeof window&&window.Intl&&Intl.Collator?new Intl.Collator:null;export class CollectionViewGroup{constructor(t,e,i,s){this._gd=t;this._name=e;this._level=i;this._isBottomLevel=s;this._groups=[];this._items=[]}get name(){return this._name}get level(){return this._level}get isBottomLevel(){return this._isBottomLevel}get items(){return this._items}get groups(){return this._groups}get groupDescription(){return this._gd}getAggregate(t,e,i){let s=tryCast(i,CollectionView);return getAggregate(t,(s?s._getFullGroup(this):this).items,e)}}export var controlBaseClass="undefined"!=typeof window&&window["wj-control-is-element"]?HTMLElement:Object;var __isES6Mode=!1;try{let t=class __c{};t.prototype=Array.prototype;__isES6Mode=t.prototype!==Array.prototype}catch(t){__isES6Mode=!0}var __callSuper=__isES6Mode||controlBaseClass!==Object;export class ControlBase extends controlBaseClass{constructor(){__callSuper&&super()}}export class Control extends ControlBase{constructor(t,e=null,i=!1){super();this._listeners=[];this._pristine=!0;this._focus=!1;this._updating=0;this._fullUpdate=!1;this.gotFocus=new Event;this.lostFocus=new Event;this.invalidInput=new Event;this.refreshing=new Event;this.refreshed=new Event;this._updateWme();assert(null==Control.getControl(t),"Element is already hosting a control.");let s=getElement(t);assert(null!=s,"Cannot find the host element.");this._orgTabIndex=s.hasAttribute("tabindex")?s.tabIndex:0;this._orgOuter=s.outerHTML;this._orgTag=s.tagName;this._orgAtts=s.attributes;"INPUT"!=s.tagName&&"SELECT"!=s.tagName||(s=this._replaceWithDiv(s));this._e=s;s[Control._CTRL_KEY]=this;let r=this.addEventListener.bind(this);if(1==i){this._szCtl=new Size(s.offsetWidth,s.offsetHeight);let t=window.ResizeObserver,e=null;t&&(e=this._szObserver=new t(t=>{t.forEach(t=>{let e=Control.getControl(t.target);e&&e._handleResize()})}));e?e.observe(s):r(window,"resize",this._handleResize.bind(this))}let n=this._handleFocusBlur.bind(this);r(s,"focus",n,!0);r(s,"blur",n,!0);let o=this._handleDisabled.bind(this);r(s,"mousedown",o,!0);r(s,"mouseup",o,!0);r(s,"click",o,!0);r(s,"dblclick",o,!0);r(s,"wheel",o,getEventOptions(!0,!0));r(s,"keydown",t=>{this.isDisabled&&t.keyCode!=Key.Tab&&t.preventDefault()});if(null==Control._touching){Control._touching=!1;if("ontouchstart"in window||"onpointerdown"in window){let t=document,e=this._handleTouchStart,i=this._handleTouchEnd,s=getEventOptions(!0,!0);if("ontouchstart"in window){t.addEventListener("touchstart",e,s);"touchend,touchcancel".split(",").forEach(e=>{t.addEventListener(e,i,s)})}else if("onpointerdown"in window){t.addEventListener("pointerdown",e,s);"pointerup,pointercancel".split(",").forEach(e=>{t.addEventListener(e,i,s)})}}}}getTemplate(){for(let t=Object.getPrototypeOf(this);t;t=Object.getPrototypeOf(t)){let e=t.constructor.controlTemplate;if(e)return e}return null}applyTemplate(t,e,i,s){let r=this._e;t&&addClass(r,t);let n=null;e&&(n=createElement(e,r));let o=r.querySelectorAll("a.wj-btn");for(var a=0;a<o.length;a++){let t=o[a];setAttribute(t,"role","button",!0);setAttribute(t,"href","",!0);setAttribute(t,"draggable",!1,!0)}let l=r.querySelectorAll("button");for(a=0;a<l.length;a++)setAttribute(l[a],"type","button",!0);let h=r.querySelectorAll("input"),c=1==h.length?h[0]:null;if(c){let t=Control._rxInputAtts;this._copyAttributes(c,r.attributes,t);this._copyAttributes(c,this._orgAtts,t)}if(c&&r.id){let t=r;for(;t.parentElement;)t=t.parentElement;let e=t.querySelector('label[for="'+r.id+'"]');if(e instanceof HTMLLabelElement){let t=getUniqueId(r.id+"_input");c.id=t;e.htmlFor=t}}if(c){let t=c.value,e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1);this.gotFocus.addHandler(()=>t=c.value);this.addEventListener(c,"focus",()=>t=c.value);this.addEventListener(c,"input",()=>{this._pristine=!1;setTimeout(()=>t=c.value)});this.addEventListener(r,"blur",()=>{if(!this.containsFocus()){if(this._pristine){this._pristine=!1;this._updateState()}if(t!=c.value){t=c.value;c.dispatchEvent(e)}}},!0)}c?r.tabIndex=-1:r.getAttribute("tabindex")||(r.tabIndex=0);this._updateState();if(i)for(let t in i){let e=i[t];this[t]=n.querySelector('[wj-part="'+e+'"]');null==this[t]&&n.getAttribute("wj-part")==e&&(this[t]=n);if(null==this[t])throw'Missing template part: "'+e+'"';if(e==s){let e="name",i=r.attributes[e];i&&i.value&&this[t].setAttribute(e,i.value);e="accesskey";if((i=r.attributes[e])&&i.value){this[t].setAttribute(e,i.value);r.removeAttribute(e)}}}return n}dispose(){if(!this._e)return;let t=this._e.querySelectorAll(".wj-control");for(let e=0;e<t.length;e++){let i=Control.getControl(t[e]);i&&i.dispose()}if(this._toInv){clearTimeout(this._toInv);this._toInv=null}let e=this._szObserver;e&&e.disconnect();this.removeEventListener();for(let t in this)if(t.length>2&&0==t.indexOf("on")){let e=this[t[2].toLowerCase()+t.substr(3)];e instanceof Event&&e.removeAllHandlers()}let i=this.collectionView;if(i instanceof CollectionView)for(let t in i){let e=i[t];e instanceof Event&&e.removeHandler(null,this)}this._e.parentNode&&(this._e.outerHTML=this._orgOuter);this._e[Control._CTRL_KEY]=null;this._e=this._orgOuter=this._orgTag=this._szObserver=null}static getControl(t){let e=getElement(t);return e?asType(e[Control._CTRL_KEY],Control,!0):null}get hostElement(){return this._e}get rightToLeft(){null==this._rtlDir&&(this._rtlDir=!!this._e&&"rtl"==getComputedStyle(this._e).direction);return this._rtlDir}focus(){let t=this._e;t&&(t.tabIndex>=0||!moveFocus(t,0))&&t.focus()}containsFocus(){return contains(this._e,getActiveElement(),!0)}invalidate(t=!0){this._rtlDir=null;this._fullUpdate=this._fullUpdate||t;if(this._toInv){clearTimeout(this._toInv);this._toInv=null}this.isUpdating||(this._toInv=setTimeout(()=>{this.refresh(this._fullUpdate);this._toInv=null},Control._REFRESH_INTERVAL))}refresh(t=!0){if(!this.isUpdating){this.onRefreshing();setTimeout(()=>{this.onRefreshed()})}if(!this.isUpdating&&this._toInv){clearTimeout(this._toInv);this._toInv=null;this._fullUpdate=!1}this._updateState();this._updateWme()}static invalidateAll(t){t||(t=document.body);let e=t.children;if(e)for(let t=0;t<e.length;t++)Control.invalidateAll(e[t]);let i=Control.getControl(t);i&&i.invalidate()}static refreshAll(t){t||(t=document.body);if(t.children)for(let e=0;e<t.children.length;e++)Control.refreshAll(t.children[e]);let e=Control.getControl(t);e&&e.refresh()}static disposeAll(t){let e=Control.getControl(t);if(e)e.dispose();else if(t.children)for(let e=0;e<t.children.length;e++)Control.disposeAll(t.children[e])}beginUpdate(){this._updating++}endUpdate(){this._updating--;this._updating<=0&&this.invalidate()}get isUpdating(){return this._updating>0}deferUpdate(t){try{this.beginUpdate();t()}finally{this.endUpdate()}}get isTouching(){return Control._touching}get isDisabled(){return this._e&&null!=this._e.getAttribute("disabled")}set isDisabled(t){if((t=asBoolean(t,!0))!=this.isDisabled){let e=this._e;if(e){let i="disabled";toggleClass(e,"wj-state-disabled",t);setAttribute(e,i,t?i:null);e.tabIndex=this.isDisabled||e.querySelector("input")?-1:this._orgTabIndex;let s=e.querySelectorAll("input,textarea,button,command,fieldset,keygen,optgroup,option,select");for(let e=0;e<s.length;e++){let i=s[e];if(!hasClass(i,"wj-btn"))if(t)i.tabIndex=-1;else{let t=!1;for(let e=i;e&&!t;e=e.parentElement){Control.getControl(closest(i,".wj-control")).isDisabled&&(t=!0)}setAttribute(i,"tabindex",t?-1:null)}}}}}initialize(t){copy(this,t)}addEventListener(t,e,i,s,r){if(t){null==s&&(s=!1);isBoolean(s)&&null==r&&(e.indexOf("touch")>-1||e.indexOf("wheel")>-1)&&(r=!1);let n=isBoolean(s)&&isBoolean(r)?getEventOptions(s,r):s;t.addEventListener(e,i,n);this._listeners.push({target:t,type:e,fn:i,capture:s})}}removeEventListener(t,e,i,s){let r=0;for(let n=0;n<this._listeners.length;n++){let o=this._listeners[n];if(!(null!=t&&t!=o.target||null!=e&&e!=o.type||null!=i&&i!=o.fn||null!=s&&s!=o.capture)){o.target.removeEventListener(o.type,o.fn,o.capture);this._listeners.splice(n,1);n--;r++}}return r}onGotFocus(t){this.gotFocus.raise(this,t)}onLostFocus(t){this.lostFocus.raise(this,t)}onInvalidInput(t){this.invalidInput.raise(this,t);t.cancel&&this.focus();this._updateState();return!t.cancel}onRefreshing(t){this.refreshing.raise(this,t)}onRefreshed(t){this.refreshed.raise(this,t)}_getProductInfo(){return"B0C3,Control"}_updateWme(){let t=this._getProductInfo(),e=Control._toWme,i=_updateWme;isFunction(i)&&!e[t]&&(e[t]=setTimeout(()=>{e[t]=null;i(this,Control._licKey)},Control._REFRESH_INTERVAL))}_hasPendingUpdates(){return null!=this._toInv}_handleResize(){if(this._e.parentElement){let t=new Size(this._e.offsetWidth,this._e.offsetHeight);if(!t.equals(this._szCtl)){this._szCtl=t;(t.width||t.height)&&this.invalidate()}}}_handleFocusBlur(){this._toFocus||(this._toFocus=setTimeout(()=>{this._toFocus=null;this._updateFocusState()},Control._FOCUS_INTERVAL))}_updateFocusState(){setTimeout(()=>{let t=EventArgs.empty,e=document.body.querySelectorAll(".wj-state-focused");for(let i=0;i<e.length;i++){let s=Control.getControl(e[i]);if(s&&s._focus&&!s.containsFocus()){removeClass(s._e,"wj-state-focus");s._focus=!1;s._updateState();s.onLostFocus(t)}}let i=getActiveElement();if(i){let e=!0;for(let s=i;s;){let i=Control.getControl(s);if(i&&!i._focus&&i.containsFocus()){if(e){addClass(s,"wj-state-focus");e=!1}i._focus=!0;i._updateState();i.onGotFocus(t)}s=s[Control._OWNR_KEY]||s.parentNode}}})}_updateState(){let t=this.hostElement;if(t){toggleClass(t,"wj-state-focused",this._focus);this._rtlDir="rtl"==getComputedStyle(t).direction;toggleClass(t,"wj-rtl",this._rtlDir);let e=t.querySelector("input");if(e instanceof HTMLInputElement){toggleClass(t,"wj-state-empty",0==e.value.length);toggleClass(t,"wj-state-readonly",e.readOnly);let i=e.validationMessage;toggleClass(t,"wj-state-invalid",!this._pristine&&null!=i&&i.length>0)}}}_handleTouchStart(t){if(null==t.pointerType||"touch"==t.pointerType){if(Control._toTouch){clearTimeout(Control._toTouch);Control._toTouch=null}Control._touching=!0;let e=t.target,i=getActiveElement();if(i&&!contains(i,e)){Control.getControl(closest(i,".wj-control"))&&e.focus()}}}_handleTouchEnd(t){if(null==t.pointerType||"touch"==t.pointerType){Control._toTouch=setTimeout((function(){Control._toTouch=null;Control._touching=!1}),900);if(document.querySelector("ion-app")){let e=t.target;if(closest(e,".wj-dropdown-panel,.wj-dropdown")){e.focus();t.stopPropagation();t.stopImmediatePropagation()}}}}_handleDisabled(t){if(this.isDisabled||closest(t.target,".wj-state-disabled")){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation()}}_replaceWithDiv(t){let e=document.createElement("div");t.parentElement.replaceChild(e,t);e.innerHTML=t.innerHTML;this._copyAttributes(e,t.attributes,/id|style|class/i);return e}_copyAttributes(t,e,i){if(t)for(let s=0;s<e.length;s++){let r=e[s].name;r.match(i)&&t.setAttribute(r,e[s].value)}}_getKeyCode(t){let e=t.keyCode;if(this.rightToLeft)switch(e){case Key.Right:e=Key.Left;break;case Key.Left:e=Key.Right}return e}}Control._toWme={};Control._REFRESH_INTERVAL=10;Control._FOCUS_INTERVAL=5;Control._ANIM_DEF_DURATION=400;Control._ANIM_DEF_STEP=35;Control._CLICK_DELAY=800;Control._CLICK_REPEAT=75;Control._CLIPBOARD_DELAY=100;Control._POPUP_ZINDEX=1500;Control._SEARCH_DELAY=500;Control._HOVER_DELAY=400;Control._LEAVE_DELAY=600;Control._DRAG_SCROLL_EDGE=15;Control._DRAG_SCROLL_STEP=20;Control._CTRL_KEY="$WJ-CTRL";Control._OWNR_KEY="$WJ-OWNR";Control._SCRL_KEY="$WJ-SCRL";Control._TTIP_KEY="$WJ-TTIP";Control._rxInputAtts=/name|tabindex|placeholder|autofocus|autocomplete|autocorrect|autocapitalize|spellcheck|readonly|minlength|maxlength|pattern|type|aria-.+/i;export class Clipboard{static copy(t){Clipboard._copyPaste(asString(t),null)}static paste(t){t=asFunction(t);Clipboard._copyPaste(null,t)}static _copyPaste(t,e){let i=getActiveElement(),s=closest(i,".wj-control");for(;s&&Control.getControl(s);)s=s.parentElement;if(s=s||document.body){let r=!1,n=createElement('<textarea class="wj-clipboard">',s,{position:"fixed",opacity:"0"});n.onkeydown=t=>t.preventDefault();n.onchange=t=>t.stopImmediatePropagation();if(isString(t)){n.value=t;n.select();document.execCommand("copy")&&(r=!0)}else{n.select();if(isFunction(e)&&document.execCommand("paste")){e(n.value);r=!0}}setTimeout(()=>{i.focus({preventScroll:!0});removeChild(n);!r&&isFunction(e)&&e(n.value)},Control._CLIPBOARD_DELAY)}}}export class _ClickRepeater{constructor(t){this._isDown=!1;this._mousedownBnd=this._mousedown.bind(this);this._mouseupBnd=this._mouseup.bind(this);this._clickBnd=this._click.bind(this);this.element=t;this._connect(!0)}get element(){return this._e}set element(t){this._connect(!1);this._e=asType(t,HTMLElement,!0);this._connect(!0)}get disabled(){return this._disabled}set disabled(t){this._disabled=asBoolean(t)}_connect(t){this._e&&_ClickRepeater._startEvents.forEach(e=>{t?this._e.addEventListener(e,this._mousedownBnd):this._e.removeEventListener(e,this._mousedownBnd)})}_clearTimeouts(){if(this._toRepeat){clearTimeout(this._toRepeat);this._toRepeat=null}if(this._toDelay){clearTimeout(this._toDelay);this._toDelay=null}}_mousedown(t){this._isDown&&this._mouseup(null);if(!this._disabled){this._isDown=!0;_ClickRepeater._stopEvents.forEach(t=>{document.addEventListener(t,this._mouseupBnd)});this._clearTimeouts();this._toDelay=setTimeout(()=>{if(this._isDown){this._click();this._toRepeat=setTimeout(this._clickBnd,Control._CLICK_REPEAT)}},Control._CLICK_DELAY)}}_mouseup(t){this._isDown&&t&&"keydown"!=t.type&&this._clicked&&t.preventDefault();_ClickRepeater._stopEvents.forEach(t=>{document.removeEventListener(t,this._mouseupBnd)});this._clearTimeouts();this._isDown=!1;this._clicked=!1}_click(){this._clicked=!0;this._clearTimeouts();if(this._e){this._e.click();this._isDown&&(this._toRepeat=setTimeout(this._clickBnd,Control._CLICK_REPEAT))}}}_ClickRepeater._startEvents=["mousedown","touchstart"];_ClickRepeater._stopEvents=["mouseup","mouseout","keydown","touchend","touchcancel"];export var PopupPosition;!function(t){t[t.Above=0]="Above";t[t.AboveRight=1]="AboveRight";t[t.RightTop=2]="RightTop";t[t.Right=3]="Right";t[t.RightBottom=4]="RightBottom";t[t.BelowRight=5]="BelowRight";t[t.Below=6]="Below";t[t.BelowLeft=7]="BelowLeft";t[t.LeftBottom=8]="LeftBottom";t[t.Left=9]="Left";t[t.LeftTop=10]="LeftTop";t[t.AboveLeft=11]="AboveLeft"}(PopupPosition||(PopupPosition={}));export function showPopup(t,e,i,s,r=!0,n){let o=t.offsetHeight||t.offsetWidth,a=i;(isBoolean(i)||null==i)&&(a=i?PopupPosition.AboveLeft:PopupPosition.BelowLeft);let l=_getPopupParent(e);_addPopupToDOM(t,l);_copyPopupStyles(t,e,r);Control.refreshAll(t);isFirefox()?requestAnimationFrame(()=>{_updatePopupPosition(t,e,a)}):_updatePopupPosition(t,e,a);e instanceof HTMLElement&&(t[Control._OWNR_KEY]=e);if(!o){_hidePopupOnscroll(t,e,n);if(s)return animate(e=>t.style.opacity=e<1?e.toString():"");t.style.opacity=""}return null}export function hidePopup(t,e=!0,i=!1){let s=null;i?s=animate(i=>{t.style.opacity=(1-i).toString();if(1==i){_hidePopup(t,e);t.style.opacity=""}}):_hidePopup(t,e);return s}function _updatePopupPosition(t,e,i){let s=_getReferenceRect(t,e),r=_getPopupOffset(t),n=_getPopupPosition(t,s,i,r),o={position:"absolute",zIndex:Control._POPUP_ZINDEX};if(0==r.x){o.left=n.x;o.top=n.y}else o.transform="translate("+n.x+"px, "+n.y+"px)";setCss(t,o)}function _hidePopup(t,e){t.style.display="none";e&&t.parentElement&&setTimeout(()=>{if("none"==t.style.display){removeChild(t);isFunction(e)&&e()}},Control._FOCUS_INTERVAL+50);let i=t[Control._SCRL_KEY];i instanceof Control&&i.dispose();delete t[Control._SCRL_KEY];delete t[Control._OWNR_KEY]}function _isjQueryDialog(t){let e=window.jQuery,i=isFunction(e)?e(t):null;return i&&isFunction(i.dialog)&&hasClass(t,"ui-dialog")}function _getPopupParent(t){let e=document.body;if(t instanceof HTMLElement){if(!contains(document.body,t))return e;for(let i=t;i;i=i.parentElement){if("DIALOG"==i.tagName||"ION-CONTENT"==i.tagName||"fixed"==getComputedStyle(i).position){e=i;break}if(_isjQueryDialog(i)){e=i.querySelector(".ui-dialog-content")||i;break}}}return e}function _addPopupToDOM(t,e){if(!t.offsetHeight||!t.offsetWidth||t.parentElement!=e){setCss(t,{opacity:"0",position:"fixed",left:0,top:0,transform:"",display:""});e.appendChild(t)}}function _getPopupOffset(t){let e=document.body,i=document.documentElement,s=t.parentElement,r=new Point(e.scrollLeft||pageXOffset,e.scrollTop||pageYOffset);if(s!=e){let n=s==e?i:t.offsetParent||s;n==e&&(n=s);if(n){let t=n.getBoundingClientRect();r=new Point(n.scrollLeft-t.left,n.scrollTop-t.top)}}if(s instanceof HTMLElement){let t=getComputedStyle(s);r.x-=parseFloat(t.borderLeftWidth);r.y-=parseFloat(t.borderTopWidth)}return r}function _copyPopupStyles(t,e,i){if(e instanceof HTMLElement&&i){let s=i instanceof HTMLElement?i:e,r=getComputedStyle(s);1==new Color(r.backgroundColor).a&&setCss(t,{color:r.color,backgroundColor:r.backgroundColor,fontFamily:r.fontFamily,fontSize:r.fontSize,fontWeight:r.fontWeight,fontStyle:r.fontStyle})}}function _hidePopupOnscroll(t,e,i){let s=e instanceof MouseEvent?e.target:e;if(s instanceof HTMLElement&&s.parentElement!=document.body){let r=Date.now(),n=s.getBoundingClientRect(),o=new Control(document.createElement("div"));t[Control._SCRL_KEY]=o;o.addEventListener(document,"scroll",a=>{if(a.target!=t.parentElement&&Date.now()-r>100&&contains(document,s)&&!contains(t,a.target)&&(a.target!=document||null!=e&&"fixed"==t.style.position)){let e=s.getBoundingClientRect(),r=Math.abs(e.left-n.left),a=Math.abs(e.top-n.top);if(r>1||a>1){isFunction(i)&&i();_hidePopup(t,!0);o.dispose()}}},!0)}}function _getPopupPosition(t,e,i,s){let r=document.documentElement,n=r.clientWidth,o=r.clientHeight,a=PopupPosition;switch(i){case a.AboveLeft:case a.AboveRight:case a.BelowLeft:case a.BelowRight:if(e){let i=e.width;if(i){isIE()&&(i-=t.offsetWidth-t.clientWidth);t.style.minWidth=i+"px"}}}let l=getComputedStyle(t),h=parseFloat(l.marginTop)+parseFloat(l.marginBottom),c=parseFloat(l.marginLeft)+parseFloat(l.marginRight),u=new Size(t.offsetWidth+c,t.offsetHeight+h),d=new Point((n-u.width)/2,Math.round((o-u.height)/2*.7));if(e){"rtl"==l.direction&&(i=_getRtlPosition(i));let t=e.left,s=n-e.right;d.x=e.left;switch(i){case a.Above:case a.Below:d.x=e.left+(e.width-u.width)/2;break;case a.AboveLeft:case a.BelowLeft:d.x=e.left;break;case a.AboveRight:case a.BelowRight:d.x=e.right-u.width;break;case a.Left:case a.LeftTop:case a.LeftBottom:d.x=t>=u.width||t>=s?e.left-u.width:e.right;break;case a.RightTop:case a.RightBottom:case a.Right:d.x=s>=u.width||s>=t?e.right:e.left-u.width}let r=e.top,h=o-e.bottom;switch(i){case a.Above:case a.AboveLeft:case a.AboveRight:d.y=r>u.height||r>h?e.top-u.height:e.bottom;break;case a.Below:case a.BelowLeft:case a.BelowRight:d.y=h>u.height||h>r?e.bottom:e.top-u.height;break;case a.LeftTop:case a.RightTop:d.y=e.top;break;case a.LeftBottom:case a.RightBottom:d.y=e.bottom-u.height;break;case a.Left:case a.Right:d.y=e.bottom-u.height+(u.height-e.height)/2}}d.x=Math.min(d.x,n-u.width);d.y=Math.min(d.y,o-u.height);d.x=Math.max(0,d.x)+s.x;d.y=Math.max(0,d.y)+s.y;return d}function _getRtlPosition(t){let e=PopupPosition;switch(t){case e.AboveLeft:return e.AboveRight;case e.AboveRight:return e.AboveLeft;case e.BelowLeft:return e.BelowRight;case e.BelowRight:return e.BelowLeft;case e.Left:return e.Right;case e.LeftTop:return e.RightTop;case e.LeftBottom:return e.RightBottom;case e.Right:return e.Left;case e.RightTop:return e.LeftTop;case e.RightBottom:return e.LeftBottom}return t}function _getReferenceRect(t,e){return e instanceof MouseEvent?e.clientX<=0&&e.clientY<=0&&e.target instanceof HTMLElement?Rect.fromBoundingRect(e.target.getBoundingClientRect()):new Rect(e.pageX-pageXOffset,e.pageY-pageYOffset,0,0):e instanceof Point?new Rect(e.x,e.y,0,0):e instanceof HTMLElement?Rect.fromBoundingRect(e.getBoundingClientRect()):e&&null!=e.top&&null!=e.left?e:null}export class Tooltip{constructor(t){this._showAutoTipBnd=this._showAutoTip.bind(this);this._hideAutoTipBnd=this._hideAutoTip.bind(this);this._mousemoveBnd=this._mousemove.bind(this);this._html=!0;this._gap=6;this._isAnimated=!1;this._position=PopupPosition.Above;this._showAtMouse=!1;this._showDelay=500;this._hideDelay=0;this._tips=[];this.popup=new Event;copy(this,t)}get position(){return this._position}set position(t){this._position=asEnum(t,PopupPosition)}get isAnimated(){return this._isAnimated}set isAnimated(t){this._isAnimated=asBoolean(t)}setTooltip(t,e,i){t=getElement(t);e=this._getContent(e);let s=this._indexOf(t);if(s>-1){this._detach(t);this._tips.splice(s,1)}if(e){this._attach(t);this._tips.push({element:t,content:e,position:i})}let r=Tooltip._eTip;r&&r[Control._TTIP_KEY]==t&&(e?this._setContent(e):this._hideAutoTip())}getTooltip(t){t=getElement(t);let e=this._tips;for(let i=0;i<e.length;i++)if(e[i].element==t)return e[i].content;return null}show(t,e,i,s){t=getElement(t);e=this._getContent(e);if(!t)return;null==s&&(s=this.position);let r=Tooltip._eTip;if(!r){addClass(r=Tooltip._eTip=document.createElement("div"),"wj-tooltip");r.style.visibility="none"}addClass(r,this.cssClass);this._setContent(e);r[Control._TTIP_KEY]=t;let n=new TooltipEventArgs(e,t);this.onPopup(n);if(n.content&&!n.cancel){this._setContent(n.content);i||(i=Rect.fromBoundingRect(t.getBoundingClientRect()));let e=this.gap,o=PopupPosition;if(e)switch(s){case o.Above:case o.AboveLeft:case o.AboveRight:case o.Below:case o.BelowLeft:case o.BelowRight:i=i.inflate(0,e);break;default:i=i.inflate(e,0)}showPopup(r,i,s,this.isAnimated);document.addEventListener("mousedown",this._hideAutoTipBnd)}}hide(){let t=Tooltip._eTip;if(t){removeChild(t);removeClass(t,this.cssClass);t.innerHTML=""}document.removeEventListener("mousedown",this._hideAutoTipBnd)}dispose(){this.isVisible&&this.hide();let t=this._tips;if(t.length){t.forEach(t=>{this._detach(t.element)});t.splice(0,t.length)}this._clearTimeouts()}get isVisible(){let t=Tooltip._eTip;return null!=t&&null!=t.parentElement&&t.offsetWidth>0}get isContentHtml(){return this._html}set isContentHtml(t){this._html=asBoolean(t)}get cssClass(){return this._cssClass}set cssClass(t){this._cssClass=asString(t)}get gap(){return this._gap}set gap(t){this._gap=asNumber(t)}get showAtMouse(){return this._showAtMouse}set showAtMouse(t){this._showAtMouse=asBoolean(t)}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=asInt(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=asInt(t)}onPopup(t){this.popup&&this.popup.raise(this,t);return!t.cancel}_indexOf(t){for(let e=0;e<this._tips.length;e++)if(this._tips[e].element==t)return e;return-1}_attach(t){t.addEventListener("mouseenter",this._showAutoTipBnd);t.addEventListener("mouseleave",this._hideAutoTipBnd);t.addEventListener("click",this._showAutoTipBnd);this.showAtMouse&&t.addEventListener("mousemove",this._mousemoveBnd)}_detach(t){t.removeEventListener("mouseenter",this._showAutoTipBnd);t.removeEventListener("mouseleave",this._hideAutoTipBnd);t.removeEventListener("click",this._showAutoTipBnd);t.removeEventListener("mousemove",this._mousemoveBnd)}_showAutoTip(t){if(t.defaultPrevented)return;if("click"==t.type&&!Control._touching){this._hideAutoTip();return}let e="mouseenter"==t.type?this._showDelay:0,i=this._hideDelay;this._clearTimeouts();this._eMouse=t;this._toShow=setTimeout(()=>{let e=this._indexOf(t.target);if(e>-1){let t=this._tips[e],s=this._eMouse,r=this._showAtMouse?new Rect(s.clientX,s.clientY,0,0):null;this.show(t.element,t.content,r,t.position);i>0&&(this._toHide=setTimeout(()=>{this.hide()},i))}},e)}_mousemove(t){this._eMouse=t}_hideAutoTip(){this._clearTimeouts();this.hide()}_clearTimeouts(){if(this._toShow){clearTimeout(this._toShow);this._toShow=null}if(this._toHide){clearTimeout(this._toHide);this._toHide=null}}_getContent(t){if((t=asString(t))&&"#"==t[0]){let e=getElement(t);e&&(t=e.innerHTML)}return t}_setContent(t){let e=Tooltip._eTip;e&&(this._html?e.innerHTML=t:e.textContent=t)}}export class TooltipEventArgs extends CancelEventArgs{constructor(t,e){super();this._content=asString(t);this._e=e}get tip(){return Tooltip._eTip}get element(){return this._e}get content(){return this._content}set content(t){this._content=asString(t)}}_registerModule("wijmo",selfModule);var theLic="The Wijmo license in this application ",_licStr={evl:"Wijmo Evaluation Version ({version})",prd:theLic+"is not valid for the <b>{control}</b> control.",ver:theLic+"is not valid for the version in use. The license version is <b>{licVer}</b>; the product version is <b>{version}</b>.",dmn:theLic+"is not valid for the current domain. The license domain is <b>{licDomain}</b>; the current domain is <b>{domain}</b>.",exp:theLic+"has expired. The license expiration date is <b>{expDate:d}</b>.",lic:theLic+"is invalid.",mss:theLic+"is not set.",ctc:'Please <a target="_blank" rel="noopener" href="https://www.grapecity.com/licensing/wijmo">create a license</a> or contact GrapeCity: <a href="mailto:us.sales@grapecity.com">us.sales@grapecity.com</a>.',hdr:"Wijmo License",cls:"CLOSE"},_codes={};export function _updateWme(t,e){let i=Control._wme;if(!(i&&contains(document.body,i)&&i.offsetWidth&&i.offsetHeight))if(e){let i=_getControlCode(t);if(!_codes[i]){_codes[i]=!0;_attorn(e,{algorithmCode:"B0",publicKey:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w=="},i=>{_checkLicense(t,e,i)},()=>{_checkLicense(t,e,null)});setTimeout(()=>{delete _codes[i]},50)}}else _checkLicense(t,null,null)}function _getControlCode(t){return t._getProductInfo().split(",")[0]}function _getControlName(t){return t._getProductInfo().split(",")[1]}function _checkLicense(t,e,i){let s=culture.Licensing||_licStr,r=null;i?_checkExpiration(t,i)?_checkVersion(t,i)?_checkDomain(t,i)?_checkProductCode(t,i)?_checkEval(t,i)&&(r=s.evl):r=s.prd:r=s.dmn:r=s.ver:r=s.exp:r=e?s.lic:s.mss;r&&_addWme(t,r+="<br/><br/>"+s.ctc,i)}function _checkProductCode(t,e){let i=_getControlCode(t);if(i&&i.length>=4)for(let t=0;t<e.Prd.length;t++)if(e.Prd[t].C.indexOf(i)>-1)return!0;return!1}function _checkExpiration(t,e){if(e.Exp){let t=e.Exp,i=new Date(parseInt(t.substr(0,4))||0,parseInt(t.substr(4,2))-1||0,parseInt(t.substr(6,2))||0);if(Math.ceil((i.valueOf()-Date.now())/864e5)<=0)return!1}return!0}function _checkVersion(t,e){let i=e.Anl?e.Anl.ver:null,s=getVersion();if(i&&s){return parseInt(i.replace("v",""))+10>=parseInt(s.split(".")[1])}return!0}function _checkDomain(t,e){if(_isLocalHost()||!e.Dms)return!0;let i=location.hostname,s=e.Dms.split(",");for(let t=0;t<s.length;t++)if(_checkHost(i,s[t]))return!0;return!1}function _checkHost(t,e){var i="^"+e.replace(/\./g,"\\.").replace(/\*/g,"(.*)")+"$",s=new RegExp(i,"i").test(t);return s||"*."!=e.substr(0,2)?s:_checkHost(t,e.substr(2))}function _checkEval(t,e){return!!e&&e.Evl}function _isLocalHost(){let t=location,e=atob("Xih8bG9jYWxob3N0fGZpZGRsZS5qc2hlbGwubmV0fHJ1bi5wbG5rci5jb3xzLmNvZGVwZW4uaW98bnVsbC5qc2Jpbi5jb218Lio/LnN0YWNrYmxpdHouaW98MTI3LjAuMC4xfFt3LV0rLmxvY2FsfFt3LV0rfDo6MSkk");return"file:"==t.protocol||new RegExp(e,"i").test(t.hostname)}function _addWme(t,e,i){e=_getMessage(t,e,i);if(!_codes[" "]&&!_isLocalHost()&&!_checkEval(t,i)){_codes[" "]=!0;let t=culture.Licensing||_licStr,i=createElement('<div style="position:fixed;background:rgba(0,0,0,0.3);left:0;top:0;width:100%;height:100%;font-family: sans-serif;z-index:10000;"><div style="position:relative;overflow:auto;background:white;width:450px;padding:36pt;left:50%;top:50%;transform:translate(-50%,-50%)"><div><p style="font-size:150%;font-weight:bold">'+t.hdr+"</p><p>"+e+'</p></div><div style="text-align:right;margin-top:24pt"><button style="border:none;background:rgba(158,158,158,.2);padding:8px 16px">'+t.cls+"</button></div></div></div>",document.body);i.addEventListener("click",t=>{t.target instanceof HTMLButtonElement&&removeChild(i)})}if(!Control._wme){let i=createElement('<div><a href="'+_getWmeHref()+'" target="_blank" rel="noopener">'+_getMessage(t)+"</a></div>"),s={position:"fixed",display:"block",visibility:"visible",background:"rgba(240,240,240,.9)",padding:"8px 12px",margin:"6px",fontFamily:"sans-serif",fontSize:"14pt",fontWeight:"bold",zIndex:1e4,opacity:.8,height:"auto",width:"auto",transform:"none"};switch(Math.round(100*Math.random())%3){case 0:s.right=s.bottom=0;break;case 1:s.left=s.bottom=0;break;case 2:s.right=s.top=0}setCss(i,s);document.body.appendChild(i);Control._wme=i;(new Tooltip).setTooltip(i,e)}}function _getWmeHref(){return"ja"==culture.Globalize.name?"https://www.grapecity.co.jp/developer/support/wijmo-license":"https://www.grapecity.com/licensing/wijmo"}function _getMessage(t,e,i){if(!e||e.trim().length<15){e=(culture.Licensing||_licStr).evl}(!e||e.trim().length<15)&&(e=atob("V2lqbW8gRXZhbHVhdGlvbiBWZXJzaW9uICh7dmVyc2lvbn0p"));let s=null;if(i&&i.Exp){let t=i.Exp;s=new Date(parseInt(t.substr(0,4))||0,parseInt(t.substr(4,2))-1||0,parseInt(t.substr(6,2))||0)}return e=format(e,{version:getVersion(),domain:location.hostname,control:_getControlName(t),licVer:i&&i.Anl?"5."+i.Anl.ver.replace("v","")+".*":null,licDomain:i?i.Dms:null,expDate:s})}function _attorn(t,e,i,s){let r=parseKeyData(t,e.algorithmCode);if(!r)return s();let n=r.lic,o=r.prefix+"#"+e.algorithmCode;if(tripleHash(o+JSON.stringify(n.D))!=n.H)return s();let a=window.msCrypto||window.crypto,l=a?a.subtle:null;if(!l||!location.protocol.match(/^https/i))return i(n.D);let h={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},c={alg:"RS256",e:"AQAB",kty:"RSA",n:str64ToJwkBase64(e.publicKey)};c=window.msCrypto?str2ArrayBuffer(JSON.stringify(c)):c;try{asPromise(l.importKey("jwk",c,h,!1,["verify"])).then(t=>{let e=arrayBuffer2Str(str64ToArrayBuffer(str64EncodeUnicode(o+JSON.stringify(n.D))));asPromise(l.verify(h,t,str64ToArrayBuffer(n.S),str2ArrayBuffer(e))).then(t=>t?i(n.D):s())},()=>i(n.D))}catch(t){return i(n.D)}}var uint8Array="undefined"==typeof window?null:window.Uint8Array||window.TypedArray;function parseKeyData(t,e){try{e="#"+e;let i=t.indexOf(e);if(i>-1)return{prefix:t.substring(0,i),lic:JSON.parse(decode(t.substr(i+e.length)))}}catch(t){}return null}function decode(t){if(!t)return"";let e=unshiftString(t);e=reverseString(e);let i=Math.ceil(e.length/2);return str64DecodeUnicode(e=(e=(e=e.substr(i)+e.substr(0,i)).replace("#","=")).replace("&","=="))}function unshiftString(t){let e=t.split("");for(let t=e.length-5;t>=0;t--){swapArrayElements(e,t+1,t+3,unshiftChar);swapArrayElements(e,t,t+2,unshiftChar)}return e.join("")}function swapArrayElements(t,e,i,s){t.length>1&&t.splice(i,1,s(t.splice(e,1,s(t[i]))[0]))}function shiftChar(t,e){let i=t.charCodeAt(0);return i>=65&&i<=90?t.toLowerCase():i>=97&&i<=122?t.toUpperCase():i>=48&&i<=57?String.fromCharCode(48+(i-48+10+e)%10):t}function unshiftChar(t){return shiftChar(t,-1)}function reverseString(t){return t.split("").reverse().join("")}function str64DecodeUnicode(t){let e=atob(t),i="";for(let t=0;t<e.length;t++)i+="%"+("00"+e.charCodeAt(t).toString(16)).slice(-2);return decodeURIComponent(i)}function arrayBuffer2Str(t){return String.fromCharCode.apply(null,new uint8Array(t))}function str64ToArrayBuffer(t){let e=atob(t),i=e.length,s=new uint8Array(i);for(let t=0;t<i;t++)s[t]=e.charCodeAt(t);return s.buffer}function str64EncodeUnicode(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(parseInt(e,16))))}function str64ToJwkBase64(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function str2ArrayBuffer(t){let e=new ArrayBuffer(t.length),i=new uint8Array(e);for(let e=0,s=t.length;e<s;e++)i[e]=t.charCodeAt(e);return e}function tripleHash(t){let e=0,i=5381,s=0;for(let r=t.length-1;r>=0;r--){let n=t.charCodeAt(r);e=n+(e<<6)+(e<<16)-e;i=n+((i<<5)+i);s=n+((s<<5)-s)}let r=e^i^s;r<0&&(r=~r);return r.toString(16).toUpperCase()}function asPromise(t){if("oncomplete"in t){t.then=(e,i)=>{t.resolve=e;t.reject=i};t.oncomplete=e=>{t.resolve(t.result)};t.onerror=e=>{t.reject()}}return t}